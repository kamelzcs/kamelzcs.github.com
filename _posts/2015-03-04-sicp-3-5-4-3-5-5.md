---
layout: post
title: sicp-3-5-4-3-5-5
date: 2015-03-04 21:11:43
isOriginal: true
category: SICP
tags:
 - Lisp
keywords: 
description: 
---

#### 3.77

{%highlight scheme%}
 (define (integral delayed-integrand initial-value dt)
   (cons-stream
     initial-value
     (let ((integrand (force delayed-integrand)))
       (if (stream-null? integrand)
         the-empty-stream
         (integral
           (delay (stream-cdr integrand))
           (+ (* dt (stream-car integrand)) initial-value)
           dt)))))
{%endhighlight%}

#### 3.78

{%highlight scheme%}
 (define (integral delayed-integrand initial-value dt)
   (cons-stream
     initial-value
     (let ((integrand (force delayed-integrand)))
       (if (stream-null? integrand)
         the-empty-stream
         (integral
           (delay (stream-cdr integrand))
           (+ (* dt (stream-car integrand)) initial-value)
           dt)))))
(define (solve-2nd a b dt y0 dy0)
  (define y (integral (delay dy) y0 dt))
  (define dy (integral (delay ddy) dy0 dt))
  (define ddy
    (add-streams
      (scale-stream dy a)
      (scale-stream y b)))
  y)
{%endhighlight%}

#### 3.79

{%highlight scheme%}
 (define (general-solve-2nd f y0 dy0 dt)
   (define y (integral (delay dy) y0 dt))
   (define dy (integral (delay ddy) dy0 dt))
   (define ddy (stream-map f dy y))
   y)
{%endhighlight%}
