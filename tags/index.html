<!DOCTYPE html>
<html>
<head>
	
	<title>Tags - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library Tags" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<h1 class="large-bottom">Tags</h1>
<div id="main-content"> 

  <h4 class="low-top"><a href="/tags/A/B Testing">A/B Testing</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>From Jackknife to A/B Testing - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Show how get the confidence interval for the effects of A/B Testing" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>From Jackknife to A/B Testing</h1>
	<h4 class="large-bottom">
		Posted on 2019-12-23 22:28:32 +0900
		 in <a href="/categories/Data Science">Data Science</a> 

		<span class="tag-list">
			
			<a href="/tags/Jackknife">Jackknife</a>
			
			<a href="/tags/Math">Math</a>
			
			<a href="/tags/A/B Testing">A/B Testing</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="background">Background</h4>
<p>In A/B Testing, there is a group of data <script type="math/tex">X = (X_1, X_2, ..., X_n)</script> and <script type="math/tex">Y = (Y_1, Y-2, ..., Y_m)</script>, the metrics we interested in are the difference between these two groups and related confidence.</p>

<h4 id="a-quick-introduction-to-jackknife">A Quick Introduction to Jackknife</h4>
<p><a href="https://www.math.wustl.edu/~sawyer/handouts/Jackknife.pdf">Jackknife</a> is a method of resample, which tries to estimate the bias and variability of an estimator <script type="math/tex">\phi_n(X_1, X_2, ..., X_n)</script> by using values of <script type="math/tex">\phi_n(X)</script> on subsamples from <script type="math/tex">X_1, X_2, ..., X_n</script>.</p>

<p>The <script type="math/tex">i^{th}</script> pseudovalue of <script type="math/tex">\phi_n(X)</script> is
<script type="math/tex">ps_i(X) = n\phi_n(X_1, X_2, ..., X_n) - (n - 1)\phi_{n - 1}((X_1, X_2, ..., X_n)_{[i]})</script>, where <script type="math/tex">X_{i}</script> means the sample <script type="math/tex">X_1, X_2, ..., X_n</script> with <script type="math/tex">i^{th}</script> value <script type="math/tex">X_i</script> deleted from the sample.</p>

<p>Treat the pseudovalue <script type="math/tex">ps_i(X)</script> as if they were independent random variables with mean <script type="math/tex">\theta</script>, then the confidence interval could be obtained using Central Limit Theorem. Specifically, let</p>

<p><script type="math/tex">ps(X) = \frac{1}{n}\sum_{i=1}^{n}ps_i(X)</script> and <script type="math/tex">V_{ps}(X) = \frac{1}{n - 1}sum_{i=1}^{n - 1}(ps_i(X) - ps(X))^2</script></p>

<p>be the mean and sample variance of the pseudovalues. The jackknife 95% confidence interval is</p>

<script type="math/tex; mode=display">ps(X) - 1.96\sqrt{\frac{1}{n}V_{ps}(X)}, ps(X) + 1.96\sqrt{\frac{1}{n}V_{ps}(X)}</script>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">sample_count</span> <span class="o">=</span> <span class="mi">500000</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span> <span class="c1"># mean and standard deviation
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">jackknife_sder</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'data'</span><span class="p">])</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_count</span> <span class="o">/</span> <span class="n">K</span> <span class="p">)</span>
    <span class="k">def</span> <span class="nf">label_race</span> <span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">%</span> <span class="n">groups</span>
    <span class="n">df</span><span class="p">[</span><span class="s">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">label_race</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">average</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'data'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="n">total_sum</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">left_k_groups</span> <span class="o">=</span> <span class="p">[(</span><span class="n">total_sum</span> <span class="o">-</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s">'group'</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="nb">sum</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">sample_count</span> <span class="o">-</span> <span class="n">K</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">groups</span><span class="p">)]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">groups</span> <span class="o">*</span> <span class="n">average</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">*</span> <span class="p">(</span><span class="n">groups</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">left_k_groups</span><span class="p">]</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> 
    
    <span class="n">mean</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">groups</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">sample_count</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">s_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">jackknife_sder</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
<span class="n">s_mean</span><span class="p">,</span> <span class="n">s_var</span> <span class="o">=</span>  <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">/</span> <span class="p">(</span><span class="n">sample_count</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">s_vars</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">s_var</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s">'expected {s_var:.4f}'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/output_2_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">confidence</span> <span class="o">=</span> <span class="mf">1.96</span>
<span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_mean</span> <span class="o">-</span> <span class="n">confidence</span> <span class="o">*</span>  <span class="n">s_vars</span><span class="p">,</span> <span class="n">s_mean</span> <span class="o">+</span> <span class="n">confidence</span> <span class="o">*</span>  <span class="n">s_vars</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">'left: {l:.4f}, right: {r:.4f}'</span><span class="p">)</span>


</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>left: 499.7084, right: 500.2740
</code></pre></div></div>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
	
		
		
	
		
			<a href="/2015/08/24/monads" rel="previous" title="Monads">Monads</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/App Engine">App Engine</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Modeling-Relationship-in-App-Engine - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="relationships in app engine" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Modeling-Relationship-in-App-Engine</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-11 21:15:27 +0900
		 in <a href="/categories/Technique">Technique</a> 

		<span class="tag-list">
			
			<a href="/tags/Database">Database</a>
			
			<a href="/tags/App Engine">App Engine</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>The origin article is in <a href="http://blog.notdot.net/2010/10/Modeling-relationships-in-App-Engine" title="relationship">relationship</a>.</p>

<h3 id="the-nature-of-relationships">The nature of relationships</h3>

<p>There are many relationships, such as one to one, one to many and many to many. But the they are all built on the similar idea: reference.
A reference is a field of an entity that contains the key of another entity.</p>

<h3 id="relationships-in-app-engine">Relationships in App Engine</h3>

<h4 id="one-to-many">One to many</h4>

<p>In app engine, it is accomplished by storing the key of one side in the entity of many side.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Owner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
<span class="n">pets</span> <span class="o">=</span> <span class="n">Pet</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="s">'owner ='</span><span class="p">,</span> <span class="n">owner</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></code></pre></figure>

<p>To fetch all the pets owned by the owner, the query can be in this way.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">pets</span> <span class="o">=</span> <span class="n">Pet</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="s">'owner ='</span><span class="p">,</span> <span class="n">owner</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">pets</span> <span class="o">=</span> <span class="n">owner</span><span class="o">.</span><span class="n">pet_set</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></code></pre></figure>

<p>To change the default name to our own name, code can be in the following way.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Owner</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="s">'pets'</span><span class="p">)</span>

<span class="n">pets</span> <span class="o">=</span> <span class="n">owner</span><span class="o">.</span><span class="n">pets</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></code></pre></figure>

<p>Another way to model the one to many relationships is to use parent entities.
Every entity can specify a parent when it is created. The key of the parent forms part of the key of the created entity, and cannot be modified. The code is like the following:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Owner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="n">bob</span> <span class="o">=</span> <span class="n">Owner</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'Bob'</span><span class="p">)</span>
<span class="n">felix</span> <span class="o">=</span> <span class="n">Pet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'Felix'</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">bob</span><span class="p">)</span>

<span class="n">owner_of_felix</span> <span class="o">=</span> <span class="n">felix</span><span class="o">.</span><span class="n">parent</span></code></pre></figure>

<p>The relationship is specified implicitly. It is the most import case for transactions: on app engine, transactions can only be operate on the same entity group. A entity group is the set with same parent.</p>

<h3 id="one-to-one">One to one</h3>
<p>A special case of one to many.</p>

<h3 id="many-to-many">Many to many</h3>

<p>The most obvious approach is the same as used in relationship databases: a join table.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Owner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PetOwner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">pet</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Pet</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="s">'owners'</span><span class="p">)</span>
  <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Owner</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="s">'pets'</span><span class="p">)</span></code></pre></figure>

<p>Using the referenceproperty, the code is like the following:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">petowners</span> <span class="o">=</span> <span class="n">felix</span><span class="o">.</span><span class="n">owners</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">prefetch_refprops</span><span class="p">(</span><span class="n">owners</span><span class="p">,</span> <span class="s">'owner'</span><span class="p">)</span>
<span class="n">owners</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">owner</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">petowners</span><span class="p">]</span></code></pre></figure>

<p>Another approach is to have one side of the relationship store a list of the keys of entities on the other side of the relationship.
This makes sense when the cardinality on one side is limited.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Owner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">pets</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ListProperty</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Key</span><span class="p">)</span>

<span class="n">pets</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">pets</span><span class="p">)</span>
<span class="n">owners</span> <span class="o">=</span> <span class="n">Owner</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="s">'pets ='</span><span class="p">,</span> <span class="n">felix</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/13/python-variable-scope-classes" rel="next" title="Python variable scope">Python variable scope</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/08/modeling-entity-relationships" rel="previous" title="Modeling-entity-relationships">Modeling-entity-relationships</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Modeling-entity-relationships - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Entity  relationships in App Engine" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Modeling-entity-relationships</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-08 04:01:35 +0900
		 in <a href="/categories/Technique">Technique</a> 

		<span class="tag-list">
			
			<a href="/tags/App Engine">App Engine</a>
			
			<a href="/tags/Database">Database</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="one-to-many">One to Many</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Contact</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="c1"># Basic info.
</span>    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">birth_day</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">DateProperty</span><span class="p">()</span>

    <span class="c1"># Address info.
</span>    <span class="n">address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

    <span class="c1"># The original phone_number property has been replaced by
</span>    <span class="c1"># an implicitly created property called 'phone_numbers'.
</span>
    <span class="c1"># Company info.
</span>    <span class="n">company_title</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">company_name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">company_description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">company_address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PhoneNumber</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">contact</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Contact</span><span class="p">,</span>
                                   <span class="n">collection_name</span><span class="o">=</span><span class="s">'phone_numbers'</span><span class="p">)</span>
    <span class="n">phone_type</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">(</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">(</span><span class="s">'home'</span><span class="p">,</span> <span class="s">'work'</span><span class="p">,</span> <span class="s">'fax'</span><span class="p">,</span> <span class="s">'mobile'</span><span class="p">,</span> <span class="s">'other'</span><span class="p">))</span>
    <span class="n">number</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PhoneNumberProperty</span><span class="p">()</span></code></pre></figure>

<p>Everytime a reference property is created, an implicit collection property on the referenced class is created. The default name can be over-rode using collection_name.</p>

<p>Now the relationship can be created in the following way.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">scott</span> <span class="o">=</span> <span class="n">Contact</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'Scott'</span><span class="p">)</span>
<span class="n">scott</span><span class="o">.</span><span class="n">put</span><span class="p">()</span>
<span class="n">PhoneNumber</span><span class="p">(</span><span class="n">contact</span><span class="o">=</span><span class="n">scott</span><span class="p">,</span>
            <span class="n">phone_type</span><span class="o">=</span><span class="s">'home'</span><span class="p">,</span>
            <span class="n">number</span><span class="o">=</span><span class="s">'(650) 555 - 2200'</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">()</span>
<span class="n">PhoneNumber</span><span class="p">(</span><span class="n">contact</span><span class="o">=</span><span class="n">scott</span><span class="p">,</span>
            <span class="n">phone_type</span><span class="o">=</span><span class="s">'mobile'</span><span class="p">,</span>
            <span class="n">number</span><span class="o">=</span><span class="s">'(650) 555 - 2201'</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">()</span></code></pre></figure>

<p>Now  the phone numbers for a give person can be retrieved in this way.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span> <span class="s">'Content-Type: text/html'</span>
<span class="k">print</span>
<span class="k">for</span> <span class="n">phone</span> <span class="ow">in</span> <span class="n">scott</span><span class="o">.</span><span class="n">phone_numbers</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">'</span><span class="si">%</span><span class="s">s: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">phone</span><span class="o">.</span><span class="n">phone_type</span><span class="p">,</span> <span class="n">phone</span><span class="o">.</span><span class="n">number</span><span class="p">)</span></code></pre></figure>

<h3 id="many-to-many">Many to many</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Group</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">TextProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Contact</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="c1"># ID of user that owns this entry.
</span>  <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

  <span class="c1"># Basic info.
</span>  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">birth_day</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">DateProperty</span><span class="p">()</span>

  <span class="c1"># Address info.
</span>  <span class="n">address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

  <span class="c1"># Company info.
</span>  <span class="n">company_title</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">company_name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">company_description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">company_address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

  <span class="c1"># Group affiliation
</span>  <span class="n">groups</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ListProperty</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Key</span><span class="p">)</span>

<span class="n">friends</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"WHERE name = 'friends'"</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">mary</span> <span class="o">=</span> <span class="n">Contact</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"WHERE name = 'Mary'"</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="k">if</span> <span class="n">friends</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mary</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
   <span class="n">mary</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">friends</span><span class="o">.</span><span class="n">key</span><span class="p">())</span>
   <span class="n">mary</span><span class="o">.</span><span class="n">put</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Group</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
   <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
   <span class="n">description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">TextProperty</span><span class="p">()</span>

   <span class="o">@</span><span class="nb">property</span>
   <span class="k">def</span> <span class="nf">members</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Contact</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"WHERE groups = :1"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">())</span></code></pre></figure>

<p>The limitations:</p>

<ol>
  <li>Must explicitly retrieve the values on the side of the collection where the list is stored since all you have available are Key objects</li>
  <li>Avoid storing overly large lists of keys in a ListProperty</li>
</ol>

<h3 id="relationship-model">Relationship Model</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Contact</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="c1"># ID of user that owns this entry.
</span>    <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

    <span class="c1"># Basic info.
</span>    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">birth_day</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">DateProperty</span><span class="p">()</span>

    <span class="c1"># Address info.
</span>    <span class="n">address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

    <span class="c1"># The original organization properties have been replaced by
</span>    <span class="c1"># an implicitly created property called 'companies'. 
</span>
    <span class="c1"># Group affiliation
</span>    <span class="n">groups</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ListProperty</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Key</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Company</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">company_address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">ContactCompany</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">contact</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Contact</span><span class="p">,</span>
                                   <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                   <span class="n">collection_name</span><span class="o">=</span><span class="s">'companies'</span><span class="p">)</span>
    <span class="n">company</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Company</span><span class="p">,</span>
                                   <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                   <span class="n">collection_name</span><span class="o">=</span><span class="s">'contacts'</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="n">mary</span> <span class="o">=</span> <span class="n">Contact</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"name = 'Mary'"</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">google</span> <span class="o">=</span> <span class="n">Company</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"name = 'Google'"</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">ContactCompany</span><span class="p">(</span><span class="n">contact</span><span class="o">=</span><span class="n">mary</span><span class="p">,</span>
               <span class="n">company</span><span class="o">=</span><span class="n">google</span><span class="p">,</span>
               <span class="n">title</span><span class="o">=</span><span class="s">'Engineer'</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">()</span></code></pre></figure>

<p>The advantage compared with list-of-keys is can have large collections on either side of the relationship. However, the traversing the connectionso of a collection will require more calls to teh databases.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/11/modeling-relationship-in-app-engine" rel="next" title="Modeling-Relationship-in-App-Engine">Modeling-Relationship-in-App-Engine</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/07/transaction-isolation-in-app-engine" rel="previous" title="Transaction Isolation in App Engine">Transaction Isolation in App Engine</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Transaction Isolation in App Engine - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Transaction in App Engine" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Transaction Isolation in App Engine</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-07 03:26:26 +0900
		 in <a href="/categories/Technology">Technology</a> 

		<span class="tag-list">
			
			<a href="/tags/App Engine">App Engine</a>
			
			<a href="/tags/Database">Database</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="inside-transactions-serializable">Inside Transactions: Serializable</h3>

<p>From strongest to weakest the four isolation levels are  Serializable, Repeatable Read, Read Committed, and Read Uncommitted. Transactions are separated within each other. Transactions on a given entity group are executed serially.</p>

<p>Within the transaction, the datastore is consistent.</p>

<h3 id="the-commit-process">The Commit Process</h3>

<p>The process is as below:</p>

<p><img src="/images/posts/transaction-isolation-in-app-engine/1.1.png" alt="alt normal" /></p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/08/modeling-entity-relationships" rel="next" title="Modeling-entity-relationships">Modeling-entity-relationships</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/07/life-of-a-datastore-write" rel="previous" title="Life of a Datastore Write">Life of a Datastore Write</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Life of a Datastore Write - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Datastore writing process" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Life of a Datastore Write</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-07 03:02:45 +0900
		 in <a href="/categories/Technology">Technology</a> 

		<span class="tag-list">
			
			<a href="/tags/App Engine">App Engine</a>
			
			<a href="/tags/Database">Database</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="an-insert">An Insert</h3>

<p>When we call put or makePersistent, several things happen behind the scenes before the call returns and sets the entity’s key:</p>

<ol>
  <li>The my_todo object is converted into a protocol buffer.</li>
  <li>The appserver makes an RPC call to the datastore server, sending the entity data in a protocol buffer.</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>If a key name is not provided, a unique ID is determined for this entity’s key. The entity key is composed of app ID</td>
          <td>ancestor keys</td>
          <td>kind name</td>
          <td>key name or ID</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>The datastore server processes the request in two phases that are executed in order: commit, then apply. In each phase, the datastore server identifies the Bigtable tablet servers that should receive the data.</li>
</ol>

<h3 id="the-commit-phase">The Commit Phase</h3>

<p>The datastore performs two actions in the commit phase:</p>

<ol>
  <li>It writes the data for the entities to the entity group’s log.</li>
  <li>It marks the new log entry as committed.</li>
</ol>

<h3 id="the-apply-phase">The Apply Phase</h3>

<p>In the apply phase, the entity’s data and the index rows are written to disk in parallel.</p>

<h3 id="the-return-value">The Return Value</h3>

<p>Using HRD, the Datastore returns after the commit and does the apply asynchronously.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/07/transaction-isolation-in-app-engine" rel="next" title="Transaction Isolation in App Engine">Transaction Isolation in App Engine</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/05/storingdatainappengine" rel="previous" title="Storing Data in App Engine">Storing Data in App Engine</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Storing Data in App Engine - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="learning summarize in storing data in app engine" />
	

	
	<meta name="keywords" content="Database App-engine" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Storing Data in App Engine</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-05 23:59:29 +0900
		 in <a href="/categories/technique">technique</a> 

		<span class="tag-list">
			
			<a href="/tags/Database">Database</a>
			
			<a href="/tags/App Engine">App Engine</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="storing-data">Storing Data</h3>

<p>The app engine provides several ways to store data for the application:</p>

<ol>
  <li>App Engine Datastore: A schemaless object datastore with automatic caching, query engine, and atomic transactions.</li>
  <li>Google Cloud SQL: A relationship SQL based on the MySQL database.</li>
  <li>Google Cloud Storage: size can be up to terabytes.</li>
</ol>

<h3 id="python-datastore-api">Python Datastore API</h3>

<p>An entity has one or more properties. Each entity is identified by its kind, which categorizes the entity for the purpose of queries, and a key that uniquely identifies it within its kind.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">google.appengine.ext</span> <span class="kn">import</span> <span class="n">db</span>
<span class="kn">from</span> <span class="nn">google.appengine.api</span> <span class="kn">import</span> <span class="n">users</span>


<span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
  <span class="n">role</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                           <span class="n">choices</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="s">"executive"</span><span class="p">,</span> <span class="s">"manager"</span><span class="p">,</span> <span class="s">"producer"</span><span class="p">]))</span>
  <span class="n">hire_date</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">DateProperty</span><span class="p">()</span>
  <span class="n">new_hire_training_completed</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">BooleanProperty</span><span class="p">(</span><span class="n">indexed</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
  <span class="n">email</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>


<span class="n">e</span> <span class="o">=</span> <span class="n">Employee</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"John"</span><span class="p">,</span>
             <span class="n">role</span><span class="o">=</span><span class="s">"manager"</span><span class="p">,</span>
             <span class="n">email</span><span class="o">=</span><span class="n">users</span><span class="o">.</span><span class="n">get_current_user</span><span class="p">()</span><span class="o">.</span><span class="n">email</span><span class="p">())</span>
<span class="n">e</span><span class="o">.</span><span class="n">hire_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
<span class="n">e</span><span class="o">.</span><span class="n">put</span><span class="p">()</span></code></pre></figure>

<p>Query Examples:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">training_registration_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Alfred.Smith@example.com"</span><span class="p">,</span>
                              <span class="s">"jharrison@example.com"</span><span class="p">,</span>
                              <span class="s">"budnelson@example.com"</span><span class="p">]</span>
<span class="n">employees_trained</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">GqlQuery</span><span class="p">(</span><span class="s">"SELECT * FROM Employee WHERE email IN :1"</span><span class="p">,</span>
                                <span class="n">training_registration_list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">employees_trained</span><span class="p">:</span>
  <span class="n">e</span><span class="o">.</span><span class="n">new_hire_training_completed</span> <span class="o">=</span> <span class="bp">True</span>
  <span class="n">db</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></code></pre></figure>

<h3 id="comparison-with-traditional-databases">Comparison with traditional databases</h3>

<p>It differs from them in the way it describes relationships between data objects. Entities of the same kind can have different properties, and different entities can have properties with the same name but different value types.</p>

<h3 id="entities">Entities</h3>

<p>Objects in the Datastore are entities.</p>

<h4 id="kindskeys-and-identifiers">Kinds,keys, and identifiers</h4>

<p>Each entity is a particular kinds, which categorizes the entity for the purpose of queries. In addition, each entity has its own key, which uniquely identifies it. The key consists of the following components:</p>

<ol>
  <li>The entity’s kind</li>
  <li>identifier, which can be either
    <ul>
      <li>a key name string</li>
      <li>an integer ID</li>
    </ul>
  </li>
  <li>An optional ancestor path locating the entity within the Datastore hierarchy</li>
</ol>

<h4 id="ancestor-paths">Ancestor paths</h4>

<p>Entities in the Datastore form a hierarchically structured space similar to the directory structure of a file system.</p>

<blockquote>

  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Person:GreatGrandpa, Person:Grandpa, Person:Dad, Person:Me]
</code></pre></div>  </div>
</blockquote>

<h3 id="queries-and-indexes">Queries and indexes</h3>

<p>A typical query includes the following:</p>

<ul>
  <li>An entity kind to which the query applies</li>
  <li>Zero or more filters based on the entities’ property values, keys, and ancestors</li>
  <li>Zero or more sort orders to sequence the results</li>
</ul>

<p>App Engine predefines a simple index on each property of an entity. An App Engine application can define further custom indexes in an index configuration file named index.yaml.</p>

<h3 id="transactions">Transactions</h3>

<p>Every attempt to insert, update, or delete an entity takes place in the context of a transaction. A single transaction can include any number of such operations. To maintain the consistency of the data, the transaction ensures that all of the operations it contains are applied to the Datastore as a unit or, if any of the operations fails, that none of them are applied.</p>

<p>You can perform multiple actions on an entity within a single transaction.</p>

<h4 id="transactions-and-entity-groups">Transactions and entity groups</h4>

<p>Only ancestor queries are allowed within a transaction: that is, each transactional query must be limited to a single entity group. The transaction itself can apply to multiple entities, which can belong either to a single entity group or (in the case of a cross-group transaction) to as many as five different entity groups.</p>

<h4 id="cross-group-transactions">Cross-group transactions</h4>

<p>The transaction can be applied across a maximum of five entity groups, and will succeed as long as no concurrent transaction touches any of the entity groups to which it applies.</p>

<p>As in a single-group transaction, you cannot perform a non-ancestor query in an XG transaction. You can, however, perform ancestor queries on separate entity groups.</p>

<h3 id="datastore-writes-and-data-visibility">Datastore writes and data visibility</h3>

<p>Data is written to the Datastore in two phases:</p>

<ol>
  <li>In the Commit phase, the entity data is recorded in a log.</li>
  <li>The Apply phase consists of two actions performed in parallel:
    <ul>
      <li>The entity data is written.</li>
      <li>The index rows for the entity are written. (Note that this can take longer than writing the data itself.)</li>
    </ul>
  </li>
</ol>

<p>The write operation returns immediately after the Commit phase and the Apply phase then takes place asynchronously.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/07/life-of-a-datastore-write" rel="next" title="Life of a Datastore Write">Life of a Datastore Write</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/10/29/jinja2" rel="previous" title="Jinja2">Jinja2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Bash">Bash</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Quoting and eval in Bash - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library Quoting and eval in Bash" />
	

	
	<meta name="keywords" content="Bash Quoting Linux Eval" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Quoting and eval in Bash</h1>
	<h4 class="large-bottom">
		Posted on 2014-01-20 19:15:24 +0900
		 in <a href="/categories/Linux">Linux</a> 

		<span class="tag-list">
			
			<a href="/tags/Bash">Bash</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="quoting-and-eval-in-bash">Quoting and eval in Bash</h3>

<h4 id="quoting">Quoting</h4>

<p>Quoting in Bash actually skips some steps in the previous post:</p>

<ol>
  <li>
    <p>Sinle quotes(<code class="highlighter-rouge">''</code>) bypass through the Step 10. Everything inside the Single quotes remains untouched.
There can’t be single quotes inside single quotes, even if bashslashes are used.</p>
  </li>
  <li>
    <p>Double quotes(<code class="highlighter-rouge">""</code>) bypass Step 1 through 4, plus steps 9 and 10. Single quotes inside double quotes
has no effect. But doulbe quotes allow for parameter substitution, command substitution and arithmetic expression 
evaluation. A double quote can be inside another double quote by a backslash.</p>
  </li>
</ol>

<h4 id="eval">Eval</h4>

<p>Eval lets the precess being precessed once more. It tells the shell to take the <strong>eval</strong>’s arguments and run them through the command-line
precessing steps all over again.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2014/01/24/linklist-mergesort" rel="next" title="Linklist Mergesort">Linklist Mergesort</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2014/01/17/bash-command-line-processing" rel="previous" title="Bash Command Line Processing">Bash Command Line Processing</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Bash Command Line Processing - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="The command Line Processing of Bash" />
	

	
	<meta name="keywords" content="Bash" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Bash Command Line Processing</h1>
	<h4 class="large-bottom">
		Posted on 2014-01-17 03:46:17 +0900
		 in <a href="/categories/Computer">Computer</a> 

		<span class="tag-list">
			
			<a href="/tags/Bash">Bash</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="command-line-processing">Command Line Processing</h2>

<p>Each line the shell get is called a <em>pipeline</em>, it contains commands which are seperated by the pipe character(|).
For each pipeline it gets, the shell will breaks it into commands, set up the I/O for the pipeline and follows the
following figure to excecute the commands.</p>

<p><img src="/images/posts/bash-commandline/bash.jpg" alt="alt text" /></p>

<ol>
  <li>
    <p>Split the command into tokens by the metacharacters set: <code class="highlighter-rouge">SPACE, TAB, NEWLINE, ;, (, ), &lt;, &gt;, |, and &amp;.</code>
Types of tokens include: <code class="highlighter-rouge">words, keywords, I/O redirectors, and semicolons.</code></p>
  </li>
  <li>
    <p>Checks the first token of each command to see if it is a keyword with no quotes or backslashes. If it is an opening keyword, 
such as <code class="highlighter-rouge">if</code> or orther control-structure openers, then the shell sets things up internally for compound commands, reads the next command,
and start process again.</p>
  </li>
  <li>
    <p>Checks the first word of each command against the list of aliases. If a match is found, it substitudes and go back to Step 1.
This scheme allows recursive aliases.</p>
  </li>
  <li>
    <p>Performs brace expansion. For example, <code class="highlighter-rouge">a{b,c}</code> becomes <code class="highlighter-rouge">ab</code> <code class="highlighter-rouge">ac</code>.</p>
  </li>
  <li>
    <p>Substitudes the user’s home directory(<code class="highlighter-rouge">$HOME</code>) for tilde if it is at the beginning of a word.</p>
  </li>
  <li>
    <p>Performs parameter(variable) substitution for any expression that starts with a dollar sign(<code class="highlighter-rouge">$</code>).</p>
  </li>
  <li>
    <p>Does command substitution for any expression of the form $(string).</p>
  </li>
  <li>
    <p>Evaluates arithmetic expressions of the form $((string)).</p>
  </li>
  <li>
    <p>Takes the parts of the line that resulted from parameter, command, and arithmetic substitution and splits them into words again.
This time it uses the characters in <code class="highlighter-rouge">$IFS</code> which usually is whitespace (space, tab, and newline).</p>
  </li>
  <li>
    <p>Performs pathname expansion, a.k.a. wildcard expansion, for any occurrences of <code class="highlighter-rouge">*</code> <code class="highlighter-rouge">?</code> and <code class="highlighter-rouge">[/]</code> pairs.</p>
  </li>
  <li>
    <p>Uses the first word as a command by looking up its source as a function command, then as a built-in, then as a file in any of the directories
in <code class="highlighter-rouge">$PATH</code></p>
  </li>
  <li>
    <p>Runs the command after setting up I/O redirection and other such things.</p>
  </li>
</ol>

<h3 id="reference">Reference</h3>
<p>[1] <a href="http://shop.oreilly.com/product/9780596009656.do">Learning the bash shell</a></p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2014/01/20/quoting-bash" rel="next" title="Quoting and eval in Bash">Quoting and eval in Bash</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2014/01/06/past2013" rel="previous" title="逝去的2013">逝去的2013</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/C++">C++</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Function_overriding in Java vs C++ - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Function overriding in Java and C++" />
	

	
	<meta name="keywords" content="Polymorphism" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Function_overriding in Java vs C++</h1>
	<h4 class="large-bottom">
		Posted on 2015-06-22 17:27:24 +0900
		 in <a href="/categories/Programming">Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Java">Java</a>
			
			<a href="/tags/C++">C++</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="similar-code-different-behaviour">Similar code, different behaviour</h3>

<p>Quesion in <a href="http://stackoverflow.com/questions/30883519/function-overriding-in-java-vs-c">stackoverflow</a>:</p>

<h4 id="java-version">Java version:</h4>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">base</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">func1</span><span class="o">(){</span>
        <span class="n">func2</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">func2</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">" I am in base:func2() \n"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

<span class="kd">class</span> <span class="nc">derived</span> <span class="kd">extends</span> <span class="n">base</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">func1</span><span class="o">(){</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">func1</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">func2</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">" I am in derived:func2() \n"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">};</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span>
<span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">derived</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">derived</span><span class="o">();</span>
        <span class="n">d</span><span class="o">.</span><span class="na">func1</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Output:</p>
<blockquote>
  <p>I am in derived:func2()</p>
</blockquote>

<h4 id="c-version">C++ version</h4>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include &lt;stdio.h&gt;
</span>
<span class="k">class</span> <span class="nc">base</span>
<span class="p">{</span>
    <span class="nl">public:</span>
        <span class="kt">void</span> <span class="n">func1</span><span class="p">(){</span>
            <span class="n">func2</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="kt">void</span> <span class="n">func2</span><span class="p">(){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">" I am in base:func2() </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">derived</span> <span class="o">:</span> <span class="k">public</span> <span class="n">base</span>
<span class="p">{</span>
    <span class="nl">public:</span>
        <span class="kt">void</span> <span class="n">func1</span><span class="p">(){</span>
            <span class="n">base</span><span class="o">::</span><span class="n">func1</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="kt">void</span> <span class="n">func2</span><span class="p">(){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">" I am in derived:func2() </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">derived</span> <span class="o">*</span><span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">derived</span><span class="p">();</span>
    <span class="n">d</span><span class="o">-&gt;</span><span class="n">func1</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>Output:</p>
<blockquote>
  <p>I am in base:func2()</p>
</blockquote>

<h3 id="why">Why</h3>

<p>Firstly, I thought the behaviour of <code class="highlighter-rouge">C++</code> is reasonable, <code class="highlighter-rouge">Java</code> version is hard to understand, as I am more used to <code class="highlighter-rouge">static binding</code>.</p>

<p>For both languages, variable binding is <code class="highlighter-rouge">static</code>, no matter it is member variable or not.</p>

<p>But for <code class="highlighter-rouge">method binding</code>, two languages behaviour differently.</p>

<p>In C++, unless this method is virtual, otherwise it is bind staticlly default.</p>

<p>but in Java, all method bindings use late binding unless it is <code class="highlighter-rouge">static</code> or <code class="highlighter-rouge">final</code>(<code class="highlighter-rouge">private</code> is implicly final).</p>

<p>Java version behaves as if you had declared <code class="highlighter-rouge">base::func2</code> as</p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="k">virtual</span> <span class="kt">void</span> <span class="nf">func2</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">" I am in base:func2() </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<h3 id="static-binding-vs-late-binding">Static Binding vs Late Binding</h3>

<p><code class="highlighter-rouge">static binding</code> means references are resovled at <code class="highlighter-rouge">compile time</code>, namely it is possible to resolve it by its <code class="highlighter-rouge">position</code>.</p>

<p><code class="highlighter-rouge">late binding</code> means references are resolved at <code class="highlighter-rouge">run time</code>, which is implemented through <code class="highlighter-rouge">Vtable</code> in C++.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/07/27/srm663" rel="next" title="SRM663">SRM663</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/06/13/srm661" rel="previous" title="SRM 661 div1">SRM 661 div1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>One C++ polymorphism quesion - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="The polymorphism in C++" />
	

	
	<meta name="keywords" content="C++, Polymorphism, compiler" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>One C++ polymorphism quesion</h1>
	<h4 class="large-bottom">
		Posted on 2015-05-24 19:58:27 +0900
		 in <a href="/categories/C/C++">C/C++</a> 

		<span class="tag-list">
			
			<a href="/tags/C++">C++</a>
			
			<a href="/tags/Polymorphism">Polymorphism</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="confusing-subtype-polymorphism">Confusing subtype polymorphism</h3>

<p>When I first began to learn the polymorphism of C++, the <code class="highlighter-rouge">Subtype Polymorphism</code> similar to the following confused me a lot.</p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="c1">//file cats.h</span>
<span class="k">class</span> <span class="nc">Felid</span> <span class="p">{</span>
<span class="nl">public:</span>
 <span class="k">virtual</span> <span class="kt">void</span> <span class="n">meow</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="kt">void</span> <span class="n">getName</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"This is the Felid</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Cat</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Felid</span> <span class="p">{</span>
<span class="nl">public:</span>
 <span class="kt">void</span> <span class="n">meow</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Meowing like a regular cat! meow!</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
 <span class="kt">void</span> <span class="n">getName</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"This is the Cat</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Tiger</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Felid</span> <span class="p">{</span>
<span class="nl">public:</span>
 <span class="kt">void</span> <span class="n">meow</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Meowing like a tiger! MREOWWW!</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
 <span class="kt">void</span> <span class="n">getName</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"This is the Tiger</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Ocelot</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Felid</span> <span class="p">{</span>
<span class="nl">public:</span>
 <span class="kt">void</span> <span class="n">meow</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Meowing like an ocelot! mews!</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
 <span class="kt">void</span> <span class="n">getName</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"This is the Ocelot</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span></code></pre></figure>

<p>Now the programme can uses different <code class="highlighter-rouge">subtypes</code> to call <code class="highlighter-rouge">do_meowing</code>.</p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include &lt;iostream&gt;
#include "cats.h"
</span>
<span class="kt">void</span> <span class="nf">do_meowing</span><span class="p">(</span><span class="n">Felid</span> <span class="o">*</span><span class="n">cat</span><span class="p">)</span> <span class="p">{</span>
 <span class="n">cat</span><span class="o">-&gt;</span><span class="n">meow</span><span class="p">();</span>
 <span class="n">cat</span><span class="o">-&gt;</span><span class="n">getName</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
 <span class="n">Cat</span> <span class="n">cat</span><span class="p">;</span>
 <span class="n">Tiger</span> <span class="n">tiger</span><span class="p">;</span>
 <span class="n">Ocelot</span> <span class="n">ocelot</span><span class="p">;</span>

 <span class="n">do_meowing</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cat</span><span class="p">);</span>
 <span class="n">do_meowing</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tiger</span><span class="p">);</span>
 <span class="n">do_meowing</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ocelot</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>The output is:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Meowing like a regular cat! meow!
This is the Felid

Meowing like a tiger! MREOWWW!
This is the Felid

Meowing like an ocelot! mews!
This is the Felid
</code></pre></div></div>

<p>So, only the <code class="highlighter-rouge">virtual function</code> is polymorphism, but why and how?</p>

<h3 id="polymorphisms-in-c">polymorphisms in C++</h3>

<p>There are <a href="http://www.catonmat.net/blog/cpp-polymorphism/">four polymorphisms in C++</a>, namely</p>

<ol>
  <li>Subtype Polymorphism (Runtime Polymorphism)</li>
  <li>Parametric Polymorphism (Compile-Time Polymorphism)</li>
  <li>Ad-hoc Polymorphism (Overloading)</li>
  <li>Coercion Polymorphism (Casting)</li>
</ol>

<p><code class="highlighter-rouge">virtual function</code> belongs to the <code class="highlighter-rouge">subtype polymorphism</code> category.</p>

<h3 id="subtype-polymorphism-implementation">subtype polymorphism implementation</h3>

<p>Each object owns <a href="http://web.stanford.edu/class/archive/cs/cs143/cs143.1128/lectures/12/Slides12.pdf">several fields</a>, including</p>

<ol>
  <li>data member</li>
  <li>inherited data member</li>
  <li>virtual table</li>
</ol>

<p><code class="highlighter-rouge">subtype polymorphism</code> in <code class="highlighter-rouge">C++</code> is implemented by <code class="highlighter-rouge">virtual table</code> variable.</p>

<p>Also note that, member function is not stored in the object level, but in the class info level.
So normal member function is only determined by its declared type, not polymorphismed.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/06/13/srm661" rel="next" title="SRM 661 div1">SRM 661 div1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/16/sicp-4-3-3" rel="previous" title="sicp-4-3-3">sicp-4-3-3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/CIS194">CIS194</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Monads - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Monads" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Monads</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-24 19:16:47 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p><a href="https://wiki.haskell.org/Typeclassopedia">Type class</a> really gives one good intuition about <code class="highlighter-rouge">Monad</code>.</p>

<blockquote>
  <p>Intuitively, it is this ability to use the output from previous computations to decide what computations to run next that makes Monad more powerful than Applicative. The structure of an Applicative computation is fixed, whereas the structure of a Monad computation can change based on intermediate results. This also means that parsers built using an Applicative interface can only parse context-free languages; in order to parse context-sensitive languages a Monad interface is needed</p>
</blockquote>

<p><a href="http://yogsototh.github.io/Category-Theory-Presentation/categories.html#slide-71">Category theory</a> gives some theorems behind <code class="highlighter-rouge">Monad</code>.</p>

<blockquote>
  <p>All told, a monad in X is just a monoid in the category of endofunctors of X, with product × replaced by composition of endofunctors and unit set by the identity endofunctor.</p>
</blockquote>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">battle</span> <span class="o">::</span> <span class="kt">Battlefield</span> <span class="o">-&gt;</span> <span class="kt">Rand</span> <span class="kt">StdGen</span> <span class="kt">Battlefield</span>
<span class="n">battle</span> <span class="n">b</span> <span class="o">=</span> <span class="kr">do</span>
    <span class="p">(</span><span class="n">aStream</span> <span class="o">::</span> <span class="p">[</span><span class="kt">DieValue</span><span class="p">])</span> <span class="o">&lt;-</span> <span class="n">getRandoms</span>
    <span class="p">(</span><span class="n">bStream</span> <span class="o">::</span> <span class="p">[</span><span class="kt">DieValue</span><span class="p">])</span> <span class="o">&lt;-</span> <span class="n">getRandoms</span>
    <span class="kr">let</span> <span class="n">rollPairs</span> <span class="o">=</span> <span class="n">zip</span> <span class="p">(</span><span class="n">sort</span> <span class="o">.</span> <span class="n">take</span> <span class="n">numAttackRolls</span>   <span class="o">$</span> <span class="n">aStream</span><span class="p">)</span>
                        <span class="p">(</span><span class="n">sort</span> <span class="o">.</span> <span class="n">take</span> <span class="n">numDefenderRolls</span> <span class="o">$</span> <span class="n">bStream</span><span class="p">)</span>
    <span class="n">return</span> <span class="o">$</span> <span class="n">foldl'</span> <span class="p">(</span><span class="nf">\</span><span class="n">newB</span> <span class="p">(</span><span class="n">attackRoll</span><span class="p">,</span> <span class="n">defendRoll</span><span class="p">)</span> <span class="o">-&gt;</span>
                        <span class="kr">if</span> <span class="n">attackRoll</span> <span class="o">&gt;</span> <span class="n">defendRoll</span>
                        <span class="kr">then</span> <span class="n">newB</span> <span class="p">{</span> <span class="n">defenders</span> <span class="o">=</span> <span class="n">defenders</span> <span class="n">newB</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}</span>
                        <span class="kr">else</span> <span class="n">newB</span> <span class="p">{</span> <span class="n">attackers</span> <span class="o">=</span> <span class="n">attackers</span> <span class="n">newB</span> <span class="o">-</span> <span class="mi">1</span><span class="p">})</span>
                    <span class="n">b</span>
                    <span class="n">rollPairs</span>
  <span class="kr">where</span>
    <span class="n">numAttackRolls</span>   <span class="o">=</span> <span class="n">min</span> <span class="mi">3</span> <span class="p">(</span><span class="n">attackers</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">numDefenderRolls</span> <span class="o">=</span> <span class="n">min</span> <span class="mi">2</span> <span class="p">(</span><span class="n">defenders</span> <span class="n">b</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">invade</span> <span class="o">::</span> <span class="kt">Battlefield</span> <span class="o">-&gt;</span> <span class="kt">Rand</span> <span class="kt">StdGen</span> <span class="kt">Battlefield</span>
<span class="n">invade</span> <span class="n">bf</span><span class="o">@</span><span class="p">(</span><span class="kt">Battlefield</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">return</span> <span class="n">bf</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">battle</span> <span class="n">bf</span> <span class="o">&gt;&gt;=</span> <span class="n">invade</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">successProb</span> <span class="o">::</span> <span class="kt">Battlefield</span> <span class="o">-&gt;</span> <span class="kt">Rand</span> <span class="kt">StdGen</span> <span class="kt">Double</span>
<span class="n">successProb</span> <span class="n">bf</span> <span class="o">=</span> <span class="kr">do</span>
  <span class="kr">let</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">10000</span>
  <span class="n">results</span> <span class="o">&lt;-</span> <span class="n">replicateM</span> <span class="n">num</span> <span class="p">(</span><span class="n">invade</span> <span class="n">bf</span><span class="p">)</span>
  <span class="n">return</span> <span class="o">$</span> <span class="n">fromIntegral</span> <span class="p">(</span><span class="n">wins</span> <span class="n">results</span><span class="p">)</span> <span class="o">/</span> <span class="n">fromIntegral</span> <span class="n">num</span>
  <span class="kr">where</span> <span class="n">wins</span> <span class="o">=</span> <span class="n">length</span> <span class="o">.</span> <span class="n">filter</span> <span class="p">((</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">.</span> <span class="n">defenders</span><span class="p">)</span></code></pre></figure>

<p>Test code:</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="o">*</span><span class="kt">Risk</span><span class="o">&gt;</span> <span class="n">evalRandIO</span>  <span class="o">$</span> <span class="n">successProb</span> <span class="o">$</span> <span class="kt">Battlefield</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mf">0.1338</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2019/12/23/from-jackknife-to-ab-testing" rel="next" title="From Jackknife to A/B Testing">From Jackknife to A/B Testing</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/24/applicative-functors-part-ii" rel="previous" title="Applicative functors, Part II">Applicative functors, Part II</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Applicative functors, Part II - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Functional Programming" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Applicative functors, Part II</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-24 00:25:09 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p>The classification about <code class="highlighter-rouge">Levels of Abstraction</code> is really great.</p>

<blockquote>
  <p>With respect to Applicative and Monad in particular, there are just two levels to be concerned with. The first is the level of implementing various Applicative and Monad instances, i.e. the “raw Haskell” level.
Once we have an Applicative instance for a type like Parser, the point is that we get to “move up a layer” and program with Parsers using the Applicative interface, without thinking about the details of how Parser and its Applicative instance are actually implemented.</p>
</blockquote>

<p>The powerful <code class="highlighter-rouge">Type system</code> of <code class="highlighter-rouge">Haskell</code> makes it really suitable to create <code class="highlighter-rouge">Levels of Abstraction</code>,
which is usually very verbose or even impossible in other static typed programming languages.</p>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">zeroOrMore</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Parser</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="n">zeroOrMore</span> <span class="n">p</span> <span class="o">=</span> <span class="n">oneOrMore</span> <span class="n">p</span> <span class="o">&lt;|&gt;</span> <span class="n">pure</span> <span class="kt">[]</span>

<span class="n">oneOrMore</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Parser</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="n">oneOrMore</span> <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="o">:</span><span class="p">)</span> <span class="o">&lt;$&gt;</span> <span class="n">p</span> <span class="o">&lt;*&gt;</span> <span class="n">zeroOrMore</span> <span class="n">p</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">spaces</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">String</span>
<span class="n">spaces</span> <span class="o">=</span> <span class="n">zeroOrMore</span> <span class="o">$</span> <span class="n">satisfy</span> <span class="n">isSpace</span>

<span class="n">ident</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">String</span>
<span class="n">ident</span> <span class="o">=</span> <span class="p">(</span><span class="o">:</span><span class="p">)</span> <span class="o">&lt;$&gt;</span> <span class="p">(</span><span class="n">satisfy</span> <span class="n">isAlpha</span><span class="p">)</span> <span class="o">&lt;*&gt;</span> <span class="n">zeroOrMore</span> <span class="p">(</span><span class="n">satisfy</span> <span class="n">isAlphaNum</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- An "identifier" is represented as just a String; however, only</span>
<span class="c1">-- those Strings consisting of a letter followed by any number of</span>
<span class="c1">-- letters and digits are valid identifiers.</span>
<span class="kr">type</span> <span class="kt">Ident</span> <span class="o">=</span> <span class="kt">String</span>

<span class="c1">-- An "atom" is either an integer value or an identifier.</span>
<span class="kr">data</span> <span class="kt">Atom</span> <span class="o">=</span> <span class="kt">N</span> <span class="kt">Integer</span> <span class="o">|</span> <span class="kt">I</span> <span class="kt">Ident</span>
  <span class="kr">deriving</span> <span class="kt">Show</span>

<span class="c1">-- An S-expression is either an atom, or a list of S-expressions.</span>
<span class="kr">data</span> <span class="kt">SExpr</span> <span class="o">=</span> <span class="kt">A</span> <span class="kt">Atom</span>
           <span class="o">|</span> <span class="kt">Comb</span> <span class="p">[</span><span class="kt">SExpr</span><span class="p">]</span>
  <span class="kr">deriving</span> <span class="kt">Show</span>

<span class="n">parseAtom</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">Atom</span>
<span class="n">parseAtom</span> <span class="o">=</span> <span class="n">spaces</span> <span class="o">*&gt;</span> <span class="p">(</span><span class="kt">N</span> <span class="o">&lt;$&gt;</span> <span class="n">posInt</span> <span class="o">&lt;|&gt;</span> <span class="kt">I</span> <span class="o">&lt;$&gt;</span> <span class="n">ident</span><span class="p">)</span> <span class="o">&lt;*</span> <span class="n">spaces</span>

<span class="n">parseComb</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">SExpr</span>
<span class="n">parseComb</span> <span class="o">=</span> <span class="n">spaces</span> <span class="o">*&gt;</span> <span class="p">(</span><span class="kt">Comb</span> <span class="o">&lt;$&gt;</span> <span class="p">(</span><span class="n">char</span> <span class="sc">'('</span> <span class="o">*&gt;</span> <span class="n">oneOrMore</span> <span class="n">parseSExpr</span> <span class="o">&lt;*</span> <span class="n">char</span> <span class="sc">')'</span><span class="p">))</span> <span class="o">&lt;*</span> <span class="n">spaces</span>

<span class="n">parseSExpr</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">SExpr</span>
<span class="n">parseSExpr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">A</span> <span class="o">&lt;$&gt;</span> <span class="n">parseAtom</span><span class="p">)</span> <span class="o">&lt;|&gt;</span> <span class="n">parseComb</span></code></pre></figure>

<p>Test:</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="o">*</span><span class="kt">SExpr</span><span class="o">&gt;</span> <span class="n">runParser</span> <span class="n">parseSExpr</span> <span class="s">"(   lots  of   (  spaces   in  )  this ( one ) )"</span>
<span class="kt">Just</span> <span class="p">(</span><span class="kt">Comb</span> <span class="p">[</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"lots"</span><span class="p">),</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"of"</span><span class="p">),</span><span class="kt">Comb</span> <span class="p">[</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"spaces"</span><span class="p">),</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"in"</span><span class="p">)],</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"this"</span><span class="p">),</span><span class="kt">Comb</span> <span class="p">[</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"one"</span><span class="p">)]],</span><span class="s">""</span><span class="p">)</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/24/monads" rel="next" title="Monads">Monads</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/23/applicative-functors-part-i" rel="previous" title="Applicative functors, Part I">Applicative functors, Part I</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Applicative functors, Part I - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Applicative functors, Part I" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Applicative functors, Part I</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-23 19:40:32 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p>The induction from <code class="highlighter-rouge">Functor</code> to <code class="highlighter-rouge">Applicative</code> is quite beautiful.</p>

<p>Recalled that there exists <code class="highlighter-rouge">fmap :: (a -&gt; b) -&gt; (f a -&gt; f b)</code> in <code class="highlighter-rouge">Functor</code>, it would be great if this mapping
function is still valid if the input consists of more than one variable, namely <code class="highlighter-rouge">(a -&gt; b -&gt; c) -&gt; (f a -&gt; f b -&gt; f c)</code></p>

<p>We have</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">h</span>  <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span>
<span class="n">fa</span> <span class="o">::</span> <span class="n">f</span> <span class="n">a</span>
<span class="n">fb</span> <span class="o">::</span> <span class="n">f</span> <span class="n">b</span>
<span class="n">fc</span> <span class="o">::</span> <span class="n">f</span> <span class="n">c</span></code></pre></figure>

<p>Use <code class="highlighter-rouge">fmap</code> to lift functions,</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">h</span>         <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span>
<span class="n">fmap</span> <span class="n">h</span>    <span class="o">::</span> <span class="n">f</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span>
<span class="n">fmap</span> <span class="n">h</span> <span class="n">fa</span> <span class="o">::</span> <span class="n">f</span> <span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span></code></pre></figure>

<p>But there is no way to make</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">f</span> <span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fb</span> <span class="o">-&gt;</span> <span class="n">fc</span></code></pre></figure>

<p><code class="highlighter-rouge">Applicative</code> has the <code class="highlighter-rouge">(&lt;*&gt;)</code> to implement it, namely</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="p">(</span><span class="o">&lt;*&gt;</span><span class="p">)</span> <span class="o">::</span> <span class="n">f</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">b</span></code></pre></figure>

<p>The final induction is</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">liftA2</span> <span class="o">::</span> <span class="kt">Applicative</span> <span class="n">f</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">c</span>
<span class="n">liftA2</span> <span class="o">=</span> <span class="n">h</span> <span class="o">&lt;$&gt;</span> <span class="n">fa</span> <span class="o">&lt;*&gt;</span> <span class="n">fb</span></code></pre></figure>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- Ex. 1 - implement a Functor instance for Parser</span>
<span class="c1">--</span>
<span class="c1">-- You may find it useful to implement:</span>
<span class="c1">-- first :: (a -&gt; b) -&gt; (a,c) -&gt; (b,c)</span>

<span class="n">first</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">first</span> <span class="n">f</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Functor</span> <span class="kt">Parser</span> <span class="kr">where</span>
  <span class="n">fmap</span> <span class="n">f</span> <span class="n">parser</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="o">$</span> <span class="nf">\</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">first</span> <span class="n">f</span> <span class="o">&lt;$&gt;</span> <span class="n">runParser</span> <span class="n">parser</span> <span class="n">s</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- Ex. 2 - implement an Applicative instance for Parser</span>
<span class="c1">--</span>
<span class="kr">instance</span> <span class="kt">Applicative</span> <span class="kt">Parser</span> <span class="kr">where</span>
  <span class="n">pure</span> <span class="n">a</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="p">(</span><span class="nf">\</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="kt">Just</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>

  <span class="n">p1</span> <span class="o">&lt;*&gt;</span> <span class="n">p2</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="n">parse</span>
    <span class="kr">where</span> <span class="n">parse</span> <span class="n">s</span> <span class="o">=</span> <span class="kr">do</span>
          <span class="n">r1</span> <span class="o">&lt;-</span> <span class="n">runParser</span> <span class="n">p1</span> <span class="n">s</span>
          <span class="n">r2</span> <span class="o">&lt;-</span> <span class="n">runParser</span> <span class="n">p2</span> <span class="p">(</span><span class="n">snd</span> <span class="n">r1</span><span class="p">)</span>
          <span class="n">return</span> <span class="p">(</span><span class="n">fst</span> <span class="n">r1</span> <span class="o">$</span> <span class="n">fst</span> <span class="n">r2</span><span class="p">,</span> <span class="n">snd</span> <span class="n">r2</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- Ex. 3a - Create a parser:</span>
<span class="c1">--</span>
<span class="c1">--   abParser :: Parser (Char, Char)</span>
<span class="c1">--</span>
<span class="c1">-- which expects to see the characters ’a’ and ’b’ and returns them as a pair</span>

<span class="n">abParser</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="p">(</span><span class="kt">Char</span><span class="p">,</span> <span class="kt">Char</span><span class="p">)</span>
<span class="n">abParser</span> <span class="o">=</span> <span class="p">(,)</span> <span class="o">&lt;$&gt;</span> <span class="n">char</span> <span class="sc">'a'</span> <span class="o">&lt;*&gt;</span> <span class="n">char</span> <span class="sc">'b'</span>


<span class="c1">-- Ex. 3b - Create a parser:</span>
<span class="c1">--</span>
<span class="c1">--   abParser_ :: Parser ()</span>
<span class="c1">--</span>
<span class="c1">-- which acts in the same way as abParser but returns () instead of 'a' and 'b'</span>

<span class="n">abParser_</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="nb">()</span>
<span class="n">abParser_</span> <span class="o">=</span> <span class="n">const</span> <span class="o">.</span> <span class="n">const</span> <span class="nb">()</span> <span class="o">&lt;$&gt;</span> <span class="n">char</span> <span class="sc">'a'</span> <span class="o">&lt;*&gt;</span> <span class="n">char</span> <span class="sc">'b'</span>

<span class="c1">-- Ex. 3c - Create a parser:</span>
<span class="c1">--</span>
<span class="c1">--   intPair </span>
<span class="c1">--</span>
<span class="c1">-- which reads two integer values separated by a space and returns the integer </span>
<span class="c1">-- values in a list. You should use the provided posInt to parse the integer values.</span>

<span class="n">intPair</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">intPair</span> <span class="o">=</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span>  <span class="n">y</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span> <span class="o">&lt;$&gt;</span> <span class="n">posInt</span> <span class="o">&lt;*</span> <span class="n">char</span> <span class="sc">' '</span> <span class="o">&lt;*&gt;</span> <span class="n">posInt</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Alternative</span> <span class="kt">Parser</span> <span class="kr">where</span>
  <span class="n">empty</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="o">$</span> <span class="n">const</span> <span class="kt">Nothing</span>
  <span class="kt">Parser</span> <span class="n">p1</span> <span class="o">&lt;|&gt;</span> <span class="kt">Parser</span> <span class="n">p2</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="o">$</span> <span class="n">liftA2</span> <span class="p">(</span><span class="o">&lt;|&gt;</span><span class="p">)</span> <span class="n">p1</span> <span class="n">p2</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- Ex. 5 - Implement a parser:</span>
<span class="c1">--</span>
<span class="c1">--  intOrUppercase :: Parser ()</span>
<span class="c1">-- </span>
<span class="c1">-- which parses either an integer value or an uppercase character, and fails otherwise.</span>

<span class="n">intOrUppercase</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="nb">()</span>
<span class="n">intOrUppercase</span> <span class="o">=</span> <span class="n">const</span> <span class="nb">()</span> <span class="o">&lt;$&gt;</span> <span class="n">posInt</span> <span class="o">&lt;|&gt;</span> <span class="n">const</span> <span class="nb">()</span> <span class="o">&lt;$&gt;</span> <span class="n">satisfy</span> <span class="n">isUpper</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/24/applicative-functors-part-ii" rel="next" title="Applicative functors, Part II">Applicative functors, Part II</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/22/io" rel="previous" title="IO">IO</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>IO - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="IO" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>IO</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-22 06:08:38 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<blockquote>
  <p>There is no String “inside” an <code class="highlighter-rouge">IO String</code>, <code class="highlighter-rouge">IO String</code> is a promise, to produce a String requires actually executing the computation. And the only way to do that is to give it (perhaps as part of some larger IO value) to the Haskell runtime system, via main.</p>
</blockquote>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- 1. define glCons, which adds an Employee to GuestList</span>

<span class="n">glCons</span> <span class="o">::</span> <span class="kt">Employee</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span>
<span class="n">glCons</span> <span class="n">e</span> <span class="p">(</span><span class="kt">GL</span> <span class="n">es</span> <span class="n">fun</span><span class="p">)</span> <span class="o">=</span> <span class="kt">GL</span> <span class="p">(</span><span class="n">e</span><span class="o">:</span><span class="n">es</span><span class="p">)</span> <span class="p">(</span><span class="n">fun</span> <span class="o">+</span> <span class="n">empFun</span> <span class="n">e</span><span class="p">)</span>


<span class="c1">-- 2. define a Monoid instance for GuestList</span>

<span class="kr">instance</span> <span class="kt">Monoid</span> <span class="kt">GuestList</span> <span class="kr">where</span>
  <span class="n">mempty</span>  <span class="o">=</span> <span class="kt">GL</span> <span class="kt">[]</span> <span class="mi">0</span>
  <span class="n">mappend</span> <span class="p">(</span><span class="kt">GL</span> <span class="n">es1</span> <span class="n">f1</span><span class="p">)</span> <span class="p">(</span><span class="kt">GL</span> <span class="n">es2</span> <span class="n">f2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">GL</span> <span class="p">(</span><span class="n">es1</span> <span class="o">++</span> <span class="n">es2</span><span class="p">)</span> <span class="o">$</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span>

<span class="c1">-- 3. define moreFun, which takes two GuestLists and returns the one</span>
<span class="c1">-- which has more fun</span>

<span class="n">moreFun</span> <span class="o">::</span> <span class="kt">GuestList</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span>
<span class="n">moreFun</span> <span class="o">=</span> <span class="n">max</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">treeFold</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Tree</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span>
<span class="n">treeFold</span> <span class="n">f</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">a</span> <span class="kt">[]</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span> <span class="n">a</span> <span class="kt">[]</span>
<span class="n">treeFold</span> <span class="n">f</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">a</span> <span class="n">forest</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span> <span class="n">a</span> <span class="p">(</span><span class="n">map</span> <span class="p">(</span><span class="n">treeFold</span> <span class="n">f</span><span class="p">)</span> <span class="n">forest</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">nextLevel</span> <span class="o">::</span> <span class="kt">Employee</span> <span class="o">-&gt;</span> <span class="p">[(</span><span class="kt">GuestList</span><span class="p">,</span> <span class="kt">GuestList</span><span class="p">)]</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">GuestList</span><span class="p">,</span> <span class="kt">GuestList</span><span class="p">)</span>
<span class="n">nextLevel</span> <span class="n">b</span> <span class="n">gls</span> <span class="o">=</span> <span class="p">(</span><span class="n">withBoss</span><span class="p">,</span> <span class="n">withoutBoss</span><span class="p">)</span>
  <span class="kr">where</span>
    <span class="n">withoutBoss</span> <span class="o">=</span> <span class="n">mconcat</span> <span class="o">$</span> <span class="n">map</span> <span class="p">(</span><span class="n">uncurry</span> <span class="n">moreFun</span><span class="p">)</span> <span class="n">gls</span>
    <span class="n">withBoss</span> <span class="o">=</span> <span class="n">glCons</span> <span class="n">b</span> <span class="o">$</span> <span class="n">mconcat</span> <span class="o">$</span> <span class="n">map</span> <span class="n">snd</span> <span class="n">gls</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">maxFun</span> <span class="o">::</span> <span class="kt">Tree</span> <span class="kt">Employee</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span>
<span class="n">maxFun</span> <span class="o">=</span> <span class="n">uncurry</span> <span class="n">moreFun</span> <span class="o">.</span> <span class="n">treeFold</span> <span class="n">nextLevel</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">formatGLS</span> <span class="o">::</span> <span class="kt">GuestList</span> <span class="o">-&gt;</span> <span class="kt">String</span>
<span class="n">formatGLS</span> <span class="p">(</span><span class="kt">GL</span> <span class="n">es</span> <span class="n">fun</span><span class="p">)</span> <span class="o">=</span>
  <span class="n">totalStr</span> <span class="o">++</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="o">++</span> <span class="n">nameStr</span>
  <span class="kr">where</span>
    <span class="n">totalStr</span> <span class="o">=</span> <span class="s">"Total fun: "</span> <span class="o">++</span> <span class="n">show</span> <span class="n">fun</span>
    <span class="n">nameStr</span> <span class="o">=</span> <span class="n">unlines</span> <span class="o">$</span> <span class="n">sort</span> <span class="o">$</span> <span class="n">map</span> <span class="n">empName</span> <span class="n">es</span>

<span class="n">main</span> <span class="o">::</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">readFile</span> <span class="s">"company.txt"</span> <span class="o">&gt;&gt;=</span> <span class="n">putStrLn</span> <span class="o">.</span> <span class="n">formatGLS</span> <span class="o">.</span> <span class="n">maxFun</span> <span class="o">.</span> <span class="n">read</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/23/applicative-functors-part-i" rel="next" title="Applicative functors, Part I">Applicative functors, Part I</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/21/folds-and-monoids" rel="previous" title="Folds and monoids">Folds and monoids</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Folds and monoids - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Folds and monoids" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Folds and monoids</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-21 01:32:54 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p>To understand the different relations between type classes, <a href="https://wiki.haskell.org/Typeclassopedia">Type class</a> is a great reference.</p>

<p>This is a <a href="https://wiki.haskell.org/wikiupload/d/df/Typeclassopedia-diagram.png">fantastic picture</a>.</p>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="p">(</span><span class="o">+++</span><span class="p">)</span> <span class="o">::</span> <span class="kt">Monoid</span> <span class="n">m</span> <span class="o">=&gt;</span> <span class="kt">JoinList</span> <span class="n">m</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">m</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">m</span> <span class="n">a</span>
<span class="n">l1</span> <span class="o">+++</span> <span class="n">l2</span> <span class="o">=</span> <span class="kt">Append</span> <span class="p">(</span><span class="n">tag</span> <span class="n">l1</span> <span class="p">`</span><span class="n">mappend</span><span class="p">`</span> <span class="n">tag</span> <span class="n">l2</span><span class="p">)</span> <span class="n">l1</span> <span class="n">l2</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- 1. Implement the function indexJ to find the JoinList element at</span>
<span class="c1">-- the specified index; it should satisfy the equivalence:</span>
<span class="c1">--     (indexJ i jl) == (jlToList jl !!? i)</span>

<span class="n">indexJ</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Sized</span> <span class="n">b</span><span class="p">,</span> <span class="kt">Monoid</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="n">a</span>
<span class="n">indexJ</span> <span class="kr">_</span> <span class="kt">Empty</span> <span class="o">=</span> <span class="kt">Nothing</span>
<span class="n">indexJ</span> <span class="n">i</span> <span class="kr">_</span> <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">Nothing</span>
<span class="n">indexJ</span> <span class="n">i</span> <span class="p">(</span><span class="kt">Single</span> <span class="kr">_</span> <span class="kr">_</span><span class="p">)</span> <span class="o">|</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">Nothing</span>
<span class="n">indexJ</span> <span class="kr">_</span> <span class="p">(</span><span class="kt">Single</span> <span class="kr">_</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Just</span> <span class="n">a</span>
<span class="n">indexJ</span> <span class="n">i</span> <span class="n">p</span><span class="o">@</span><span class="p">(</span><span class="kt">Append</span> <span class="kr">_</span> <span class="n">l</span> <span class="n">r</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">sz</span> <span class="n">p</span> <span class="o">=</span> <span class="kt">Nothing</span>
  <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">indexJ</span> <span class="n">i</span> <span class="n">l</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">indexJ</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lsize</span><span class="p">)</span> <span class="n">r</span>
  <span class="kr">where</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">sz</span> <span class="n">l</span>

<span class="c1">-- 2. Implement the function dropJ to drop first n elements of a</span>
<span class="c1">-- JoinList; it should satisfy the equivalence:</span>
<span class="c1">--     jlToList (dropJ n jl) = drop n (jlToList jl)</span>

<span class="n">dropJ</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Sized</span> <span class="n">b</span><span class="p">,</span> <span class="kt">Monoid</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span> <span class="o">-&gt;</span><span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span>
<span class="n">dropJ</span> <span class="kr">_</span> <span class="kt">Empty</span>        <span class="o">=</span> <span class="kt">Empty</span>
<span class="n">dropJ</span> <span class="n">n</span> <span class="n">l</span> <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">l</span>
<span class="n">dropJ</span> <span class="kr">_</span> <span class="p">(</span><span class="kt">Single</span> <span class="kr">_</span> <span class="kr">_</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Empty</span>
<span class="n">dropJ</span> <span class="n">n</span> <span class="p">(</span><span class="kt">Append</span> <span class="kr">_</span> <span class="n">l</span> <span class="n">r</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">lsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">dropJ</span> <span class="n">n</span> <span class="n">l</span><span class="p">)</span> <span class="o">+++</span> <span class="n">r</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">dropJ</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">lsize</span><span class="p">)</span> <span class="n">r</span>
  <span class="kr">where</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">sz</span> <span class="n">l</span>

<span class="c1">-- 3. Implement the function takeJ to return the first n elements of a</span>
<span class="c1">-- JoinList, dropping all other elements; it should satisfy the equivalence:</span>
<span class="c1">--     jlToList (takeJ n jl) == take n (jlToList jl)</span>

<span class="n">takeJ</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Sized</span> <span class="n">b</span><span class="p">,</span> <span class="kt">Monoid</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span> <span class="o">-&gt;</span><span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span>
<span class="n">takeJ</span> <span class="kr">_</span> <span class="kt">Empty</span>          <span class="o">=</span> <span class="kt">Empty</span>
<span class="n">takeJ</span> <span class="n">n</span> <span class="kr">_</span>  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span>    <span class="o">=</span> <span class="kt">Empty</span>
<span class="n">takeJ</span> <span class="n">n</span> <span class="n">j</span> <span class="o">|</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="n">sz</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span>
<span class="n">takeJ</span> <span class="n">n</span> <span class="p">(</span><span class="kt">Append</span> <span class="kr">_</span> <span class="n">l</span> <span class="n">r</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">takeJ</span> <span class="n">n</span> <span class="n">l</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+++</span> <span class="n">takeJ</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">lsize</span><span class="p">)</span> <span class="n">r</span>
  <span class="kr">where</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">sz</span> <span class="n">l</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">module</span> <span class="nn">Scrabble</span> <span class="kr">where</span>

<span class="kr">import</span> <span class="nn">Data.Monoid</span>

<span class="kr">data</span> <span class="kt">Score</span> <span class="o">=</span> <span class="kt">Score</span> <span class="kt">Int</span>
             <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span> <span class="kt">Show</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Monoid</span> <span class="kt">Score</span> <span class="kr">where</span>
  <span class="n">mempty</span> <span class="o">=</span> <span class="kt">Score</span> <span class="mi">0</span>
  <span class="kt">Score</span> <span class="n">a</span> <span class="p">`</span><span class="n">mappend</span><span class="p">`</span> <span class="kt">Score</span> <span class="n">b</span> <span class="o">=</span> <span class="kt">Score</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>

<span class="n">score</span> <span class="o">::</span> <span class="kt">Char</span> <span class="o">-&gt;</span> <span class="kt">Score</span>
<span class="n">score</span> <span class="n">c</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"aeilnorstuAEILNORSTU"</span> <span class="o">=</span> <span class="kt">Score</span> <span class="mi">1</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"dgDG"</span>                 <span class="o">=</span> <span class="kt">Score</span> <span class="mi">2</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"bcmpBCMP"</span>             <span class="o">=</span> <span class="kt">Score</span> <span class="mi">3</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"fhvwyFHVWY"</span>           <span class="o">=</span> <span class="kt">Score</span> <span class="mi">4</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"kK"</span>                   <span class="o">=</span> <span class="kt">Score</span> <span class="mi">5</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"jxJX"</span>                 <span class="o">=</span> <span class="kt">Score</span> <span class="mi">8</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"qzQZ"</span>                 <span class="o">=</span> <span class="kt">Score</span> <span class="mi">10</span>
  <span class="o">|</span> <span class="n">otherwise</span>                       <span class="o">=</span> <span class="kt">Score</span> <span class="mi">0</span>

<span class="n">scoreString</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Score</span>
<span class="n">scoreString</span> <span class="o">=</span> <span class="n">foldr</span> <span class="p">((</span><span class="o">&lt;&gt;</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="p">)</span> <span class="o">$</span> <span class="kt">Score</span> <span class="mi">0</span></code></pre></figure>

<p>Test code:</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="o">*</span><span class="kt">JoinList</span><span class="o">&gt;</span> <span class="n">scoreLine</span> <span class="s">"yay "</span> <span class="o">+++</span> <span class="n">scoreLine</span> <span class="s">"haskell!"</span>
<span class="kt">Append</span> <span class="p">(</span><span class="kt">Score</span> <span class="mi">23</span><span class="p">)</span> <span class="p">(</span><span class="kt">Single</span> <span class="p">(</span><span class="kt">Score</span> <span class="mi">9</span><span class="p">)</span> <span class="s">"yay "</span><span class="p">)</span> <span class="p">(</span><span class="kt">Single</span> <span class="p">(</span><span class="kt">Score</span> <span class="mi">14</span><span class="p">)</span> <span class="s">"haskell!"</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<p>The magical part is <code class="highlighter-rouge">(Sized b, Monoid b)</code> restriction to <code class="highlighter-rouge">Sized (a,b)</code>.</p>

<p>To make it valid, besides the auto implemented</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="p">(</span><span class="kt">Monoid</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Monoid</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Monoid</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="kr">where</span>
<span class="n">mempty</span> <span class="o">=</span> <span class="p">(</span><span class="n">mempty</span><span class="p">,</span> <span class="n">mempty</span><span class="p">)</span>
<span class="n">mappend</span> <span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">)</span> <span class="p">(</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">mappend</span> <span class="n">a1</span> <span class="n">a2</span><span class="p">,</span> <span class="n">mappend</span> <span class="n">b1</span> <span class="n">b2</span><span class="p">)</span></code></pre></figure>

<p>The functions in <code class="highlighter-rouge">Sized.hs</code> is also critical.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Sized</span> <span class="kt">Size</span> <span class="kr">where</span>
  <span class="n">size</span> <span class="o">=</span> <span class="n">id</span>

<span class="c1">-- This instance means that things like</span>
<span class="c1">--   (Foo, Size)</span>
<span class="c1">--   (Foo, (Bar, Size))</span>
<span class="c1">--   ...</span>
<span class="c1">-- are all instances of Sized.</span>
<span class="kr">instance</span> <span class="kt">Sized</span> <span class="n">b</span> <span class="o">=&gt;</span> <span class="kt">Sized</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="kr">where</span>
  <span class="n">size</span> <span class="o">=</span> <span class="n">size</span> <span class="o">.</span> <span class="n">snd</span>

<span class="kr">instance</span> <span class="kt">Monoid</span> <span class="kt">Size</span> <span class="kr">where</span>
  <span class="n">mempty</span>  <span class="o">=</span> <span class="kt">Size</span> <span class="mi">0</span>
  <span class="n">mappend</span> <span class="o">=</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span></code></pre></figure>

<p>Thanks to these functions, the previously implemented <code class="highlighter-rouge">indexJ</code>, <code class="highlighter-rouge">dropJ</code>, <code class="highlighter-rouge">takeJ</code> are still valid to the <code class="highlighter-rouge">(Score, Size)</code></p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">type</span> <span class="kt">JLBuffer</span> <span class="o">=</span> <span class="kt">JoinList</span> <span class="p">(</span><span class="kt">Score</span><span class="p">,</span> <span class="kt">Size</span><span class="p">)</span> <span class="kt">String</span>

<span class="kr">instance</span> <span class="kt">Buffer</span> <span class="kt">JLBuffer</span> <span class="kr">where</span>

  <span class="c1">-- toString :: JLBuffer -&gt; String</span>
  <span class="n">toString</span> <span class="o">=</span> <span class="n">concat</span> <span class="o">.</span> <span class="n">jlToList</span>

  <span class="c1">-- fromString :: String -&gt; JLBuffer</span>
  <span class="n">fromString</span> <span class="o">=</span> <span class="n">foldr1</span> <span class="p">(</span><span class="o">+++</span><span class="p">)</span> <span class="o">.</span> <span class="n">map</span><span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="kt">Single</span> <span class="p">(</span><span class="n">scoreString</span> <span class="n">x</span><span class="p">,</span> <span class="kt">Size</span> <span class="mi">1</span><span class="p">)</span> <span class="n">x</span><span class="p">)</span> <span class="o">.</span> <span class="n">lines</span>

  <span class="c1">-- line :: Int -&gt; JLBuffer -&gt; Maybe String</span>
  <span class="n">line</span> <span class="o">=</span> <span class="n">indexJ</span>

  <span class="c1">-- replaceLine :: Int -&gt; String -&gt; JLBuffer -&gt; JLBuffer</span>
  <span class="n">replaceLine</span> <span class="n">n</span> <span class="n">str</span> <span class="n">jlb</span> <span class="o">=</span>
    <span class="n">takeJ</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">jlb</span> <span class="o">+++</span> <span class="kt">Single</span> <span class="p">(</span><span class="n">scoreString</span> <span class="n">str</span><span class="p">,</span> <span class="kt">Size</span> <span class="mi">1</span><span class="p">)</span> <span class="n">str</span> <span class="o">+++</span> <span class="n">dropJ</span> <span class="n">n</span> <span class="n">jlb</span>

  <span class="c1">-- numLines :: JLBuffer -&gt; Int</span>
  <span class="n">numLines</span> <span class="o">=</span> <span class="n">sz</span>

  <span class="c1">-- value :: JLBuffer -&gt; Int</span>
  <span class="n">value</span> <span class="o">=</span> <span class="n">scorev</span> <span class="o">.</span> <span class="n">fst</span> <span class="o">.</span> <span class="n">tag</span>
          <span class="kr">where</span> <span class="n">scorev</span> <span class="p">(</span><span class="kt">Score</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>

<span class="c1">-- JLBuffer based editor</span>

<span class="n">main</span> <span class="o">::</span> <span class="kt">IO</span><span class="nb">()</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">runEditor</span> <span class="n">editor</span> <span class="n">jlb</span>
  <span class="kr">where</span> <span class="n">jlb</span> <span class="o">=</span> <span class="n">fromString</span> <span class="o">$</span> <span class="n">unlines</span>
         <span class="p">[</span> <span class="s">"This buffer is for notes you don't want to save, and for"</span>
         <span class="p">,</span> <span class="s">"evaluation of steam valve coefficients."</span>
         <span class="p">,</span> <span class="s">"To load a different file, type the character L followed"</span>
         <span class="p">,</span> <span class="s">"by the name of the file."</span>
         <span class="p">]</span> <span class="o">::</span> <span class="kt">JLBuffer</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/22/io" rel="next" title="IO">IO</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/18/lazy-evaluation" rel="previous" title="Lazy evaluation">Lazy evaluation</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Lazy evaluation - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Lazy evaluation" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Lazy evaluation</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-18 20:18:10 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p><code class="highlighter-rouge">Lazy evaluation</code> is beautiful because it makes infinite data structures possible.
But it makes reasoning about the programme harder, especially when mixed with <code class="highlighter-rouge">side effects</code>.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">import</span> <span class="nn">Data.Array</span>

<span class="n">knapsack01</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Double</span><span class="p">]</span>   <span class="c1">-- values </span>
           <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>  <span class="c1">-- nonnegative weights</span>
           <span class="o">-&gt;</span> <span class="kt">Integer</span>    <span class="c1">-- knapsack size</span>
           <span class="o">-&gt;</span> <span class="kt">Double</span>     <span class="c1">-- max possible value</span>
<span class="n">knapsack01</span> <span class="n">vs</span> <span class="n">ws</span> <span class="n">maxW</span> <span class="o">=</span> <span class="n">m</span><span class="o">!</span><span class="p">(</span><span class="n">numItems</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxW</span><span class="p">)</span>
  <span class="kr">where</span> <span class="n">numItems</span> <span class="o">=</span> <span class="n">length</span> <span class="n">vs</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">array</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">numItems</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxW</span><span class="p">))</span> <span class="o">$</span>
              <span class="p">[((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">w</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">w</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">0</span> <span class="o">..</span> <span class="n">maxW</span><span class="p">]]</span> <span class="o">++</span>
              <span class="p">[((</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">0</span> <span class="o">..</span> <span class="n">numItems</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">++</span>
              <span class="p">[((</span><span class="n">i</span><span class="p">,</span><span class="n">w</span><span class="p">),</span> <span class="n">best</span><span class="p">)</span> 
                  <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">0</span> <span class="o">..</span> <span class="n">numItems</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                  <span class="p">,</span> <span class="n">w</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">1</span> <span class="o">..</span> <span class="n">maxW</span><span class="p">]</span>
                  <span class="p">,</span> <span class="kr">let</span> <span class="n">best</span>
                          <span class="o">|</span> <span class="n">ws</span><span class="o">!!</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">w</span>  <span class="o">=</span> <span class="n">m</span><span class="o">!</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
                          <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">max</span> <span class="p">(</span><span class="n">m</span><span class="o">!</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span> 
                                            <span class="p">(</span><span class="n">m</span><span class="o">!</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">-</span> <span class="n">ws</span><span class="o">!!</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">vs</span><span class="o">!!</span><span class="n">i</span><span class="p">)</span>
              <span class="p">]</span>

<span class="n">example</span> <span class="o">=</span> <span class="n">knapsack01</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="mi">20</span></code></pre></figure>

<p>The functional dynamic programming implementation is kind of tricky in my view.</p>

<p>Monolithic <a href="https://www.haskell.org/tutorial/arrays.html">Arrays</a> is used to memorized the overlapped subprobramme.</p>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">fib</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">fib</span> <span class="n">n</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">fibs1</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">fibs1</span> <span class="o">=</span> <span class="n">map</span> <span class="n">fib</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="p">]</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">fibs2</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">fibs2</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">zipWith</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="n">fibs2</span> <span class="p">(</span><span class="n">tail</span> <span class="n">fibs2</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<p><code class="highlighter-rouge">cons</code> is mentioned in the lecture, but use record syntax makes it
much more cleaner.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">data</span> <span class="kt">Stream</span> <span class="n">a</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="p">{</span> <span class="n">streamToList</span> <span class="o">::</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="p">}</span>

<span class="kr">instance</span> <span class="p">(</span><span class="kt">Show</span> <span class="n">a</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Show</span> <span class="p">(</span><span class="kt">Stream</span> <span class="n">a</span><span class="p">)</span> <span class="kr">where</span>
  <span class="n">show</span> <span class="o">=</span>  <span class="n">show</span> <span class="o">.</span> <span class="n">take</span> <span class="mi">20</span> <span class="o">.</span> <span class="n">streamToList</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">streamRepeat</span> <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span>
<span class="n">streamRepeat</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="o">.</span> <span class="n">repeat</span>

<span class="n">streamMap</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">b</span>
<span class="n">streamMap</span> <span class="n">f</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="o">.</span> <span class="n">map</span> <span class="n">f</span> <span class="o">.</span> <span class="n">streamToList</span>

<span class="n">streamFromSeed</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span>
<span class="n">streamFromSeed</span> <span class="n">f</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="o">.</span> <span class="n">iterate</span> <span class="n">f</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<p><a href="http://codereview.stackexchange.com/questions/66700/implementing-function-that-maps-over-stream">Explanation</a></p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">nats</span> <span class="o">::</span> <span class="kt">Stream</span> <span class="kt">Integer</span>
<span class="n">nats</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="p">]</span>

<span class="n">interleaveStreams</span> <span class="o">::</span> <span class="kt">Stream</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span>
<span class="n">interleaveStreams</span> <span class="p">(</span><span class="kt">Stream</span> <span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="n">xs</span><span class="p">))</span> <span class="n">s</span> <span class="o">=</span>
  <span class="kt">Stream</span> <span class="o">$</span> <span class="n">x</span> <span class="o">:</span> <span class="n">streamToList</span> <span class="p">(</span><span class="n">interleaveStreams</span> <span class="n">s</span> <span class="p">(</span><span class="kt">Stream</span> <span class="n">xs</span><span class="p">))</span>


<span class="n">ruler</span> <span class="o">::</span> <span class="kt">Stream</span> <span class="kt">Integer</span>
<span class="n">ruler</span> <span class="o">=</span> <span class="n">foldr1</span> <span class="n">interleaveStreams</span> <span class="p">(</span><span class="n">map</span> <span class="n">streamRepeat</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="p">])</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/21/folds-and-monoids" rel="next" title="Folds and monoids">Folds and monoids</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/18/more-polymorphism-and-type-classes" rel="previous" title="More polymorphism and type classes">More polymorphism and type classes</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>More polymorphism and type classes - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="More polymorphism and type classes" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>More polymorphism and type classes</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-18 01:01:33 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">f</span> <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span>
<span class="n">f</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">y</span></code></pre></figure>

<blockquote>
  <p>The reason this doesn’t work is that the caller of a polymorphic function gets to choose the type. Here we, the implementors, have tried to choose a specific type</p>
</blockquote>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span></code></pre></figure>

<blockquote>
  <p>could be understood as a promise that a function with this type will work no matter what type the caller chooses</p>
</blockquote>

<h5 id="type-classes">Type classes</h5>
<blockquote>
  <p>Intuitively, type classes correspond to sets of types which have certain operations defined for them, and type class polymorphic functions work only for types which are instances of the type class(es) in question</p>
</blockquote>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">eval</span> <span class="o">::</span> <span class="kt">ExprT</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">eval</span> <span class="p">(</span><span class="kt">Lit</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>
<span class="n">eval</span> <span class="p">(</span><span class="kt">Add</span> <span class="n">e1</span> <span class="n">e2</span><span class="p">)</span> <span class="o">=</span> <span class="n">eval</span> <span class="n">e1</span> <span class="o">+</span> <span class="n">eval</span> <span class="n">e2</span>
<span class="n">eval</span> <span class="p">(</span><span class="kt">Mul</span> <span class="n">e1</span> <span class="n">e2</span><span class="p">)</span> <span class="o">=</span> <span class="n">eval</span> <span class="n">e1</span> <span class="o">*</span> <span class="n">eval</span> <span class="n">e2</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">evalStr</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span>
<span class="n">evalStr</span> <span class="o">=</span> <span class="n">fmap</span> <span class="n">eval</span> <span class="o">.</span> <span class="n">parseExp</span> <span class="kt">Lit</span> <span class="kt">Add</span> <span class="kt">Mul</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<p>Defination for <code class="highlighter-rouge">Expr</code></p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">module</span> <span class="nn">Expr</span> <span class="kr">where</span>

<span class="kr">class</span> <span class="kt">Expr</span> <span class="n">a</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="n">a</span>
  <span class="n">add</span> <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span>
  <span class="n">mul</span> <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">ExprT</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">=</span> <span class="kt">Lit</span>
  <span class="n">add</span> <span class="o">=</span> <span class="kt">Add</span>
  <span class="n">mul</span> <span class="o">=</span> <span class="kt">Mul</span>

<span class="n">reify</span> <span class="o">::</span> <span class="kt">ExprT</span> <span class="o">-&gt;</span> <span class="kt">ExprT</span>
<span class="n">reify</span> <span class="o">=</span> <span class="n">id</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">Integer</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">=</span> <span class="n">id</span>
  <span class="n">add</span> <span class="o">=</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span>
  <span class="n">mul</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">Bool</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="n">i</span>
    <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">False</span>
    <span class="o">|</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="o">=</span> <span class="kt">True</span>
  <span class="n">add</span> <span class="o">=</span> <span class="p">(</span><span class="o">||</span><span class="p">)</span>
  <span class="n">mul</span> <span class="o">=</span> <span class="p">(</span><span class="o">&amp;&amp;</span><span class="p">)</span>

<span class="kr">newtype</span> <span class="kt">MinMax</span> <span class="o">=</span> <span class="kt">MinMax</span> <span class="kt">Integer</span>
                 <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span> <span class="kt">Show</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">MinMax</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">=</span> <span class="kt">MinMax</span>
  <span class="n">add</span> <span class="p">(</span><span class="kt">MinMax</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="kt">MinMax</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="kt">MinMax</span> <span class="p">(</span><span class="n">max</span> <span class="n">x</span> <span class="n">y</span><span class="p">)</span>
  <span class="n">mul</span> <span class="p">(</span><span class="kt">MinMax</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="kt">MinMax</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="kt">MinMax</span> <span class="p">(</span><span class="n">min</span> <span class="n">x</span> <span class="n">y</span><span class="p">)</span>

<span class="kr">newtype</span> <span class="kt">Mod7</span> <span class="o">=</span> <span class="kt">Mod7</span> <span class="kt">Integer</span>
                 <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span> <span class="kt">Show</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">Mod7</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="n">x</span> <span class="o">=</span> <span class="kt">Mod7</span> <span class="p">(</span><span class="n">x</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">7</span><span class="p">)</span>
  <span class="n">add</span> <span class="p">(</span><span class="kt">Mod7</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="kt">Mod7</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Mod7</span> <span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">7</span><span class="p">)</span>
  <span class="n">mul</span> <span class="p">(</span><span class="kt">Mod7</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="kt">Mod7</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Mod7</span> <span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">7</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">Program</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="kt">PushI</span> <span class="n">x</span><span class="p">]</span>
  <span class="n">add</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">++</span> <span class="n">y</span> <span class="o">++</span> <span class="p">[</span><span class="kt">Add</span><span class="p">]</span>
  <span class="n">mul</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">++</span> <span class="n">y</span> <span class="o">++</span> <span class="p">[</span><span class="kt">Mul</span><span class="p">]</span></code></pre></figure>

<h5 id="exercise-6">Exercise 6</h5>

<p>There are two tricky parts from my view:</p>

<ol>
  <li>
    <p>Same expression can belong to multiple types,
both <code class="highlighter-rouge">add (lit 3) (var "x") :: (M.Map String Integer -&gt; Maybe Integer)</code> and <code class="highlighter-rouge">add (lit 3) (var "x") :: VarExprT</code> are valid</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">add e1 e2 m</code> has the type of <code class="highlighter-rouge">(M.Map String Integer -&gt; Maybe Integer) -&gt; (M.Map String Integer -&gt; Maybe Integer) -&gt; (M.Map String Integer -&gt; Maybe Integer)</code></p>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">data</span> <span class="kt">VarExprT</span> <span class="o">=</span> <span class="kt">Lit</span> <span class="kt">Integer</span>
              <span class="o">|</span> <span class="kt">Add</span> <span class="kt">VarExprT</span> <span class="kt">VarExprT</span>
              <span class="o">|</span> <span class="kt">Mul</span> <span class="kt">VarExprT</span> <span class="kt">VarExprT</span>
              <span class="o">|</span> <span class="kt">Var</span> <span class="kt">String</span>
                <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span> <span class="kt">Show</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">VarExprT</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">=</span> <span class="kt">Lit</span>
  <span class="n">add</span> <span class="o">=</span> <span class="kt">Add</span>
  <span class="n">mul</span> <span class="o">=</span> <span class="kt">Mul</span>

<span class="kr">class</span> <span class="kt">HasVars</span> <span class="n">a</span> <span class="kr">where</span>
  <span class="n">var</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="n">a</span>

<span class="kr">instance</span> <span class="kt">HasVars</span> <span class="kt">VarExprT</span> <span class="kr">where</span>
  <span class="n">var</span> <span class="o">=</span> <span class="kt">Var</span>

<span class="kr">instance</span> <span class="kt">HasVars</span> <span class="p">(</span><span class="kt">M</span><span class="o">.</span><span class="kt">Map</span> <span class="kt">String</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span><span class="p">)</span> <span class="kr">where</span>
  <span class="n">var</span> <span class="o">=</span> <span class="kt">M</span><span class="o">.</span><span class="n">lookup</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="p">(</span><span class="kt">M</span><span class="o">.</span><span class="kt">Map</span> <span class="kt">String</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span><span class="p">)</span> <span class="kr">where</span>
    <span class="n">lit</span> <span class="o">=</span>  <span class="n">const</span> <span class="o">.</span> <span class="kt">Just</span>
    <span class="n">add</span> <span class="n">e1</span> <span class="n">e2</span> <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">&lt;$&gt;</span> <span class="n">e1</span> <span class="n">m</span> <span class="o">&lt;*&gt;</span> <span class="n">e2</span> <span class="n">m</span>
    <span class="n">mul</span> <span class="n">e1</span> <span class="n">e2</span> <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&lt;$&gt;</span> <span class="n">e1</span> <span class="n">m</span> <span class="o">&lt;*&gt;</span> <span class="n">e2</span> <span class="n">m</span>

<span class="n">withVars</span> <span class="o">::</span> <span class="p">[(</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">)]</span>
         <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">M</span><span class="o">.</span><span class="kt">Map</span> <span class="kt">String</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span><span class="p">)</span>
         <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span>
<span class="n">withVars</span> <span class="n">vs</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">exp</span> <span class="o">$</span> <span class="kt">M</span><span class="o">.</span><span class="n">fromList</span> <span class="n">vs</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/18/lazy-evaluation" rel="next" title="Lazy evaluation">Lazy evaluation</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/17/higher-order-programming-and-type-inference" rel="previous" title="Higher-order programming and type inference">Higher-order programming and type inference</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Higher-order programming and type inference - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Higher-order programming and type inference" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Higher-order programming and type inference</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-17 19:46:29 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>
<blockquote>
  <p>There is an art to deciding the order of arguments to a function to make partial applications of it as useful as possible: the arguments should be ordered from from “least to greatest variation”, that is, arguments which will often be the same should be listed first, and arguments which will often be different should come last.</p>
</blockquote>

<p>The only reason why this ordering makes sense is the last one could be made point free when it is in need.</p>

<p>One thing confuses me a lot is the difference between <code class="highlighter-rouge">$</code> and <code class="highlighter-rouge">.</code> when doing the function composition.</p>

<p><a href="http://stackoverflow.com/questions/940382/haskell-difference-between-dot-and-dollar-sign">stackoverflow</a> gives a great answer. To summarize,</p>

<ul>
  <li><code class="highlighter-rouge">$</code> operator is for avoiding parenthesis.Anything appearing after it will take precedence over anything that comes before.</li>
  <li><code class="highlighter-rouge">.</code> operator is for chaining functions. It works like the pipeline, the output on the right goes to the input of the left.</li>
</ul>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">putStrLn</span> <span class="p">(</span><span class="n">show</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="n">putStrLn</span> <span class="o">$</span> <span class="n">show</span> <span class="o">$</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">putStrLn</span> <span class="o">.</span> <span class="n">show</span> <span class="o">$</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span></code></pre></figure>

<h4 id="exercise">Exercise</h4>

<h5 id="exercise-1-wholemeal-programming">Exercise 1 Wholemeal programming</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">fun1</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">fun1</span> <span class="o">=</span> <span class="n">foldr</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="kr">if</span> <span class="n">even</span> <span class="n">x</span> <span class="kr">then</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span> <span class="kr">else</span> <span class="n">y</span><span class="p">)</span> <span class="mi">1</span>

<span class="n">fun2</span><span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">fun2</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">.</span> <span class="n">filter</span> <span class="n">even</span> <span class="o">.</span> <span class="n">takeWhile</span> <span class="p">(</span><span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="n">iterate</span> <span class="p">(</span><span class="nf">\</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="kr">if</span> <span class="n">even</span> <span class="n">n</span> <span class="kr">then</span> <span class="n">n</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">2</span> <span class="kr">else</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-2-folding-with-trees">Exercise 2 Folding with trees</h5>

<p>Always try to insert into the left subtree while keep it is balanced.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">data</span> <span class="kt">Tree</span> <span class="n">a</span> <span class="o">=</span> <span class="kt">Leaf</span> <span class="o">|</span> <span class="kt">Node</span> <span class="kt">Integer</span> <span class="p">(</span><span class="kt">Tree</span> <span class="n">a</span><span class="p">)</span> <span class="n">a</span> <span class="p">(</span><span class="kt">Tree</span> <span class="n">a</span><span class="p">)</span>
            <span class="kr">deriving</span> <span class="kt">Show</span>

<span class="n">foldTree</span> <span class="o">::</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">Tree</span> <span class="n">a</span>
<span class="n">foldTree</span> <span class="n">xs</span> <span class="o">=</span> <span class="n">foldr</span> <span class="n">insert</span> <span class="kt">Leaf</span> <span class="n">xs</span>
    <span class="kr">where</span>
        <span class="n">height</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">height</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">h</span> <span class="kr">_</span> <span class="kr">_</span> <span class="kr">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">h</span>
        <span class="n">count</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count</span> <span class="p">(</span><span class="kt">Node</span> <span class="kr">_</span> <span class="n">l</span> <span class="kr">_</span> <span class="n">r</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">count</span> <span class="n">l</span> <span class="o">+</span> <span class="n">count</span> <span class="n">r</span>
        <span class="n">insert</span> <span class="n">x</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="kt">Node</span> <span class="mi">0</span> <span class="kt">Leaf</span> <span class="n">x</span> <span class="kt">Leaf</span>
        <span class="n">insert</span> <span class="n">x</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">h</span> <span class="n">l</span> <span class="n">d</span> <span class="n">r</span><span class="p">)</span>
            <span class="o">|</span> <span class="n">height</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">height</span> <span class="n">r</span> <span class="o">=</span> <span class="kt">Node</span> <span class="n">h</span> <span class="n">l</span> <span class="n">d</span> <span class="o">$</span> <span class="n">insert</span> <span class="n">x</span> <span class="n">r</span>
            <span class="o">|</span> <span class="n">count</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">count</span> <span class="n">r</span>   <span class="o">=</span> <span class="kt">Node</span> <span class="n">h</span> <span class="n">l</span> <span class="n">d</span> <span class="p">(</span><span class="n">insert</span> <span class="n">x</span> <span class="n">r</span><span class="p">)</span>
            <span class="o">|</span> <span class="n">otherwise</span>           <span class="o">=</span> <span class="kr">let</span> <span class="n">newl</span> <span class="o">=</span> <span class="n">insert</span> <span class="n">x</span> <span class="n">l</span>
                                        <span class="n">newHeight</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">height</span> <span class="n">newl</span><span class="p">))</span>
                                        <span class="kr">in</span> <span class="kt">Node</span> <span class="n">newHeight</span> <span class="n">newl</span> <span class="n">d</span> <span class="n">r</span></code></pre></figure>

<h5 id="exercise-3-more-folds">Exercise 3 More folds</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">xor</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Bool</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
<span class="n">xor</span> <span class="o">=</span> <span class="n">foldr</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="n">accum</span> <span class="o">-&gt;</span> <span class="kr">if</span> <span class="n">x</span> <span class="kr">then</span> <span class="n">not</span> <span class="n">accum</span> <span class="kr">else</span> <span class="n">accum</span><span class="p">)</span> <span class="kt">False</span>

<span class="n">map'</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">b</span><span class="p">]</span>
<span class="n">map'</span> <span class="n">f</span> <span class="o">=</span> <span class="n">foldr</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="n">accum</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:</span> <span class="n">accum</span><span class="p">)</span> <span class="kt">[]</span></code></pre></figure>

<h5 id="exercise-4-finding-primes">Exercise 4 Finding primes</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">sSundDelete</span> <span class="o">::</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Int</span><span class="p">]</span>
<span class="n">sSundDelete</span> <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="o">|</span><span class="n">i</span><span class="o">&lt;-</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">],</span> <span class="n">j</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">i</span><span class="o">..</span><span class="n">n</span><span class="p">]]</span>

<span class="n">sieveSundaram</span> <span class="o">::</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Int</span><span class="p">]</span>
<span class="n">sieveSundaram</span> <span class="n">n</span> <span class="o">=</span> <span class="kr">let</span> <span class="n">del</span> <span class="o">=</span> <span class="n">sSundDelete</span> <span class="n">n</span> <span class="kr">in</span>
     <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span> <span class="o">|</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">],</span> <span class="n">not</span> <span class="p">(</span><span class="n">x</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="n">del</span><span class="p">)]</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/18/more-polymorphism-and-type-classes" rel="next" title="More polymorphism and type classes">More polymorphism and type classes</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/17/recursion-patterns-polymorphism-and-the-prelude" rel="previous" title="Recursion patterns, polymorphism, and the Prelude">Recursion patterns, polymorphism, and the Prelude</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Recursion patterns, polymorphism, and the Prelude - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Recursion patterns, polymorphism, and the Prelude" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Recursion patterns, polymorphism, and the Prelude</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-17 01:13:17 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-content">Lecture Content</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>In fact, experienced Haskell programmers hardly ever write recursive functions!
</code></pre></div></div>

<p>This is quite unbelieable for me at first glance. Even though <code class="highlighter-rouge">recursive function</code> is not
the best practice in languages which does not provide <a href="http://stackoverflow.com/questions/310974/what-is-tail-call-optimization">tail call optimization</a>.</p>

<p><code class="highlighter-rouge">Recursive function</code> provide more abstract way than <code class="highlighter-rouge">iterative function</code>, while there exists
more abstract way than <code class="highlighter-rouge">Recursive function</code>, which leave the low-level details of actually doing recursion
to these functions.</p>

<h5 id="infix-function">Infix Function</h5>

<p>Backticks can turn any standard function with two argumetns in an infix operator which is called <a href="http://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-300003.5">section syntax</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(op e)  =   \ x -&gt; x op e
(e op)  =   \ x -&gt; e op x
</code></pre></div></div>

<p>For example,</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">elem</span> <span class="mi">2</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span> <span class="p">`</span><span class="n">elem</span><span class="p">`)</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">((`</span><span class="n">elem</span><span class="p">`</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="mi">2</span><span class="p">)</span></code></pre></figure>

<h4 id="exercise-1-hopscotch">Exercise 1 Hopscotch</h4>

<p><code class="highlighter-rouge">zip</code> or <code class="highlighter-rouge">zipwith</code> are convenient to do filter in list.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">skips</span> <span class="o">::</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[[</span><span class="n">a</span><span class="p">]]</span>
<span class="n">skips</span> <span class="n">xs</span> <span class="o">=</span>
        <span class="kr">let</span> <span class="n">ns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">length</span> <span class="n">xs</span><span class="p">]</span>
            <span class="n">extractEvery</span> <span class="n">m</span> <span class="o">=</span> <span class="n">map</span> <span class="n">snd</span> <span class="o">.</span> <span class="n">filter</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">fst</span> <span class="n">x</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">.</span> <span class="n">zip</span> <span class="n">ns</span>
            <span class="kr">in</span> <span class="n">map</span> <span class="p">(`</span><span class="n">extractEvery</span><span class="p">`</span> <span class="n">xs</span><span class="p">)</span> <span class="n">ns</span></code></pre></figure>

<h4 id="exercise-2-local-maxima">Exercise 2 Local maxima</h4>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">localMaxima</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">localMaxima</span> <span class="p">(</span><span class="n">a</span><span class="o">:</span><span class="n">b</span><span class="o">:</span><span class="n">c</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">b</span><span class="o">:</span> <span class="n">p</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">p</span>
    <span class="kr">where</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">localMaxima</span><span class="p">(</span><span class="n">b</span><span class="o">:</span><span class="n">c</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span>
<span class="n">localMaxima</span> <span class="kr">_</span> <span class="o">=</span> <span class="kt">[]</span></code></pre></figure>

<h4 id="exercise-3-histogram">Exercise 3 Histogram</h4>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">histogram</span><span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">String</span>
<span class="n">histogram</span> <span class="n">xs</span> <span class="o">=</span>
        <span class="kr">let</span> <span class="n">count</span> <span class="o">=</span> <span class="n">map</span> <span class="p">(</span><span class="nf">\</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">length</span> <span class="o">$</span> <span class="n">filter</span> <span class="p">(</span><span class="o">==</span> <span class="n">n</span><span class="p">)</span> <span class="n">xs</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">]</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="n">maximum</span> <span class="n">count</span>
            <span class="n">histo</span> <span class="n">m</span> <span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">=</span> <span class="n">show</span> <span class="n">base</span> <span class="o">++</span> <span class="s">"="</span> <span class="o">++</span>
                <span class="n">replicate</span> <span class="n">c</span> <span class="sc">'*'</span> <span class="o">++</span>
                <span class="n">replicate</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="sc">' '</span>
        <span class="kr">in</span>
           <span class="n">unlines</span> <span class="o">.</span> <span class="n">reverse</span> <span class="o">.</span> <span class="n">transpose</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="n">histo</span> <span class="n">maxi</span><span class="p">)</span> <span class="o">$</span> <span class="n">zip</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">]</span> <span class="n">count</span></code></pre></figure>

<p>Test code,</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="o">*</span><span class="kt">Golf</span><span class="o">&gt;</span> <span class="n">putStr</span> <span class="o">$</span> <span class="n">histogram</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
 <span class="o">*</span>        
 <span class="o">*</span>        
 <span class="o">*</span>   <span class="o">*</span>    
<span class="o">==========</span>
<span class="mi">0123456789</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/17/higher-order-programming-and-type-inference" rel="next" title="Higher-order programming and type inference">Higher-order programming and type inference</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/16/algebraic-data-types" rel="previous" title="Algebraic Data Types">Algebraic Data Types</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Algebraic Data Types - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Algebraic Data Types" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Algebraic Data Types</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-16 23:42:59 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-content">Lecture Content</h4>

<h5 id="algebraic-data-types-in-general">Algebraic data types in general</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">data</span> <span class="kt">AlgDataType</span> <span class="o">=</span> <span class="kt">Constr1</span> <span class="kt">Type11</span> <span class="kt">Type12</span>
                 <span class="o">|</span> <span class="kt">Constr2</span> <span class="kt">Type21</span>
                 <span class="o">|</span> <span class="kt">Constr3</span> <span class="kt">Type31</span> <span class="kt">Type32</span> <span class="kt">Type33</span>
                 <span class="o">|</span> <span class="kt">Constr4</span></code></pre></figure>

<p>This is the general <code class="highlighter-rouge">Algebraic data types</code> definition.</p>

<p>One important note:</p>

<ul>
  <li>type and data constructor names must always start with a capital letter</li>
  <li>variables(including names of functions) must always start with a lowercase letter</li>
</ul>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">parseMessage</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">LogMessage</span>
<span class="n">parseMessage</span> <span class="n">s</span> <span class="o">=</span> <span class="kr">case</span> <span class="n">words</span> <span class="n">s</span> <span class="kr">of</span>
  <span class="p">(</span><span class="s">"I"</span><span class="o">:</span><span class="n">t</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">LogMessage</span> <span class="kt">Info</span> <span class="p">(</span><span class="n">read</span> <span class="n">t</span><span class="p">)</span> <span class="p">(</span><span class="n">unwords</span> <span class="n">xs</span><span class="p">)</span>
  <span class="p">(</span><span class="s">"W"</span><span class="o">:</span><span class="n">t</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">LogMessage</span> <span class="kt">Warning</span> <span class="p">(</span><span class="n">read</span> <span class="n">t</span><span class="p">)</span> <span class="p">(</span><span class="n">unwords</span> <span class="n">xs</span><span class="p">)</span>
  <span class="p">(</span><span class="s">"E"</span><span class="o">:</span><span class="n">c</span><span class="o">:</span><span class="n">t</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">LogMessage</span> <span class="p">(</span><span class="kt">Error</span> <span class="o">$</span> <span class="n">read</span> <span class="n">c</span><span class="p">)</span> <span class="p">(</span><span class="n">read</span> <span class="n">t</span><span class="p">)</span> <span class="p">(</span><span class="n">unwords</span> <span class="n">xs</span><span class="p">)</span>
  <span class="kr">_</span> <span class="o">-&gt;</span> <span class="kt">Unknown</span> <span class="n">s</span>

<span class="n">parse</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">LogMessage</span><span class="p">]</span>
<span class="n">parse</span> <span class="o">=</span> <span class="n">map</span> <span class="n">parseMessage</span> <span class="o">.</span> <span class="n">lines</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">insert</span> <span class="o">::</span> <span class="kt">LogMessage</span> <span class="o">-&gt;</span> <span class="kt">MessageTree</span> <span class="o">-&gt;</span> <span class="kt">MessageTree</span>
<span class="n">insert</span> <span class="p">(</span><span class="kt">Unknown</span> <span class="kr">_</span><span class="p">)</span> <span class="n">m</span> <span class="o">=</span> <span class="n">m</span>
<span class="n">insert</span> <span class="n">m</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="kt">Node</span> <span class="kt">Leaf</span> <span class="n">m</span> <span class="kt">Leaf</span>
<span class="n">insert</span> <span class="n">m</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">l</span> <span class="n">lg</span> <span class="n">r</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">mT</span> <span class="o">&lt;</span> <span class="n">logT</span> <span class="o">=</span> <span class="kt">Node</span> <span class="p">(</span><span class="n">insert</span> <span class="n">m</span> <span class="n">l</span><span class="p">)</span> <span class="n">lg</span> <span class="n">r</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="kt">Node</span> <span class="n">l</span> <span class="n">lg</span> <span class="p">(</span><span class="n">insert</span> <span class="n">m</span> <span class="n">r</span><span class="p">)</span>
  <span class="kr">where</span>
    <span class="n">getTimeStamp</span> <span class="n">x</span> <span class="o">=</span> <span class="kr">case</span> <span class="n">x</span> <span class="kr">of</span> <span class="p">(</span><span class="kt">LogMessage</span> <span class="kr">_</span> <span class="n">t</span> <span class="kr">_</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">t</span>
                               <span class="kr">_</span> <span class="o">-&gt;</span> <span class="mi">0</span>
    <span class="n">mT</span> <span class="o">=</span> <span class="n">getTimeStamp</span> <span class="n">m</span>
    <span class="n">logT</span> <span class="o">=</span> <span class="n">getTimeStamp</span> <span class="n">lg</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">build</span> <span class="o">::</span> <span class="p">[</span><span class="kt">LogMessage</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">MessageTree</span>
<span class="n">build</span> <span class="o">=</span> <span class="n">foldr</span> <span class="n">insert</span> <span class="kt">Leaf</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">inOrder</span> <span class="o">::</span> <span class="kt">MessageTree</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">LogMessage</span><span class="p">]</span>
<span class="n">inOrder</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="kt">[]</span>
<span class="n">inOrder</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">l</span> <span class="n">lg</span> <span class="n">r</span><span class="p">)</span> <span class="o">=</span> <span class="n">inOrder</span> <span class="n">l</span> <span class="o">++</span> <span class="p">[</span><span class="n">lg</span><span class="p">]</span> <span class="o">++</span> <span class="n">inOrder</span> <span class="n">r</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">whatWentWrong</span> <span class="o">::</span> <span class="p">[</span><span class="kt">LogMessage</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="n">whatWentWrong</span> <span class="o">=</span> <span class="n">map</span> <span class="n">getMsg</span> <span class="o">.</span> <span class="n">filter</span> <span class="n">seri</span> <span class="o">.</span> <span class="n">inOrder</span> <span class="o">.</span> <span class="n">build</span>
  <span class="kr">where</span> <span class="n">seri</span> <span class="p">(</span><span class="kt">LogMessage</span> <span class="p">(</span><span class="kt">Error</span> <span class="n">e</span><span class="p">)</span> <span class="kr">_</span> <span class="kr">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mi">50</span>
        <span class="n">seri</span> <span class="kr">_</span> <span class="o">=</span> <span class="kt">False</span>
        <span class="n">getMsg</span> <span class="p">(</span><span class="kt">LogMessage</span> <span class="kr">_</span> <span class="kr">_</span> <span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span></code></pre></figure>

<p>Test code:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*LogAnalysis&gt; testWhatWentWrong parse whatWentWrong "sample.log" 
["Way too many pickles","Bad pickle-flange interaction detected","Flange failed!"]
</code></pre></div></div>

	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/17/recursion-patterns-polymorphism-and-the-prelude" rel="next" title="Recursion patterns, polymorphism, and the Prelude">Recursion patterns, polymorphism, and the Prelude</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/15/introduction" rel="previous" title="Introduction to Haskell">Introduction to Haskell</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Introduction to Haskell - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Introduction part of CIS194" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Introduction to Haskell</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-15 22:16:12 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-content">Lecture Content</h4>

<p>Among all of them, <code class="highlighter-rouge">Pure</code> is the most tricky part. In the current computer system model,
<code class="highlighter-rouge">side effects</code> are inevitable. Haskell uses <code class="highlighter-rouge">Modad</code> and treats the outside world as static
to implement <code class="highlighter-rouge">Pure</code>.</p>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">toDigits</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">toDigits</span> <span class="n">n</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">[]</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">toDigits</span> <span class="p">(</span><span class="n">n</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">10</span><span class="p">)</span> <span class="o">++</span> <span class="p">[</span><span class="n">n</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">toDigitsRev</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">toDigitsRev</span> <span class="o">=</span> <span class="n">reverse</span> <span class="o">.</span> <span class="n">toDigits</span></code></pre></figure>

<p>Test part,</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">ex1Tests</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Test</span><span class="p">]</span>
<span class="n">ex1Tests</span> <span class="o">=</span> <span class="p">[</span> <span class="n">testF1</span> <span class="s">"toDigits test"</span> <span class="n">toDigits</span>
             <span class="p">[(</span><span class="mi">1234</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kt">[]</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="kt">[]</span><span class="p">)]</span>
           <span class="p">]</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<p>The key lies in generating infinite lists of <code class="highlighter-rouge">[1, 2, 1, 2, ...]</code>
There are several ways to generate infinite lists.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">numbers1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">map</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="n">numbers1</span>
<span class="n">numbers2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">:</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span> <span class="o">|</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="n">numbers2</span><span class="p">]</span>
<span class="n">numbers3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">]</span></code></pre></figure>

<p>The way to get infinite interchange of <code class="highlighter-rouge">1 2</code> lists is</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell">  <span class="n">oneTwo</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">2</span> <span class="o">:</span> <span class="n">oneTwo</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">doubleEveryOther</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">doubleEveryOther</span> <span class="o">=</span> <span class="n">reverse</span> <span class="o">.</span> <span class="n">zipWith</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">oneTwo</span> <span class="o">.</span> <span class="n">reverse</span> <span class="kr">where</span>
  <span class="n">oneTwo</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">2</span> <span class="o">:</span> <span class="n">oneTwo</span></code></pre></figure>

<p>Test code</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">ex2Tests</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Test</span><span class="p">]</span>
<span class="n">ex2Tests</span> <span class="o">=</span> <span class="p">[</span><span class="n">testF1</span> <span class="s">"doubleEveryOther test"</span> <span class="n">doubleEveryOther</span>
             <span class="p">[([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">])]</span>
           <span class="p">]</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">sumDigits</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">sumDigits</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="n">sum</span><span class="o">.</span> <span class="n">toDigits</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">ex3Tests</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Test</span><span class="p">]</span>
<span class="n">ex3Tests</span> <span class="o">=</span> <span class="p">[</span><span class="n">testF1</span> <span class="s">"sumDigits test"</span> <span class="n">sumDigits</span>
             <span class="p">[([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">22</span><span class="p">)]</span>
           <span class="p">]</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">validate</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
<span class="n">validate</span> <span class="o">=</span> <span class="p">(</span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">.</span> <span class="p">(`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">10</span><span class="p">)</span> <span class="o">.</span> <span class="n">sumDigits</span> <span class="o">.</span> <span class="n">doubleEveryOther</span> <span class="o">.</span> <span class="n">toDigits</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">ex4Tests</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Test</span><span class="p">]</span>
<span class="n">ex4Tests</span> <span class="o">=</span> <span class="p">[</span><span class="n">testF1</span> <span class="s">"validate test"</span> <span class="n">validate</span>
             <span class="p">[(</span><span class="mi">4012888888881881</span><span class="p">,</span> <span class="kt">True</span><span class="p">),</span> <span class="p">(</span><span class="mi">4012888888881882</span><span class="p">,</span> <span class="kt">False</span><span class="p">)]</span>
           <span class="p">]</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">type</span> <span class="kt">Peg</span> <span class="o">=</span> <span class="kt">String</span>
<span class="kr">type</span> <span class="kt">Move</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Peg</span><span class="p">,</span> <span class="kt">Peg</span><span class="p">)</span>

<span class="n">hanoi</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Peg</span> <span class="o">-&gt;</span> <span class="kt">Peg</span> <span class="o">-&gt;</span> <span class="kt">Peg</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Move</span><span class="p">]</span>
<span class="n">hanoi</span> <span class="n">n</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">[]</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)]</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">hanoi</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">a</span> <span class="n">c</span> <span class="n">b</span> <span class="o">++</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)]</span> <span class="o">++</span> <span class="n">hanoi</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">c</span> <span class="n">b</span> <span class="n">a</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/16/algebraic-data-types" rel="next" title="Algebraic Data Types">Algebraic Data Types</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/14/cis194-1" rel="previous" title="Learn Haskell">Learn Haskell</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Database">Database</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Modeling-Relationship-in-App-Engine - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="relationships in app engine" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Modeling-Relationship-in-App-Engine</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-11 21:15:27 +0900
		 in <a href="/categories/Technique">Technique</a> 

		<span class="tag-list">
			
			<a href="/tags/Database">Database</a>
			
			<a href="/tags/App Engine">App Engine</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>The origin article is in <a href="http://blog.notdot.net/2010/10/Modeling-relationships-in-App-Engine" title="relationship">relationship</a>.</p>

<h3 id="the-nature-of-relationships">The nature of relationships</h3>

<p>There are many relationships, such as one to one, one to many and many to many. But the they are all built on the similar idea: reference.
A reference is a field of an entity that contains the key of another entity.</p>

<h3 id="relationships-in-app-engine">Relationships in App Engine</h3>

<h4 id="one-to-many">One to many</h4>

<p>In app engine, it is accomplished by storing the key of one side in the entity of many side.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Owner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Owner</span><span class="p">)</span>
<span class="n">pets</span> <span class="o">=</span> <span class="n">Pet</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="s">'owner ='</span><span class="p">,</span> <span class="n">owner</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></code></pre></figure>

<p>To fetch all the pets owned by the owner, the query can be in this way.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">pets</span> <span class="o">=</span> <span class="n">Pet</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="s">'owner ='</span><span class="p">,</span> <span class="n">owner</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">pets</span> <span class="o">=</span> <span class="n">owner</span><span class="o">.</span><span class="n">pet_set</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></code></pre></figure>

<p>To change the default name to our own name, code can be in the following way.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Owner</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="s">'pets'</span><span class="p">)</span>

<span class="n">pets</span> <span class="o">=</span> <span class="n">owner</span><span class="o">.</span><span class="n">pets</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></code></pre></figure>

<p>Another way to model the one to many relationships is to use parent entities.
Every entity can specify a parent when it is created. The key of the parent forms part of the key of the created entity, and cannot be modified. The code is like the following:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Owner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="n">bob</span> <span class="o">=</span> <span class="n">Owner</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'Bob'</span><span class="p">)</span>
<span class="n">felix</span> <span class="o">=</span> <span class="n">Pet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'Felix'</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">bob</span><span class="p">)</span>

<span class="n">owner_of_felix</span> <span class="o">=</span> <span class="n">felix</span><span class="o">.</span><span class="n">parent</span></code></pre></figure>

<p>The relationship is specified implicitly. It is the most import case for transactions: on app engine, transactions can only be operate on the same entity group. A entity group is the set with same parent.</p>

<h3 id="one-to-one">One to one</h3>
<p>A special case of one to many.</p>

<h3 id="many-to-many">Many to many</h3>

<p>The most obvious approach is the same as used in relationship databases: a join table.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Owner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PetOwner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">pet</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Pet</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="s">'owners'</span><span class="p">)</span>
  <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Owner</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="s">'pets'</span><span class="p">)</span></code></pre></figure>

<p>Using the referenceproperty, the code is like the following:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">petowners</span> <span class="o">=</span> <span class="n">felix</span><span class="o">.</span><span class="n">owners</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">prefetch_refprops</span><span class="p">(</span><span class="n">owners</span><span class="p">,</span> <span class="s">'owner'</span><span class="p">)</span>
<span class="n">owners</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">owner</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">petowners</span><span class="p">]</span></code></pre></figure>

<p>Another approach is to have one side of the relationship store a list of the keys of entities on the other side of the relationship.
This makes sense when the cardinality on one side is limited.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Owner</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">pets</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ListProperty</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Key</span><span class="p">)</span>

<span class="n">pets</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">pets</span><span class="p">)</span>
<span class="n">owners</span> <span class="o">=</span> <span class="n">Owner</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="s">'pets ='</span><span class="p">,</span> <span class="n">felix</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/13/python-variable-scope-classes" rel="next" title="Python variable scope">Python variable scope</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/08/modeling-entity-relationships" rel="previous" title="Modeling-entity-relationships">Modeling-entity-relationships</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Modeling-entity-relationships - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Entity  relationships in App Engine" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Modeling-entity-relationships</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-08 04:01:35 +0900
		 in <a href="/categories/Technique">Technique</a> 

		<span class="tag-list">
			
			<a href="/tags/App Engine">App Engine</a>
			
			<a href="/tags/Database">Database</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="one-to-many">One to Many</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Contact</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="c1"># Basic info.
</span>    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">birth_day</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">DateProperty</span><span class="p">()</span>

    <span class="c1"># Address info.
</span>    <span class="n">address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

    <span class="c1"># The original phone_number property has been replaced by
</span>    <span class="c1"># an implicitly created property called 'phone_numbers'.
</span>
    <span class="c1"># Company info.
</span>    <span class="n">company_title</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">company_name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">company_description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">company_address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PhoneNumber</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">contact</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Contact</span><span class="p">,</span>
                                   <span class="n">collection_name</span><span class="o">=</span><span class="s">'phone_numbers'</span><span class="p">)</span>
    <span class="n">phone_type</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">(</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">(</span><span class="s">'home'</span><span class="p">,</span> <span class="s">'work'</span><span class="p">,</span> <span class="s">'fax'</span><span class="p">,</span> <span class="s">'mobile'</span><span class="p">,</span> <span class="s">'other'</span><span class="p">))</span>
    <span class="n">number</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PhoneNumberProperty</span><span class="p">()</span></code></pre></figure>

<p>Everytime a reference property is created, an implicit collection property on the referenced class is created. The default name can be over-rode using collection_name.</p>

<p>Now the relationship can be created in the following way.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">scott</span> <span class="o">=</span> <span class="n">Contact</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'Scott'</span><span class="p">)</span>
<span class="n">scott</span><span class="o">.</span><span class="n">put</span><span class="p">()</span>
<span class="n">PhoneNumber</span><span class="p">(</span><span class="n">contact</span><span class="o">=</span><span class="n">scott</span><span class="p">,</span>
            <span class="n">phone_type</span><span class="o">=</span><span class="s">'home'</span><span class="p">,</span>
            <span class="n">number</span><span class="o">=</span><span class="s">'(650) 555 - 2200'</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">()</span>
<span class="n">PhoneNumber</span><span class="p">(</span><span class="n">contact</span><span class="o">=</span><span class="n">scott</span><span class="p">,</span>
            <span class="n">phone_type</span><span class="o">=</span><span class="s">'mobile'</span><span class="p">,</span>
            <span class="n">number</span><span class="o">=</span><span class="s">'(650) 555 - 2201'</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">()</span></code></pre></figure>

<p>Now  the phone numbers for a give person can be retrieved in this way.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span> <span class="s">'Content-Type: text/html'</span>
<span class="k">print</span>
<span class="k">for</span> <span class="n">phone</span> <span class="ow">in</span> <span class="n">scott</span><span class="o">.</span><span class="n">phone_numbers</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">'</span><span class="si">%</span><span class="s">s: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">phone</span><span class="o">.</span><span class="n">phone_type</span><span class="p">,</span> <span class="n">phone</span><span class="o">.</span><span class="n">number</span><span class="p">)</span></code></pre></figure>

<h3 id="many-to-many">Many to many</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Group</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">TextProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Contact</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="c1"># ID of user that owns this entry.
</span>  <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

  <span class="c1"># Basic info.
</span>  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">birth_day</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">DateProperty</span><span class="p">()</span>

  <span class="c1"># Address info.
</span>  <span class="n">address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

  <span class="c1"># Company info.
</span>  <span class="n">company_title</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">company_name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">company_description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
  <span class="n">company_address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

  <span class="c1"># Group affiliation
</span>  <span class="n">groups</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ListProperty</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Key</span><span class="p">)</span>

<span class="n">friends</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"WHERE name = 'friends'"</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">mary</span> <span class="o">=</span> <span class="n">Contact</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"WHERE name = 'Mary'"</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="k">if</span> <span class="n">friends</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mary</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
   <span class="n">mary</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">friends</span><span class="o">.</span><span class="n">key</span><span class="p">())</span>
   <span class="n">mary</span><span class="o">.</span><span class="n">put</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Group</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
   <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
   <span class="n">description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">TextProperty</span><span class="p">()</span>

   <span class="o">@</span><span class="nb">property</span>
   <span class="k">def</span> <span class="nf">members</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Contact</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"WHERE groups = :1"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">())</span></code></pre></figure>

<p>The limitations:</p>

<ol>
  <li>Must explicitly retrieve the values on the side of the collection where the list is stored since all you have available are Key objects</li>
  <li>Avoid storing overly large lists of keys in a ListProperty</li>
</ol>

<h3 id="relationship-model">Relationship Model</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Contact</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="c1"># ID of user that owns this entry.
</span>    <span class="n">owner</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

    <span class="c1"># Basic info.
</span>    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">birth_day</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">DateProperty</span><span class="p">()</span>

    <span class="c1"># Address info.
</span>    <span class="n">address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

    <span class="c1"># The original organization properties have been replaced by
</span>    <span class="c1"># an implicitly created property called 'companies'. 
</span>
    <span class="c1"># Group affiliation
</span>    <span class="n">groups</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ListProperty</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Key</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Company</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">company_address</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">PostalAddressProperty</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">ContactCompany</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">contact</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Contact</span><span class="p">,</span>
                                   <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                   <span class="n">collection_name</span><span class="o">=</span><span class="s">'companies'</span><span class="p">)</span>
    <span class="n">company</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ReferenceProperty</span><span class="p">(</span><span class="n">Company</span><span class="p">,</span>
                                   <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                   <span class="n">collection_name</span><span class="o">=</span><span class="s">'contacts'</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>

<span class="n">mary</span> <span class="o">=</span> <span class="n">Contact</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"name = 'Mary'"</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">google</span> <span class="o">=</span> <span class="n">Company</span><span class="o">.</span><span class="n">gql</span><span class="p">(</span><span class="s">"name = 'Google'"</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">ContactCompany</span><span class="p">(</span><span class="n">contact</span><span class="o">=</span><span class="n">mary</span><span class="p">,</span>
               <span class="n">company</span><span class="o">=</span><span class="n">google</span><span class="p">,</span>
               <span class="n">title</span><span class="o">=</span><span class="s">'Engineer'</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">()</span></code></pre></figure>

<p>The advantage compared with list-of-keys is can have large collections on either side of the relationship. However, the traversing the connectionso of a collection will require more calls to teh databases.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/11/modeling-relationship-in-app-engine" rel="next" title="Modeling-Relationship-in-App-Engine">Modeling-Relationship-in-App-Engine</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/07/transaction-isolation-in-app-engine" rel="previous" title="Transaction Isolation in App Engine">Transaction Isolation in App Engine</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Transaction Isolation in App Engine - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Transaction in App Engine" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Transaction Isolation in App Engine</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-07 03:26:26 +0900
		 in <a href="/categories/Technology">Technology</a> 

		<span class="tag-list">
			
			<a href="/tags/App Engine">App Engine</a>
			
			<a href="/tags/Database">Database</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="inside-transactions-serializable">Inside Transactions: Serializable</h3>

<p>From strongest to weakest the four isolation levels are  Serializable, Repeatable Read, Read Committed, and Read Uncommitted. Transactions are separated within each other. Transactions on a given entity group are executed serially.</p>

<p>Within the transaction, the datastore is consistent.</p>

<h3 id="the-commit-process">The Commit Process</h3>

<p>The process is as below:</p>

<p><img src="/images/posts/transaction-isolation-in-app-engine/1.1.png" alt="alt normal" /></p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/08/modeling-entity-relationships" rel="next" title="Modeling-entity-relationships">Modeling-entity-relationships</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/07/life-of-a-datastore-write" rel="previous" title="Life of a Datastore Write">Life of a Datastore Write</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Life of a Datastore Write - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Datastore writing process" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Life of a Datastore Write</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-07 03:02:45 +0900
		 in <a href="/categories/Technology">Technology</a> 

		<span class="tag-list">
			
			<a href="/tags/App Engine">App Engine</a>
			
			<a href="/tags/Database">Database</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="an-insert">An Insert</h3>

<p>When we call put or makePersistent, several things happen behind the scenes before the call returns and sets the entity’s key:</p>

<ol>
  <li>The my_todo object is converted into a protocol buffer.</li>
  <li>The appserver makes an RPC call to the datastore server, sending the entity data in a protocol buffer.</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>If a key name is not provided, a unique ID is determined for this entity’s key. The entity key is composed of app ID</td>
          <td>ancestor keys</td>
          <td>kind name</td>
          <td>key name or ID</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>The datastore server processes the request in two phases that are executed in order: commit, then apply. In each phase, the datastore server identifies the Bigtable tablet servers that should receive the data.</li>
</ol>

<h3 id="the-commit-phase">The Commit Phase</h3>

<p>The datastore performs two actions in the commit phase:</p>

<ol>
  <li>It writes the data for the entities to the entity group’s log.</li>
  <li>It marks the new log entry as committed.</li>
</ol>

<h3 id="the-apply-phase">The Apply Phase</h3>

<p>In the apply phase, the entity’s data and the index rows are written to disk in parallel.</p>

<h3 id="the-return-value">The Return Value</h3>

<p>Using HRD, the Datastore returns after the commit and does the apply asynchronously.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/07/transaction-isolation-in-app-engine" rel="next" title="Transaction Isolation in App Engine">Transaction Isolation in App Engine</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/05/storingdatainappengine" rel="previous" title="Storing Data in App Engine">Storing Data in App Engine</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Storing Data in App Engine - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="learning summarize in storing data in app engine" />
	

	
	<meta name="keywords" content="Database App-engine" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Storing Data in App Engine</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-05 23:59:29 +0900
		 in <a href="/categories/technique">technique</a> 

		<span class="tag-list">
			
			<a href="/tags/Database">Database</a>
			
			<a href="/tags/App Engine">App Engine</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="storing-data">Storing Data</h3>

<p>The app engine provides several ways to store data for the application:</p>

<ol>
  <li>App Engine Datastore: A schemaless object datastore with automatic caching, query engine, and atomic transactions.</li>
  <li>Google Cloud SQL: A relationship SQL based on the MySQL database.</li>
  <li>Google Cloud Storage: size can be up to terabytes.</li>
</ol>

<h3 id="python-datastore-api">Python Datastore API</h3>

<p>An entity has one or more properties. Each entity is identified by its kind, which categorizes the entity for the purpose of queries, and a key that uniquely identifies it within its kind.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">google.appengine.ext</span> <span class="kn">import</span> <span class="n">db</span>
<span class="kn">from</span> <span class="nn">google.appengine.api</span> <span class="kn">import</span> <span class="n">users</span>


<span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
  <span class="n">role</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                           <span class="n">choices</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="s">"executive"</span><span class="p">,</span> <span class="s">"manager"</span><span class="p">,</span> <span class="s">"producer"</span><span class="p">]))</span>
  <span class="n">hire_date</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">DateProperty</span><span class="p">()</span>
  <span class="n">new_hire_training_completed</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">BooleanProperty</span><span class="p">(</span><span class="n">indexed</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
  <span class="n">email</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>


<span class="n">e</span> <span class="o">=</span> <span class="n">Employee</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"John"</span><span class="p">,</span>
             <span class="n">role</span><span class="o">=</span><span class="s">"manager"</span><span class="p">,</span>
             <span class="n">email</span><span class="o">=</span><span class="n">users</span><span class="o">.</span><span class="n">get_current_user</span><span class="p">()</span><span class="o">.</span><span class="n">email</span><span class="p">())</span>
<span class="n">e</span><span class="o">.</span><span class="n">hire_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
<span class="n">e</span><span class="o">.</span><span class="n">put</span><span class="p">()</span></code></pre></figure>

<p>Query Examples:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">training_registration_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Alfred.Smith@example.com"</span><span class="p">,</span>
                              <span class="s">"jharrison@example.com"</span><span class="p">,</span>
                              <span class="s">"budnelson@example.com"</span><span class="p">]</span>
<span class="n">employees_trained</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">GqlQuery</span><span class="p">(</span><span class="s">"SELECT * FROM Employee WHERE email IN :1"</span><span class="p">,</span>
                                <span class="n">training_registration_list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">employees_trained</span><span class="p">:</span>
  <span class="n">e</span><span class="o">.</span><span class="n">new_hire_training_completed</span> <span class="o">=</span> <span class="bp">True</span>
  <span class="n">db</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></code></pre></figure>

<h3 id="comparison-with-traditional-databases">Comparison with traditional databases</h3>

<p>It differs from them in the way it describes relationships between data objects. Entities of the same kind can have different properties, and different entities can have properties with the same name but different value types.</p>

<h3 id="entities">Entities</h3>

<p>Objects in the Datastore are entities.</p>

<h4 id="kindskeys-and-identifiers">Kinds,keys, and identifiers</h4>

<p>Each entity is a particular kinds, which categorizes the entity for the purpose of queries. In addition, each entity has its own key, which uniquely identifies it. The key consists of the following components:</p>

<ol>
  <li>The entity’s kind</li>
  <li>identifier, which can be either
    <ul>
      <li>a key name string</li>
      <li>an integer ID</li>
    </ul>
  </li>
  <li>An optional ancestor path locating the entity within the Datastore hierarchy</li>
</ol>

<h4 id="ancestor-paths">Ancestor paths</h4>

<p>Entities in the Datastore form a hierarchically structured space similar to the directory structure of a file system.</p>

<blockquote>

  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Person:GreatGrandpa, Person:Grandpa, Person:Dad, Person:Me]
</code></pre></div>  </div>
</blockquote>

<h3 id="queries-and-indexes">Queries and indexes</h3>

<p>A typical query includes the following:</p>

<ul>
  <li>An entity kind to which the query applies</li>
  <li>Zero or more filters based on the entities’ property values, keys, and ancestors</li>
  <li>Zero or more sort orders to sequence the results</li>
</ul>

<p>App Engine predefines a simple index on each property of an entity. An App Engine application can define further custom indexes in an index configuration file named index.yaml.</p>

<h3 id="transactions">Transactions</h3>

<p>Every attempt to insert, update, or delete an entity takes place in the context of a transaction. A single transaction can include any number of such operations. To maintain the consistency of the data, the transaction ensures that all of the operations it contains are applied to the Datastore as a unit or, if any of the operations fails, that none of them are applied.</p>

<p>You can perform multiple actions on an entity within a single transaction.</p>

<h4 id="transactions-and-entity-groups">Transactions and entity groups</h4>

<p>Only ancestor queries are allowed within a transaction: that is, each transactional query must be limited to a single entity group. The transaction itself can apply to multiple entities, which can belong either to a single entity group or (in the case of a cross-group transaction) to as many as five different entity groups.</p>

<h4 id="cross-group-transactions">Cross-group transactions</h4>

<p>The transaction can be applied across a maximum of five entity groups, and will succeed as long as no concurrent transaction touches any of the entity groups to which it applies.</p>

<p>As in a single-group transaction, you cannot perform a non-ancestor query in an XG transaction. You can, however, perform ancestor queries on separate entity groups.</p>

<h3 id="datastore-writes-and-data-visibility">Datastore writes and data visibility</h3>

<p>Data is written to the Datastore in two phases:</p>

<ol>
  <li>In the Commit phase, the entity data is recorded in a log.</li>
  <li>The Apply phase consists of two actions performed in parallel:
    <ul>
      <li>The entity data is written.</li>
      <li>The index rows for the entity are written. (Note that this can take longer than writing the data itself.)</li>
    </ul>
  </li>
</ol>

<p>The write operation returns immediately after the Commit phase and the Apply phase then takes place asynchronously.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/07/life-of-a-datastore-write" rel="next" title="Life of a Datastore Write">Life of a Datastore Write</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/10/29/jinja2" rel="previous" title="Jinja2">Jinja2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Datastructure">Datastructure</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Linklist Mergesort - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library Linklist Mergesort" />
	

	
	<meta name="keywords" content="Data structure, Source Code" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Linklist Mergesort</h1>
	<h4 class="large-bottom">
		Posted on 2014-01-24 03:27:36 +0900
		 in <a href="/categories/Data structure">Data structure</a> 

		<span class="tag-list">
			
			<a href="/tags/Datastructure">Datastructure</a>
			
			<a href="/tags/Sourcecode">Sourcecode</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="linkedlist-mergesort-in-linux-kernal">Linkedlist mergesort in Linux kernal</h4>

<p>Merge sort on array can be easily done due to it is easy to find the specific data in 
a any given position index value. While, if it were the case in the linkedlist, it would
be tough to implemente the mergesort efficienty.</p>

<p>Thanks to the <a href="http://cstheory.stackexchange.com/questions/19759/core-algorithms-deployed/19773#19773">post</a>, 
I found the following source code in the <a href="https://github.com/mirrors/linux-2.6/blob/master/lib/list_sort.c">Linux 2.6</a></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/*
 * Returns a list organized in an intermediate format suited
 * to chaining of merge() calls: null-terminated, no reserved or
 * sentinel head node, "prev" links not maintained.
 */</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="nf">merge</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
				<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cmp</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">b</span><span class="p">),</span>
				<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">head</span><span class="p">,</span> <span class="o">*</span><span class="n">tail</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">head</span><span class="p">;</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">a</span> <span class="o">&amp;&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* if equal, take 'a' -- important for sort stability */</span>
		<span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="n">cmp</span><span class="p">)(</span><span class="n">priv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">tail</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
			<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">tail</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
			<span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">tail</span> <span class="o">=</span> <span class="n">tail</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">tail</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">a</span><span class="o">?:</span><span class="n">b</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">head</span><span class="p">.</span><span class="n">next</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>The above code will merge two linked list. One extra <code class="highlighter-rouge">struct *tail</code> is being used to help construct the new linked list.</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/**
 * list_sort - sort a list
 * @priv: private data, opaque to list_sort(), passed to @cmp
 * @head: the list to sort
 * @cmp: the elements comparison function
 *
 * This function implements "merge sort", which has O(nlog(n))
 * complexity.
 *
 * The comparison function @cmp must return a negative value if @a
 * should sort before @b, and a positive value if @a should sort after
 * @b. If @a and @b are equivalent, and their original relative
 * ordering is to be preserved, @cmp must return 0.
 */</span>
<span class="kt">void</span> <span class="nf">list_sort</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">head</span><span class="p">,</span>
		<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cmp</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">b</span><span class="p">))</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">part</span><span class="p">[</span><span class="n">MAX_LIST_LENGTH_BITS</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="cm">/* sorted partial lists
						-- last slot is a sentinel */</span>
	<span class="kt">int</span> <span class="n">lev</span><span class="p">;</span>  <span class="cm">/* index into part[] */</span>
	<span class="kt">int</span> <span class="n">max_lev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">list</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">list_empty</span><span class="p">(</span><span class="n">head</span><span class="p">))</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">memset</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">part</span><span class="p">));</span>

	<span class="n">head</span><span class="o">-&gt;</span><span class="n">prev</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">list</span> <span class="o">=</span> <span class="n">head</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">list</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">cur</span> <span class="o">=</span> <span class="n">list</span><span class="p">;</span>
		<span class="n">list</span> <span class="o">=</span> <span class="n">list</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
		<span class="n">cur</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">lev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">];</span> <span class="n">lev</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cur</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">priv</span><span class="p">,</span> <span class="n">cmp</span><span class="p">,</span> <span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">],</span> <span class="n">cur</span><span class="p">);</span>
			<span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">]</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">lev</span> <span class="o">&gt;</span> <span class="n">max_lev</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="n">lev</span> <span class="o">&gt;=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">part</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">printk_once</span><span class="p">(</span><span class="n">KERN_DEBUG</span> <span class="s">"list passed to"</span>
					<span class="s">" list_sort() too long for"</span>
					<span class="s">" efficiency</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
				<span class="n">lev</span><span class="o">--</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">max_lev</span> <span class="o">=</span> <span class="n">lev</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">]</span> <span class="o">=</span> <span class="n">cur</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">lev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">lev</span> <span class="o">&lt;</span> <span class="n">max_lev</span><span class="p">;</span> <span class="n">lev</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">])</span>
			<span class="n">list</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">priv</span><span class="p">,</span> <span class="n">cmp</span><span class="p">,</span> <span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">],</span> <span class="n">list</span><span class="p">);</span>

	<span class="n">merge_and_restore_back_links</span><span class="p">(</span><span class="n">priv</span><span class="p">,</span> <span class="n">cmp</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">part</span><span class="p">[</span><span class="n">max_lev</span><span class="p">],</span> <span class="n">list</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>The above code deals with the merge sort, which is really tricky and amazing.
The key idea is in the</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c">	<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">part</span><span class="p">[</span><span class="n">MAX_LIST_LENGTH_BITS</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="cm">/* sorted partial lists
						-- last slot is a sentinel */</span></code></pre></figure>

<p>This part will store the partial lists, whose lengths whill be 
<script type="math/tex">2^i</script> where <script type="math/tex">i</script> is the index of the part array.</p>

<p>It uses the <a href="http://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci</a>
property of the length in the mergesort list. Only the same length list of occur
in the same specific position, and two same length lists will merge to a single list<br />
whose length will double while the index in the part array is just the next postion.</p>

<p>At last, just merge all the elements in the part array, then the final list is constructed!</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2014/02/03/goals-in-2014" rel="next" title="Goals in 2014">Goals in 2014</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2014/01/20/quoting-bash" rel="previous" title="Quoting and eval in Bash">Quoting and eval in Bash</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Git">Git</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Understanding Git - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Understanding Git" />
	

	
	<meta name="keywords" content="Git" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Understanding Git</h1>
	<h4 class="large-bottom">
		Posted on 2013-12-28 04:20:24 +0900
		 in <a href="/categories/Technology">Technology</a> 

		<span class="tag-list">
			
			<a href="/tags/Git">Git</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="what-is-in-git-is-snapshots">What is in Git is snapshots</h4>

<p>The most obvious feature in Git owns all the snapshots of the system, while most other VCS system 
only stores the differences.</p>

<p><img src="/images/posts/git/VCS.png" alt="alt normal" /></p>

<p>Figure 1-1. VCS usually only stores the differences.</p>

<p><img src="/images/posts/git/Git.png" alt="alt normal" /></p>

<p>Figure 1-2. Git stores the snapshots.</p>

<p>In order to get data efficienty, the Git compresses each ‘original’ file and calculate its SHA-1<br />
hash, then use a tree structure to store the whole infomition hierarchically.</p>

<h4 id="the-three-states-in-git">The three states in Git</h4>

<p>In Git, there are three states: the working directory, staging area and Git directory.</p>

<p><img src="/images/posts/git/gitstates.png" alt="alt normal" /></p>

<p>Figure 1-3. Git states</p>

<p>The basic working flows is as follows:</p>

<ul>
  <li>
    <p>Making changes in working directory.</p>
  </li>
  <li>
    <p>Stage the useful changes and add their snapshots to the staging area.</p>
  </li>
  <li>
    <p>Commit the staging area to the Git directory, which will store the snapshots of the staging area permunantly.</p>
  </li>
</ul>

<h4 id="how-the-git-store-the-snapshots">How the Git store the snapshots</h4>

<h5 id="the-git-tree-object">The Git tree object</h5>

<p>The Git store thing similar to the Unix system: the tree object corresponds to the directory entity while the blog corresponds to the 
inode or file.</p>

<p><img src="/images/posts/git/object.png" alt="alt normal" /></p>

<p>Figure 1-4. Tree object</p>

<p><img src="/images/posts/git/contentobject.png" alt="alt normal" /></p>

<p>Figure 1-5. Content structure of the tree object.</p>

<p><img src="/images/posts/git/singlecommit.png" alt="alt normal" /></p>

<p>Figure 1-6. Single commit in a compatible way.</p>

<h5 id="the-git-directory">The Git directory</h5>

<p>The Git tree structure is as follows:</p>

<p><img src="/images/posts/git/submit.png" alt="alt normal" /></p>

<p>Figure 1-7. Git directory</p>

<p><img src="/images/posts/git/multiplecommit.png" alt="alt normal" /></p>

<p>Figure 1-8. Git directory in a compatible way.</p>

<h4 id="the-git-branch">The Git branch</h4>

<p>The Git branch is a pointer to a commit, the HEAD is the pointer to your current branch.</p>

<p><img src="/images/posts/git/branch.png" alt="alt normal" /></p>

<p>Figure 1-9. Git branch</p>

<p><img src="/images/posts/git/head.png" alt="alt normal" /></p>

<p>Figure 1-10. Git head.</p>

<h4 id="reference">Reference</h4>

<p>[1] <a href="http://marklodato.github.io/visual-git-guide/index-en.html">Visual git tutorial</a></p>

<p>[2]  <a href="https://github.s3.amazonaws.com/media/progit.en.pdf">Git tutorial</a></p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2014/01/06/past2013" rel="next" title="逝去的2013">逝去的2013</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/12/06/vimnote" rel="previous" title="Vim Tips">Vim Tips</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Git Commands - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library Git Commands" />
	

	
	<meta name="keywords" content="The useful git commands" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Git Commands</h1>
	<h4 class="large-bottom">
		Posted on 2013-10-29 20:31:03 +0900
		 in <a href="/categories/Technique">Technique</a> 

		<span class="tag-list">
			
			<a href="/tags/Git">Git</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>Here is a useful tutorial for Git:<a href="http://marklodato.github.io/visual-git-guide/index-en.html#reset">Visual git guide</a></p>

<ul>
  <li>
    <p><code class="highlighter-rouge">git status</code></p>

    <p>Check the status of the files.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">gitk -all &amp; git diff</code></p>

    <p>show the branch in graphical mode.</p>

    <p>check the difference.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git rm</code></p>

    <p>remove files</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git log</code></p>

    <ul>
      <li>
        <p><code class="highlighter-rouge">git log -p -2</code></p>

        <p>show the changing between the past two submitions</p>
      </li>
      <li>
        <p><code class="highlighter-rouge">git log --oneline</code></p>

        <p>Condense each commit to a single line.</p>
      </li>
      <li>
        <p><code class="highlighter-rouge">git log --stat</code></p>

        <p>Along with the ordinary git log information, include which files were altered and the relative number of lines that were added or deleted from each of them.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="highlighter-rouge">git commit --amend</code></p>

    <p>replace the last submit</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git reset HEAD</code></p>

    <p>unstage files</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git add .</code></p>

    <p>add all the files in the subdirectory.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git checkout \&lt;file\&gt;-</code></p>

    <p>unmodifying a modified file, revert it back to what it looked like when last committed.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git remote -v</code></p>

    <p>shows the URL for the shorname to be expaned to</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git remote show origin</code></p>

    <p>list the more infomation of the remote</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git push origin local-branch-name:remote-branch-name</code></p>

    <p>push to specilized banch</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git push origin :newfeature</code></p>

    <p>delete remote branch newfeature</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git merge --squash bugfix</code>&amp;<code class="highlighter-rouge">git commit -m 'fix bug'</code></p>

    <p>Take all the commits from the <code class="highlighter-rouge">bugfix</code> branch, squash them into 1 commit and then merge it with the  <code class="highlighter-rouge">master</code> branch</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git fetch origin &amp; git checkout -b test origin/test</code></p>

    <p>fetch all the remote branches and checkout the specific branch</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git branch -a</code></p>

    <p>show the branch info in remote and local</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git checkout --track</code></p>

    <p>set the track branch</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git rebase</code></p>

    <p>take all the changes that were commited on one branch and replay on another one.</p>

    <ul>
      <li>
        <p><code class="highlighter-rouge">git rebase -i \&lt;the SHA-1 of unchanged commit\&gt;</code></p>

        <p>merge multiple commits
 pick = use the commit
 squash = use commit, but merge into previous commit</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="highlighter-rouge">git cherrypick &lt;the SHA-1 of unchanged commit&gt;</code></p>

    <p>pick the specified commit to the current branch</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git diff \&lt;branch\&gt; \&lt;branch\&gt;</code></p>

    <p>compare the difference between two branches</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git stash save 'comment'</code></p>

    <p>save the changes temporary</p>

    <ul>
      <li>
        <p><code class="highlighter-rouge">git stash list</code></p>

        <p>view the stash list</p>
      </li>
      <li>
        <p><code class="highlighter-rouge">git stash apply stash@{2}</code></p>

        <p>apply the specified stash.</p>
      </li>
      <li>
        <p><code class="highlighter-rouge">git stash apply --index</code></p>

        <p>reapply the staged changes</p>
      </li>
      <li>
        <p><code class="highlighter-rouge">git stash drop</code></p>

        <p>remote from the stash list</p>
      </li>
      <li>
        <p><code class="highlighter-rouge">git stash pop</code></p>

        <p>apply the stash and immediately drop it from the stack. Be causious.</p>
      </li>
      <li>
        <p><code class="highlighter-rouge">git stash branch</code></p>

        <p>creating a branch from a stash</p>
      </li>
    </ul>
  </li>
</ul>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/10/29/jinja2" rel="next" title="Jinja2">Jinja2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/03/17/talkinjapaneseforeignaffair" rel="previous" title="日本大使馆活动见闻">日本大使馆活动见闻</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>如何使用模板 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="使用模板的方法" />
	

	
	<meta name="keywords" content="jekyll git github" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>如何使用模板</h1>
	<h4 class="large-bottom">
		Posted on 2012-12-28 06:44:30 +0900
		 in <a href="/categories/jekyll">jekyll</a> 

		<span class="tag-list">
			
			<a href="/tags/Jekyll">Jekyll</a>
			
			<a href="/tags/Git">Git</a>
			
			<a href="/tags/Github">Github</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-介绍">1 介绍</h2>

<p>在github上搭建一个中小型网站，可以充分利用github提供的托管功能，并且不用担心代码丢失的问题，是一件很惬意的事情。</p>

<h2 id="2-安装">2 安装</h2>

<p>基本参照<a href="http://kamelzcs.github.com/2012/08/14/blogging-with-jekyll/">http://kamelzcs.github.com/2012/08/14/blogging-with-jekyll/</a>即可。
说明几个需要注意的问题：</p>

<ol>
  <li>建立 username.github.com 这样的repo，这样就可以直接使用这个域名访问网站.</li>
  <li>_compiled主要用来中转,将_site拷贝过来之后，然后将目录切换到 _compiled，因为 _compiled 克隆的时候用的是master，所以自动切换到了master分支，然后提交到master分支。这里有个疑问,_compiled既然克隆出来的时候是在master分支，为什么在source分支下又可以看到这个文件夹，暂时不清楚。</li>
  <li>git会自动确定切换分支时哪些文件该出现，哪些不应该出现。</li>
</ol>

<p>2013年10月28日 更新：
jekyll升级到1.2.1 以后，jekyll-pagination会导致jekyll在 build的时候失败，只能将pagination.rb手动更新为最新的代码,同时__plugin文件夹中不能使用中文。</p>

<p>2015年1月21日 更新：
jekyll升级到2.5.4 以后，jekyll-pagination已经被内置jekyll-paginate代替。</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/01/02/review-2012" rel="next" title="review 2012">review 2012</a>
		
	
		
			
		
		
	
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Github">Github</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>如何使用模板 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="使用模板的方法" />
	

	
	<meta name="keywords" content="jekyll git github" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>如何使用模板</h1>
	<h4 class="large-bottom">
		Posted on 2012-12-28 06:44:30 +0900
		 in <a href="/categories/jekyll">jekyll</a> 

		<span class="tag-list">
			
			<a href="/tags/Jekyll">Jekyll</a>
			
			<a href="/tags/Git">Git</a>
			
			<a href="/tags/Github">Github</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-介绍">1 介绍</h2>

<p>在github上搭建一个中小型网站，可以充分利用github提供的托管功能，并且不用担心代码丢失的问题，是一件很惬意的事情。</p>

<h2 id="2-安装">2 安装</h2>

<p>基本参照<a href="http://kamelzcs.github.com/2012/08/14/blogging-with-jekyll/">http://kamelzcs.github.com/2012/08/14/blogging-with-jekyll/</a>即可。
说明几个需要注意的问题：</p>

<ol>
  <li>建立 username.github.com 这样的repo，这样就可以直接使用这个域名访问网站.</li>
  <li>_compiled主要用来中转,将_site拷贝过来之后，然后将目录切换到 _compiled，因为 _compiled 克隆的时候用的是master，所以自动切换到了master分支，然后提交到master分支。这里有个疑问,_compiled既然克隆出来的时候是在master分支，为什么在source分支下又可以看到这个文件夹，暂时不清楚。</li>
  <li>git会自动确定切换分支时哪些文件该出现，哪些不应该出现。</li>
</ol>

<p>2013年10月28日 更新：
jekyll升级到1.2.1 以后，jekyll-pagination会导致jekyll在 build的时候失败，只能将pagination.rb手动更新为最新的代码,同时__plugin文件夹中不能使用中文。</p>

<p>2015年1月21日 更新：
jekyll升级到2.5.4 以后，jekyll-pagination已经被内置jekyll-paginate代替。</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/01/02/review-2012" rel="next" title="review 2012">review 2012</a>
		
	
		
			
		
		
	
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Haskell">Haskell</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Monads - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Monads" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Monads</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-24 19:16:47 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p><a href="https://wiki.haskell.org/Typeclassopedia">Type class</a> really gives one good intuition about <code class="highlighter-rouge">Monad</code>.</p>

<blockquote>
  <p>Intuitively, it is this ability to use the output from previous computations to decide what computations to run next that makes Monad more powerful than Applicative. The structure of an Applicative computation is fixed, whereas the structure of a Monad computation can change based on intermediate results. This also means that parsers built using an Applicative interface can only parse context-free languages; in order to parse context-sensitive languages a Monad interface is needed</p>
</blockquote>

<p><a href="http://yogsototh.github.io/Category-Theory-Presentation/categories.html#slide-71">Category theory</a> gives some theorems behind <code class="highlighter-rouge">Monad</code>.</p>

<blockquote>
  <p>All told, a monad in X is just a monoid in the category of endofunctors of X, with product × replaced by composition of endofunctors and unit set by the identity endofunctor.</p>
</blockquote>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">battle</span> <span class="o">::</span> <span class="kt">Battlefield</span> <span class="o">-&gt;</span> <span class="kt">Rand</span> <span class="kt">StdGen</span> <span class="kt">Battlefield</span>
<span class="n">battle</span> <span class="n">b</span> <span class="o">=</span> <span class="kr">do</span>
    <span class="p">(</span><span class="n">aStream</span> <span class="o">::</span> <span class="p">[</span><span class="kt">DieValue</span><span class="p">])</span> <span class="o">&lt;-</span> <span class="n">getRandoms</span>
    <span class="p">(</span><span class="n">bStream</span> <span class="o">::</span> <span class="p">[</span><span class="kt">DieValue</span><span class="p">])</span> <span class="o">&lt;-</span> <span class="n">getRandoms</span>
    <span class="kr">let</span> <span class="n">rollPairs</span> <span class="o">=</span> <span class="n">zip</span> <span class="p">(</span><span class="n">sort</span> <span class="o">.</span> <span class="n">take</span> <span class="n">numAttackRolls</span>   <span class="o">$</span> <span class="n">aStream</span><span class="p">)</span>
                        <span class="p">(</span><span class="n">sort</span> <span class="o">.</span> <span class="n">take</span> <span class="n">numDefenderRolls</span> <span class="o">$</span> <span class="n">bStream</span><span class="p">)</span>
    <span class="n">return</span> <span class="o">$</span> <span class="n">foldl'</span> <span class="p">(</span><span class="nf">\</span><span class="n">newB</span> <span class="p">(</span><span class="n">attackRoll</span><span class="p">,</span> <span class="n">defendRoll</span><span class="p">)</span> <span class="o">-&gt;</span>
                        <span class="kr">if</span> <span class="n">attackRoll</span> <span class="o">&gt;</span> <span class="n">defendRoll</span>
                        <span class="kr">then</span> <span class="n">newB</span> <span class="p">{</span> <span class="n">defenders</span> <span class="o">=</span> <span class="n">defenders</span> <span class="n">newB</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}</span>
                        <span class="kr">else</span> <span class="n">newB</span> <span class="p">{</span> <span class="n">attackers</span> <span class="o">=</span> <span class="n">attackers</span> <span class="n">newB</span> <span class="o">-</span> <span class="mi">1</span><span class="p">})</span>
                    <span class="n">b</span>
                    <span class="n">rollPairs</span>
  <span class="kr">where</span>
    <span class="n">numAttackRolls</span>   <span class="o">=</span> <span class="n">min</span> <span class="mi">3</span> <span class="p">(</span><span class="n">attackers</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">numDefenderRolls</span> <span class="o">=</span> <span class="n">min</span> <span class="mi">2</span> <span class="p">(</span><span class="n">defenders</span> <span class="n">b</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">invade</span> <span class="o">::</span> <span class="kt">Battlefield</span> <span class="o">-&gt;</span> <span class="kt">Rand</span> <span class="kt">StdGen</span> <span class="kt">Battlefield</span>
<span class="n">invade</span> <span class="n">bf</span><span class="o">@</span><span class="p">(</span><span class="kt">Battlefield</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">return</span> <span class="n">bf</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">battle</span> <span class="n">bf</span> <span class="o">&gt;&gt;=</span> <span class="n">invade</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">successProb</span> <span class="o">::</span> <span class="kt">Battlefield</span> <span class="o">-&gt;</span> <span class="kt">Rand</span> <span class="kt">StdGen</span> <span class="kt">Double</span>
<span class="n">successProb</span> <span class="n">bf</span> <span class="o">=</span> <span class="kr">do</span>
  <span class="kr">let</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">10000</span>
  <span class="n">results</span> <span class="o">&lt;-</span> <span class="n">replicateM</span> <span class="n">num</span> <span class="p">(</span><span class="n">invade</span> <span class="n">bf</span><span class="p">)</span>
  <span class="n">return</span> <span class="o">$</span> <span class="n">fromIntegral</span> <span class="p">(</span><span class="n">wins</span> <span class="n">results</span><span class="p">)</span> <span class="o">/</span> <span class="n">fromIntegral</span> <span class="n">num</span>
  <span class="kr">where</span> <span class="n">wins</span> <span class="o">=</span> <span class="n">length</span> <span class="o">.</span> <span class="n">filter</span> <span class="p">((</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">.</span> <span class="n">defenders</span><span class="p">)</span></code></pre></figure>

<p>Test code:</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="o">*</span><span class="kt">Risk</span><span class="o">&gt;</span> <span class="n">evalRandIO</span>  <span class="o">$</span> <span class="n">successProb</span> <span class="o">$</span> <span class="kt">Battlefield</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mf">0.1338</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2019/12/23/from-jackknife-to-ab-testing" rel="next" title="From Jackknife to A/B Testing">From Jackknife to A/B Testing</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/24/applicative-functors-part-ii" rel="previous" title="Applicative functors, Part II">Applicative functors, Part II</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Applicative functors, Part II - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Functional Programming" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Applicative functors, Part II</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-24 00:25:09 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p>The classification about <code class="highlighter-rouge">Levels of Abstraction</code> is really great.</p>

<blockquote>
  <p>With respect to Applicative and Monad in particular, there are just two levels to be concerned with. The first is the level of implementing various Applicative and Monad instances, i.e. the “raw Haskell” level.
Once we have an Applicative instance for a type like Parser, the point is that we get to “move up a layer” and program with Parsers using the Applicative interface, without thinking about the details of how Parser and its Applicative instance are actually implemented.</p>
</blockquote>

<p>The powerful <code class="highlighter-rouge">Type system</code> of <code class="highlighter-rouge">Haskell</code> makes it really suitable to create <code class="highlighter-rouge">Levels of Abstraction</code>,
which is usually very verbose or even impossible in other static typed programming languages.</p>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">zeroOrMore</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Parser</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="n">zeroOrMore</span> <span class="n">p</span> <span class="o">=</span> <span class="n">oneOrMore</span> <span class="n">p</span> <span class="o">&lt;|&gt;</span> <span class="n">pure</span> <span class="kt">[]</span>

<span class="n">oneOrMore</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Parser</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="n">oneOrMore</span> <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="o">:</span><span class="p">)</span> <span class="o">&lt;$&gt;</span> <span class="n">p</span> <span class="o">&lt;*&gt;</span> <span class="n">zeroOrMore</span> <span class="n">p</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">spaces</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">String</span>
<span class="n">spaces</span> <span class="o">=</span> <span class="n">zeroOrMore</span> <span class="o">$</span> <span class="n">satisfy</span> <span class="n">isSpace</span>

<span class="n">ident</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">String</span>
<span class="n">ident</span> <span class="o">=</span> <span class="p">(</span><span class="o">:</span><span class="p">)</span> <span class="o">&lt;$&gt;</span> <span class="p">(</span><span class="n">satisfy</span> <span class="n">isAlpha</span><span class="p">)</span> <span class="o">&lt;*&gt;</span> <span class="n">zeroOrMore</span> <span class="p">(</span><span class="n">satisfy</span> <span class="n">isAlphaNum</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- An "identifier" is represented as just a String; however, only</span>
<span class="c1">-- those Strings consisting of a letter followed by any number of</span>
<span class="c1">-- letters and digits are valid identifiers.</span>
<span class="kr">type</span> <span class="kt">Ident</span> <span class="o">=</span> <span class="kt">String</span>

<span class="c1">-- An "atom" is either an integer value or an identifier.</span>
<span class="kr">data</span> <span class="kt">Atom</span> <span class="o">=</span> <span class="kt">N</span> <span class="kt">Integer</span> <span class="o">|</span> <span class="kt">I</span> <span class="kt">Ident</span>
  <span class="kr">deriving</span> <span class="kt">Show</span>

<span class="c1">-- An S-expression is either an atom, or a list of S-expressions.</span>
<span class="kr">data</span> <span class="kt">SExpr</span> <span class="o">=</span> <span class="kt">A</span> <span class="kt">Atom</span>
           <span class="o">|</span> <span class="kt">Comb</span> <span class="p">[</span><span class="kt">SExpr</span><span class="p">]</span>
  <span class="kr">deriving</span> <span class="kt">Show</span>

<span class="n">parseAtom</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">Atom</span>
<span class="n">parseAtom</span> <span class="o">=</span> <span class="n">spaces</span> <span class="o">*&gt;</span> <span class="p">(</span><span class="kt">N</span> <span class="o">&lt;$&gt;</span> <span class="n">posInt</span> <span class="o">&lt;|&gt;</span> <span class="kt">I</span> <span class="o">&lt;$&gt;</span> <span class="n">ident</span><span class="p">)</span> <span class="o">&lt;*</span> <span class="n">spaces</span>

<span class="n">parseComb</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">SExpr</span>
<span class="n">parseComb</span> <span class="o">=</span> <span class="n">spaces</span> <span class="o">*&gt;</span> <span class="p">(</span><span class="kt">Comb</span> <span class="o">&lt;$&gt;</span> <span class="p">(</span><span class="n">char</span> <span class="sc">'('</span> <span class="o">*&gt;</span> <span class="n">oneOrMore</span> <span class="n">parseSExpr</span> <span class="o">&lt;*</span> <span class="n">char</span> <span class="sc">')'</span><span class="p">))</span> <span class="o">&lt;*</span> <span class="n">spaces</span>

<span class="n">parseSExpr</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="kt">SExpr</span>
<span class="n">parseSExpr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">A</span> <span class="o">&lt;$&gt;</span> <span class="n">parseAtom</span><span class="p">)</span> <span class="o">&lt;|&gt;</span> <span class="n">parseComb</span></code></pre></figure>

<p>Test:</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="o">*</span><span class="kt">SExpr</span><span class="o">&gt;</span> <span class="n">runParser</span> <span class="n">parseSExpr</span> <span class="s">"(   lots  of   (  spaces   in  )  this ( one ) )"</span>
<span class="kt">Just</span> <span class="p">(</span><span class="kt">Comb</span> <span class="p">[</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"lots"</span><span class="p">),</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"of"</span><span class="p">),</span><span class="kt">Comb</span> <span class="p">[</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"spaces"</span><span class="p">),</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"in"</span><span class="p">)],</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"this"</span><span class="p">),</span><span class="kt">Comb</span> <span class="p">[</span><span class="kt">A</span> <span class="p">(</span><span class="kt">I</span> <span class="s">"one"</span><span class="p">)]],</span><span class="s">""</span><span class="p">)</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/24/monads" rel="next" title="Monads">Monads</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/23/applicative-functors-part-i" rel="previous" title="Applicative functors, Part I">Applicative functors, Part I</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Applicative functors, Part I - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Applicative functors, Part I" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Applicative functors, Part I</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-23 19:40:32 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p>The induction from <code class="highlighter-rouge">Functor</code> to <code class="highlighter-rouge">Applicative</code> is quite beautiful.</p>

<p>Recalled that there exists <code class="highlighter-rouge">fmap :: (a -&gt; b) -&gt; (f a -&gt; f b)</code> in <code class="highlighter-rouge">Functor</code>, it would be great if this mapping
function is still valid if the input consists of more than one variable, namely <code class="highlighter-rouge">(a -&gt; b -&gt; c) -&gt; (f a -&gt; f b -&gt; f c)</code></p>

<p>We have</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">h</span>  <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span>
<span class="n">fa</span> <span class="o">::</span> <span class="n">f</span> <span class="n">a</span>
<span class="n">fb</span> <span class="o">::</span> <span class="n">f</span> <span class="n">b</span>
<span class="n">fc</span> <span class="o">::</span> <span class="n">f</span> <span class="n">c</span></code></pre></figure>

<p>Use <code class="highlighter-rouge">fmap</code> to lift functions,</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">h</span>         <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span>
<span class="n">fmap</span> <span class="n">h</span>    <span class="o">::</span> <span class="n">f</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span>
<span class="n">fmap</span> <span class="n">h</span> <span class="n">fa</span> <span class="o">::</span> <span class="n">f</span> <span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span></code></pre></figure>

<p>But there is no way to make</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">f</span> <span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fb</span> <span class="o">-&gt;</span> <span class="n">fc</span></code></pre></figure>

<p><code class="highlighter-rouge">Applicative</code> has the <code class="highlighter-rouge">(&lt;*&gt;)</code> to implement it, namely</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="p">(</span><span class="o">&lt;*&gt;</span><span class="p">)</span> <span class="o">::</span> <span class="n">f</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">b</span></code></pre></figure>

<p>The final induction is</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">liftA2</span> <span class="o">::</span> <span class="kt">Applicative</span> <span class="n">f</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">c</span>
<span class="n">liftA2</span> <span class="o">=</span> <span class="n">h</span> <span class="o">&lt;$&gt;</span> <span class="n">fa</span> <span class="o">&lt;*&gt;</span> <span class="n">fb</span></code></pre></figure>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- Ex. 1 - implement a Functor instance for Parser</span>
<span class="c1">--</span>
<span class="c1">-- You may find it useful to implement:</span>
<span class="c1">-- first :: (a -&gt; b) -&gt; (a,c) -&gt; (b,c)</span>

<span class="n">first</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">first</span> <span class="n">f</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Functor</span> <span class="kt">Parser</span> <span class="kr">where</span>
  <span class="n">fmap</span> <span class="n">f</span> <span class="n">parser</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="o">$</span> <span class="nf">\</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">first</span> <span class="n">f</span> <span class="o">&lt;$&gt;</span> <span class="n">runParser</span> <span class="n">parser</span> <span class="n">s</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- Ex. 2 - implement an Applicative instance for Parser</span>
<span class="c1">--</span>
<span class="kr">instance</span> <span class="kt">Applicative</span> <span class="kt">Parser</span> <span class="kr">where</span>
  <span class="n">pure</span> <span class="n">a</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="p">(</span><span class="nf">\</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="kt">Just</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>

  <span class="n">p1</span> <span class="o">&lt;*&gt;</span> <span class="n">p2</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="n">parse</span>
    <span class="kr">where</span> <span class="n">parse</span> <span class="n">s</span> <span class="o">=</span> <span class="kr">do</span>
          <span class="n">r1</span> <span class="o">&lt;-</span> <span class="n">runParser</span> <span class="n">p1</span> <span class="n">s</span>
          <span class="n">r2</span> <span class="o">&lt;-</span> <span class="n">runParser</span> <span class="n">p2</span> <span class="p">(</span><span class="n">snd</span> <span class="n">r1</span><span class="p">)</span>
          <span class="n">return</span> <span class="p">(</span><span class="n">fst</span> <span class="n">r1</span> <span class="o">$</span> <span class="n">fst</span> <span class="n">r2</span><span class="p">,</span> <span class="n">snd</span> <span class="n">r2</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- Ex. 3a - Create a parser:</span>
<span class="c1">--</span>
<span class="c1">--   abParser :: Parser (Char, Char)</span>
<span class="c1">--</span>
<span class="c1">-- which expects to see the characters ’a’ and ’b’ and returns them as a pair</span>

<span class="n">abParser</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="p">(</span><span class="kt">Char</span><span class="p">,</span> <span class="kt">Char</span><span class="p">)</span>
<span class="n">abParser</span> <span class="o">=</span> <span class="p">(,)</span> <span class="o">&lt;$&gt;</span> <span class="n">char</span> <span class="sc">'a'</span> <span class="o">&lt;*&gt;</span> <span class="n">char</span> <span class="sc">'b'</span>


<span class="c1">-- Ex. 3b - Create a parser:</span>
<span class="c1">--</span>
<span class="c1">--   abParser_ :: Parser ()</span>
<span class="c1">--</span>
<span class="c1">-- which acts in the same way as abParser but returns () instead of 'a' and 'b'</span>

<span class="n">abParser_</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="nb">()</span>
<span class="n">abParser_</span> <span class="o">=</span> <span class="n">const</span> <span class="o">.</span> <span class="n">const</span> <span class="nb">()</span> <span class="o">&lt;$&gt;</span> <span class="n">char</span> <span class="sc">'a'</span> <span class="o">&lt;*&gt;</span> <span class="n">char</span> <span class="sc">'b'</span>

<span class="c1">-- Ex. 3c - Create a parser:</span>
<span class="c1">--</span>
<span class="c1">--   intPair </span>
<span class="c1">--</span>
<span class="c1">-- which reads two integer values separated by a space and returns the integer </span>
<span class="c1">-- values in a list. You should use the provided posInt to parse the integer values.</span>

<span class="n">intPair</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">intPair</span> <span class="o">=</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span>  <span class="n">y</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span> <span class="o">&lt;$&gt;</span> <span class="n">posInt</span> <span class="o">&lt;*</span> <span class="n">char</span> <span class="sc">' '</span> <span class="o">&lt;*&gt;</span> <span class="n">posInt</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Alternative</span> <span class="kt">Parser</span> <span class="kr">where</span>
  <span class="n">empty</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="o">$</span> <span class="n">const</span> <span class="kt">Nothing</span>
  <span class="kt">Parser</span> <span class="n">p1</span> <span class="o">&lt;|&gt;</span> <span class="kt">Parser</span> <span class="n">p2</span> <span class="o">=</span> <span class="kt">Parser</span> <span class="o">$</span> <span class="n">liftA2</span> <span class="p">(</span><span class="o">&lt;|&gt;</span><span class="p">)</span> <span class="n">p1</span> <span class="n">p2</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- Ex. 5 - Implement a parser:</span>
<span class="c1">--</span>
<span class="c1">--  intOrUppercase :: Parser ()</span>
<span class="c1">-- </span>
<span class="c1">-- which parses either an integer value or an uppercase character, and fails otherwise.</span>

<span class="n">intOrUppercase</span> <span class="o">::</span> <span class="kt">Parser</span> <span class="nb">()</span>
<span class="n">intOrUppercase</span> <span class="o">=</span> <span class="n">const</span> <span class="nb">()</span> <span class="o">&lt;$&gt;</span> <span class="n">posInt</span> <span class="o">&lt;|&gt;</span> <span class="n">const</span> <span class="nb">()</span> <span class="o">&lt;$&gt;</span> <span class="n">satisfy</span> <span class="n">isUpper</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/24/applicative-functors-part-ii" rel="next" title="Applicative functors, Part II">Applicative functors, Part II</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/22/io" rel="previous" title="IO">IO</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>IO - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="IO" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>IO</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-22 06:08:38 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<blockquote>
  <p>There is no String “inside” an <code class="highlighter-rouge">IO String</code>, <code class="highlighter-rouge">IO String</code> is a promise, to produce a String requires actually executing the computation. And the only way to do that is to give it (perhaps as part of some larger IO value) to the Haskell runtime system, via main.</p>
</blockquote>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- 1. define glCons, which adds an Employee to GuestList</span>

<span class="n">glCons</span> <span class="o">::</span> <span class="kt">Employee</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span>
<span class="n">glCons</span> <span class="n">e</span> <span class="p">(</span><span class="kt">GL</span> <span class="n">es</span> <span class="n">fun</span><span class="p">)</span> <span class="o">=</span> <span class="kt">GL</span> <span class="p">(</span><span class="n">e</span><span class="o">:</span><span class="n">es</span><span class="p">)</span> <span class="p">(</span><span class="n">fun</span> <span class="o">+</span> <span class="n">empFun</span> <span class="n">e</span><span class="p">)</span>


<span class="c1">-- 2. define a Monoid instance for GuestList</span>

<span class="kr">instance</span> <span class="kt">Monoid</span> <span class="kt">GuestList</span> <span class="kr">where</span>
  <span class="n">mempty</span>  <span class="o">=</span> <span class="kt">GL</span> <span class="kt">[]</span> <span class="mi">0</span>
  <span class="n">mappend</span> <span class="p">(</span><span class="kt">GL</span> <span class="n">es1</span> <span class="n">f1</span><span class="p">)</span> <span class="p">(</span><span class="kt">GL</span> <span class="n">es2</span> <span class="n">f2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">GL</span> <span class="p">(</span><span class="n">es1</span> <span class="o">++</span> <span class="n">es2</span><span class="p">)</span> <span class="o">$</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span>

<span class="c1">-- 3. define moreFun, which takes two GuestLists and returns the one</span>
<span class="c1">-- which has more fun</span>

<span class="n">moreFun</span> <span class="o">::</span> <span class="kt">GuestList</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span>
<span class="n">moreFun</span> <span class="o">=</span> <span class="n">max</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">treeFold</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Tree</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span>
<span class="n">treeFold</span> <span class="n">f</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">a</span> <span class="kt">[]</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span> <span class="n">a</span> <span class="kt">[]</span>
<span class="n">treeFold</span> <span class="n">f</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">a</span> <span class="n">forest</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span> <span class="n">a</span> <span class="p">(</span><span class="n">map</span> <span class="p">(</span><span class="n">treeFold</span> <span class="n">f</span><span class="p">)</span> <span class="n">forest</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">nextLevel</span> <span class="o">::</span> <span class="kt">Employee</span> <span class="o">-&gt;</span> <span class="p">[(</span><span class="kt">GuestList</span><span class="p">,</span> <span class="kt">GuestList</span><span class="p">)]</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">GuestList</span><span class="p">,</span> <span class="kt">GuestList</span><span class="p">)</span>
<span class="n">nextLevel</span> <span class="n">b</span> <span class="n">gls</span> <span class="o">=</span> <span class="p">(</span><span class="n">withBoss</span><span class="p">,</span> <span class="n">withoutBoss</span><span class="p">)</span>
  <span class="kr">where</span>
    <span class="n">withoutBoss</span> <span class="o">=</span> <span class="n">mconcat</span> <span class="o">$</span> <span class="n">map</span> <span class="p">(</span><span class="n">uncurry</span> <span class="n">moreFun</span><span class="p">)</span> <span class="n">gls</span>
    <span class="n">withBoss</span> <span class="o">=</span> <span class="n">glCons</span> <span class="n">b</span> <span class="o">$</span> <span class="n">mconcat</span> <span class="o">$</span> <span class="n">map</span> <span class="n">snd</span> <span class="n">gls</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">maxFun</span> <span class="o">::</span> <span class="kt">Tree</span> <span class="kt">Employee</span> <span class="o">-&gt;</span> <span class="kt">GuestList</span>
<span class="n">maxFun</span> <span class="o">=</span> <span class="n">uncurry</span> <span class="n">moreFun</span> <span class="o">.</span> <span class="n">treeFold</span> <span class="n">nextLevel</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">formatGLS</span> <span class="o">::</span> <span class="kt">GuestList</span> <span class="o">-&gt;</span> <span class="kt">String</span>
<span class="n">formatGLS</span> <span class="p">(</span><span class="kt">GL</span> <span class="n">es</span> <span class="n">fun</span><span class="p">)</span> <span class="o">=</span>
  <span class="n">totalStr</span> <span class="o">++</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="o">++</span> <span class="n">nameStr</span>
  <span class="kr">where</span>
    <span class="n">totalStr</span> <span class="o">=</span> <span class="s">"Total fun: "</span> <span class="o">++</span> <span class="n">show</span> <span class="n">fun</span>
    <span class="n">nameStr</span> <span class="o">=</span> <span class="n">unlines</span> <span class="o">$</span> <span class="n">sort</span> <span class="o">$</span> <span class="n">map</span> <span class="n">empName</span> <span class="n">es</span>

<span class="n">main</span> <span class="o">::</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">readFile</span> <span class="s">"company.txt"</span> <span class="o">&gt;&gt;=</span> <span class="n">putStrLn</span> <span class="o">.</span> <span class="n">formatGLS</span> <span class="o">.</span> <span class="n">maxFun</span> <span class="o">.</span> <span class="n">read</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/23/applicative-functors-part-i" rel="next" title="Applicative functors, Part I">Applicative functors, Part I</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/21/folds-and-monoids" rel="previous" title="Folds and monoids">Folds and monoids</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Folds and monoids - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Folds and monoids" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Folds and monoids</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-21 01:32:54 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p>To understand the different relations between type classes, <a href="https://wiki.haskell.org/Typeclassopedia">Type class</a> is a great reference.</p>

<p>This is a <a href="https://wiki.haskell.org/wikiupload/d/df/Typeclassopedia-diagram.png">fantastic picture</a>.</p>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="p">(</span><span class="o">+++</span><span class="p">)</span> <span class="o">::</span> <span class="kt">Monoid</span> <span class="n">m</span> <span class="o">=&gt;</span> <span class="kt">JoinList</span> <span class="n">m</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">m</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">m</span> <span class="n">a</span>
<span class="n">l1</span> <span class="o">+++</span> <span class="n">l2</span> <span class="o">=</span> <span class="kt">Append</span> <span class="p">(</span><span class="n">tag</span> <span class="n">l1</span> <span class="p">`</span><span class="n">mappend</span><span class="p">`</span> <span class="n">tag</span> <span class="n">l2</span><span class="p">)</span> <span class="n">l1</span> <span class="n">l2</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="c1">-- 1. Implement the function indexJ to find the JoinList element at</span>
<span class="c1">-- the specified index; it should satisfy the equivalence:</span>
<span class="c1">--     (indexJ i jl) == (jlToList jl !!? i)</span>

<span class="n">indexJ</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Sized</span> <span class="n">b</span><span class="p">,</span> <span class="kt">Monoid</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="n">a</span>
<span class="n">indexJ</span> <span class="kr">_</span> <span class="kt">Empty</span> <span class="o">=</span> <span class="kt">Nothing</span>
<span class="n">indexJ</span> <span class="n">i</span> <span class="kr">_</span> <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">Nothing</span>
<span class="n">indexJ</span> <span class="n">i</span> <span class="p">(</span><span class="kt">Single</span> <span class="kr">_</span> <span class="kr">_</span><span class="p">)</span> <span class="o">|</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">Nothing</span>
<span class="n">indexJ</span> <span class="kr">_</span> <span class="p">(</span><span class="kt">Single</span> <span class="kr">_</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Just</span> <span class="n">a</span>
<span class="n">indexJ</span> <span class="n">i</span> <span class="n">p</span><span class="o">@</span><span class="p">(</span><span class="kt">Append</span> <span class="kr">_</span> <span class="n">l</span> <span class="n">r</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">sz</span> <span class="n">p</span> <span class="o">=</span> <span class="kt">Nothing</span>
  <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">indexJ</span> <span class="n">i</span> <span class="n">l</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">indexJ</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lsize</span><span class="p">)</span> <span class="n">r</span>
  <span class="kr">where</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">sz</span> <span class="n">l</span>

<span class="c1">-- 2. Implement the function dropJ to drop first n elements of a</span>
<span class="c1">-- JoinList; it should satisfy the equivalence:</span>
<span class="c1">--     jlToList (dropJ n jl) = drop n (jlToList jl)</span>

<span class="n">dropJ</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Sized</span> <span class="n">b</span><span class="p">,</span> <span class="kt">Monoid</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span> <span class="o">-&gt;</span><span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span>
<span class="n">dropJ</span> <span class="kr">_</span> <span class="kt">Empty</span>        <span class="o">=</span> <span class="kt">Empty</span>
<span class="n">dropJ</span> <span class="n">n</span> <span class="n">l</span> <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">l</span>
<span class="n">dropJ</span> <span class="kr">_</span> <span class="p">(</span><span class="kt">Single</span> <span class="kr">_</span> <span class="kr">_</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Empty</span>
<span class="n">dropJ</span> <span class="n">n</span> <span class="p">(</span><span class="kt">Append</span> <span class="kr">_</span> <span class="n">l</span> <span class="n">r</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">lsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">dropJ</span> <span class="n">n</span> <span class="n">l</span><span class="p">)</span> <span class="o">+++</span> <span class="n">r</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">dropJ</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">lsize</span><span class="p">)</span> <span class="n">r</span>
  <span class="kr">where</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">sz</span> <span class="n">l</span>

<span class="c1">-- 3. Implement the function takeJ to return the first n elements of a</span>
<span class="c1">-- JoinList, dropping all other elements; it should satisfy the equivalence:</span>
<span class="c1">--     jlToList (takeJ n jl) == take n (jlToList jl)</span>

<span class="n">takeJ</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Sized</span> <span class="n">b</span><span class="p">,</span> <span class="kt">Monoid</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span> <span class="o">-&gt;</span><span class="kt">JoinList</span> <span class="n">b</span> <span class="n">a</span>
<span class="n">takeJ</span> <span class="kr">_</span> <span class="kt">Empty</span>          <span class="o">=</span> <span class="kt">Empty</span>
<span class="n">takeJ</span> <span class="n">n</span> <span class="kr">_</span>  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span>    <span class="o">=</span> <span class="kt">Empty</span>
<span class="n">takeJ</span> <span class="n">n</span> <span class="n">j</span> <span class="o">|</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="n">sz</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span>
<span class="n">takeJ</span> <span class="n">n</span> <span class="p">(</span><span class="kt">Append</span> <span class="kr">_</span> <span class="n">l</span> <span class="n">r</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">takeJ</span> <span class="n">n</span> <span class="n">l</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+++</span> <span class="n">takeJ</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">lsize</span><span class="p">)</span> <span class="n">r</span>
  <span class="kr">where</span> <span class="n">lsize</span> <span class="o">=</span> <span class="n">sz</span> <span class="n">l</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">module</span> <span class="nn">Scrabble</span> <span class="kr">where</span>

<span class="kr">import</span> <span class="nn">Data.Monoid</span>

<span class="kr">data</span> <span class="kt">Score</span> <span class="o">=</span> <span class="kt">Score</span> <span class="kt">Int</span>
             <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span> <span class="kt">Show</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Monoid</span> <span class="kt">Score</span> <span class="kr">where</span>
  <span class="n">mempty</span> <span class="o">=</span> <span class="kt">Score</span> <span class="mi">0</span>
  <span class="kt">Score</span> <span class="n">a</span> <span class="p">`</span><span class="n">mappend</span><span class="p">`</span> <span class="kt">Score</span> <span class="n">b</span> <span class="o">=</span> <span class="kt">Score</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>

<span class="n">score</span> <span class="o">::</span> <span class="kt">Char</span> <span class="o">-&gt;</span> <span class="kt">Score</span>
<span class="n">score</span> <span class="n">c</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"aeilnorstuAEILNORSTU"</span> <span class="o">=</span> <span class="kt">Score</span> <span class="mi">1</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"dgDG"</span>                 <span class="o">=</span> <span class="kt">Score</span> <span class="mi">2</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"bcmpBCMP"</span>             <span class="o">=</span> <span class="kt">Score</span> <span class="mi">3</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"fhvwyFHVWY"</span>           <span class="o">=</span> <span class="kt">Score</span> <span class="mi">4</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"kK"</span>                   <span class="o">=</span> <span class="kt">Score</span> <span class="mi">5</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"jxJX"</span>                 <span class="o">=</span> <span class="kt">Score</span> <span class="mi">8</span>
  <span class="o">|</span> <span class="n">c</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="s">"qzQZ"</span>                 <span class="o">=</span> <span class="kt">Score</span> <span class="mi">10</span>
  <span class="o">|</span> <span class="n">otherwise</span>                       <span class="o">=</span> <span class="kt">Score</span> <span class="mi">0</span>

<span class="n">scoreString</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Score</span>
<span class="n">scoreString</span> <span class="o">=</span> <span class="n">foldr</span> <span class="p">((</span><span class="o">&lt;&gt;</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="p">)</span> <span class="o">$</span> <span class="kt">Score</span> <span class="mi">0</span></code></pre></figure>

<p>Test code:</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="o">*</span><span class="kt">JoinList</span><span class="o">&gt;</span> <span class="n">scoreLine</span> <span class="s">"yay "</span> <span class="o">+++</span> <span class="n">scoreLine</span> <span class="s">"haskell!"</span>
<span class="kt">Append</span> <span class="p">(</span><span class="kt">Score</span> <span class="mi">23</span><span class="p">)</span> <span class="p">(</span><span class="kt">Single</span> <span class="p">(</span><span class="kt">Score</span> <span class="mi">9</span><span class="p">)</span> <span class="s">"yay "</span><span class="p">)</span> <span class="p">(</span><span class="kt">Single</span> <span class="p">(</span><span class="kt">Score</span> <span class="mi">14</span><span class="p">)</span> <span class="s">"haskell!"</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<p>The magical part is <code class="highlighter-rouge">(Sized b, Monoid b)</code> restriction to <code class="highlighter-rouge">Sized (a,b)</code>.</p>

<p>To make it valid, besides the auto implemented</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="p">(</span><span class="kt">Monoid</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Monoid</span> <span class="n">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Monoid</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="kr">where</span>
<span class="n">mempty</span> <span class="o">=</span> <span class="p">(</span><span class="n">mempty</span><span class="p">,</span> <span class="n">mempty</span><span class="p">)</span>
<span class="n">mappend</span> <span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">)</span> <span class="p">(</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">mappend</span> <span class="n">a1</span> <span class="n">a2</span><span class="p">,</span> <span class="n">mappend</span> <span class="n">b1</span> <span class="n">b2</span><span class="p">)</span></code></pre></figure>

<p>The functions in <code class="highlighter-rouge">Sized.hs</code> is also critical.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Sized</span> <span class="kt">Size</span> <span class="kr">where</span>
  <span class="n">size</span> <span class="o">=</span> <span class="n">id</span>

<span class="c1">-- This instance means that things like</span>
<span class="c1">--   (Foo, Size)</span>
<span class="c1">--   (Foo, (Bar, Size))</span>
<span class="c1">--   ...</span>
<span class="c1">-- are all instances of Sized.</span>
<span class="kr">instance</span> <span class="kt">Sized</span> <span class="n">b</span> <span class="o">=&gt;</span> <span class="kt">Sized</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="kr">where</span>
  <span class="n">size</span> <span class="o">=</span> <span class="n">size</span> <span class="o">.</span> <span class="n">snd</span>

<span class="kr">instance</span> <span class="kt">Monoid</span> <span class="kt">Size</span> <span class="kr">where</span>
  <span class="n">mempty</span>  <span class="o">=</span> <span class="kt">Size</span> <span class="mi">0</span>
  <span class="n">mappend</span> <span class="o">=</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span></code></pre></figure>

<p>Thanks to these functions, the previously implemented <code class="highlighter-rouge">indexJ</code>, <code class="highlighter-rouge">dropJ</code>, <code class="highlighter-rouge">takeJ</code> are still valid to the <code class="highlighter-rouge">(Score, Size)</code></p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">type</span> <span class="kt">JLBuffer</span> <span class="o">=</span> <span class="kt">JoinList</span> <span class="p">(</span><span class="kt">Score</span><span class="p">,</span> <span class="kt">Size</span><span class="p">)</span> <span class="kt">String</span>

<span class="kr">instance</span> <span class="kt">Buffer</span> <span class="kt">JLBuffer</span> <span class="kr">where</span>

  <span class="c1">-- toString :: JLBuffer -&gt; String</span>
  <span class="n">toString</span> <span class="o">=</span> <span class="n">concat</span> <span class="o">.</span> <span class="n">jlToList</span>

  <span class="c1">-- fromString :: String -&gt; JLBuffer</span>
  <span class="n">fromString</span> <span class="o">=</span> <span class="n">foldr1</span> <span class="p">(</span><span class="o">+++</span><span class="p">)</span> <span class="o">.</span> <span class="n">map</span><span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="kt">Single</span> <span class="p">(</span><span class="n">scoreString</span> <span class="n">x</span><span class="p">,</span> <span class="kt">Size</span> <span class="mi">1</span><span class="p">)</span> <span class="n">x</span><span class="p">)</span> <span class="o">.</span> <span class="n">lines</span>

  <span class="c1">-- line :: Int -&gt; JLBuffer -&gt; Maybe String</span>
  <span class="n">line</span> <span class="o">=</span> <span class="n">indexJ</span>

  <span class="c1">-- replaceLine :: Int -&gt; String -&gt; JLBuffer -&gt; JLBuffer</span>
  <span class="n">replaceLine</span> <span class="n">n</span> <span class="n">str</span> <span class="n">jlb</span> <span class="o">=</span>
    <span class="n">takeJ</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">jlb</span> <span class="o">+++</span> <span class="kt">Single</span> <span class="p">(</span><span class="n">scoreString</span> <span class="n">str</span><span class="p">,</span> <span class="kt">Size</span> <span class="mi">1</span><span class="p">)</span> <span class="n">str</span> <span class="o">+++</span> <span class="n">dropJ</span> <span class="n">n</span> <span class="n">jlb</span>

  <span class="c1">-- numLines :: JLBuffer -&gt; Int</span>
  <span class="n">numLines</span> <span class="o">=</span> <span class="n">sz</span>

  <span class="c1">-- value :: JLBuffer -&gt; Int</span>
  <span class="n">value</span> <span class="o">=</span> <span class="n">scorev</span> <span class="o">.</span> <span class="n">fst</span> <span class="o">.</span> <span class="n">tag</span>
          <span class="kr">where</span> <span class="n">scorev</span> <span class="p">(</span><span class="kt">Score</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>

<span class="c1">-- JLBuffer based editor</span>

<span class="n">main</span> <span class="o">::</span> <span class="kt">IO</span><span class="nb">()</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">runEditor</span> <span class="n">editor</span> <span class="n">jlb</span>
  <span class="kr">where</span> <span class="n">jlb</span> <span class="o">=</span> <span class="n">fromString</span> <span class="o">$</span> <span class="n">unlines</span>
         <span class="p">[</span> <span class="s">"This buffer is for notes you don't want to save, and for"</span>
         <span class="p">,</span> <span class="s">"evaluation of steam valve coefficients."</span>
         <span class="p">,</span> <span class="s">"To load a different file, type the character L followed"</span>
         <span class="p">,</span> <span class="s">"by the name of the file."</span>
         <span class="p">]</span> <span class="o">::</span> <span class="kt">JLBuffer</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/22/io" rel="next" title="IO">IO</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/18/lazy-evaluation" rel="previous" title="Lazy evaluation">Lazy evaluation</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Lazy evaluation - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Lazy evaluation" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Lazy evaluation</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-18 20:18:10 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<p><code class="highlighter-rouge">Lazy evaluation</code> is beautiful because it makes infinite data structures possible.
But it makes reasoning about the programme harder, especially when mixed with <code class="highlighter-rouge">side effects</code>.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">import</span> <span class="nn">Data.Array</span>

<span class="n">knapsack01</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Double</span><span class="p">]</span>   <span class="c1">-- values </span>
           <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>  <span class="c1">-- nonnegative weights</span>
           <span class="o">-&gt;</span> <span class="kt">Integer</span>    <span class="c1">-- knapsack size</span>
           <span class="o">-&gt;</span> <span class="kt">Double</span>     <span class="c1">-- max possible value</span>
<span class="n">knapsack01</span> <span class="n">vs</span> <span class="n">ws</span> <span class="n">maxW</span> <span class="o">=</span> <span class="n">m</span><span class="o">!</span><span class="p">(</span><span class="n">numItems</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxW</span><span class="p">)</span>
  <span class="kr">where</span> <span class="n">numItems</span> <span class="o">=</span> <span class="n">length</span> <span class="n">vs</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">array</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">numItems</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxW</span><span class="p">))</span> <span class="o">$</span>
              <span class="p">[((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">w</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">w</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">0</span> <span class="o">..</span> <span class="n">maxW</span><span class="p">]]</span> <span class="o">++</span>
              <span class="p">[((</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">0</span> <span class="o">..</span> <span class="n">numItems</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">++</span>
              <span class="p">[((</span><span class="n">i</span><span class="p">,</span><span class="n">w</span><span class="p">),</span> <span class="n">best</span><span class="p">)</span> 
                  <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">0</span> <span class="o">..</span> <span class="n">numItems</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                  <span class="p">,</span> <span class="n">w</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">1</span> <span class="o">..</span> <span class="n">maxW</span><span class="p">]</span>
                  <span class="p">,</span> <span class="kr">let</span> <span class="n">best</span>
                          <span class="o">|</span> <span class="n">ws</span><span class="o">!!</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">w</span>  <span class="o">=</span> <span class="n">m</span><span class="o">!</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
                          <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">max</span> <span class="p">(</span><span class="n">m</span><span class="o">!</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span> 
                                            <span class="p">(</span><span class="n">m</span><span class="o">!</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">-</span> <span class="n">ws</span><span class="o">!!</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">vs</span><span class="o">!!</span><span class="n">i</span><span class="p">)</span>
              <span class="p">]</span>

<span class="n">example</span> <span class="o">=</span> <span class="n">knapsack01</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="mi">20</span></code></pre></figure>

<p>The functional dynamic programming implementation is kind of tricky in my view.</p>

<p>Monolithic <a href="https://www.haskell.org/tutorial/arrays.html">Arrays</a> is used to memorized the overlapped subprobramme.</p>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">fib</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">fib</span> <span class="n">n</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">fibs1</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">fibs1</span> <span class="o">=</span> <span class="n">map</span> <span class="n">fib</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="p">]</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">fibs2</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">fibs2</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">zipWith</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="n">fibs2</span> <span class="p">(</span><span class="n">tail</span> <span class="n">fibs2</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<p><code class="highlighter-rouge">cons</code> is mentioned in the lecture, but use record syntax makes it
much more cleaner.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">data</span> <span class="kt">Stream</span> <span class="n">a</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="p">{</span> <span class="n">streamToList</span> <span class="o">::</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="p">}</span>

<span class="kr">instance</span> <span class="p">(</span><span class="kt">Show</span> <span class="n">a</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Show</span> <span class="p">(</span><span class="kt">Stream</span> <span class="n">a</span><span class="p">)</span> <span class="kr">where</span>
  <span class="n">show</span> <span class="o">=</span>  <span class="n">show</span> <span class="o">.</span> <span class="n">take</span> <span class="mi">20</span> <span class="o">.</span> <span class="n">streamToList</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">streamRepeat</span> <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span>
<span class="n">streamRepeat</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="o">.</span> <span class="n">repeat</span>

<span class="n">streamMap</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">b</span>
<span class="n">streamMap</span> <span class="n">f</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="o">.</span> <span class="n">map</span> <span class="n">f</span> <span class="o">.</span> <span class="n">streamToList</span>

<span class="n">streamFromSeed</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span>
<span class="n">streamFromSeed</span> <span class="n">f</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="o">.</span> <span class="n">iterate</span> <span class="n">f</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<p><a href="http://codereview.stackexchange.com/questions/66700/implementing-function-that-maps-over-stream">Explanation</a></p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">nats</span> <span class="o">::</span> <span class="kt">Stream</span> <span class="kt">Integer</span>
<span class="n">nats</span> <span class="o">=</span> <span class="kt">Stream</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="p">]</span>

<span class="n">interleaveStreams</span> <span class="o">::</span> <span class="kt">Stream</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">Stream</span> <span class="n">a</span>
<span class="n">interleaveStreams</span> <span class="p">(</span><span class="kt">Stream</span> <span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="n">xs</span><span class="p">))</span> <span class="n">s</span> <span class="o">=</span>
  <span class="kt">Stream</span> <span class="o">$</span> <span class="n">x</span> <span class="o">:</span> <span class="n">streamToList</span> <span class="p">(</span><span class="n">interleaveStreams</span> <span class="n">s</span> <span class="p">(</span><span class="kt">Stream</span> <span class="n">xs</span><span class="p">))</span>


<span class="n">ruler</span> <span class="o">::</span> <span class="kt">Stream</span> <span class="kt">Integer</span>
<span class="n">ruler</span> <span class="o">=</span> <span class="n">foldr1</span> <span class="n">interleaveStreams</span> <span class="p">(</span><span class="n">map</span> <span class="n">streamRepeat</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="p">])</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/21/folds-and-monoids" rel="next" title="Folds and monoids">Folds and monoids</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/18/more-polymorphism-and-type-classes" rel="previous" title="More polymorphism and type classes">More polymorphism and type classes</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>More polymorphism and type classes - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="More polymorphism and type classes" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>More polymorphism and type classes</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-18 01:01:33 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">f</span> <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span>
<span class="n">f</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">y</span></code></pre></figure>

<blockquote>
  <p>The reason this doesn’t work is that the caller of a polymorphic function gets to choose the type. Here we, the implementors, have tried to choose a specific type</p>
</blockquote>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span></code></pre></figure>

<blockquote>
  <p>could be understood as a promise that a function with this type will work no matter what type the caller chooses</p>
</blockquote>

<h5 id="type-classes">Type classes</h5>
<blockquote>
  <p>Intuitively, type classes correspond to sets of types which have certain operations defined for them, and type class polymorphic functions work only for types which are instances of the type class(es) in question</p>
</blockquote>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">eval</span> <span class="o">::</span> <span class="kt">ExprT</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">eval</span> <span class="p">(</span><span class="kt">Lit</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>
<span class="n">eval</span> <span class="p">(</span><span class="kt">Add</span> <span class="n">e1</span> <span class="n">e2</span><span class="p">)</span> <span class="o">=</span> <span class="n">eval</span> <span class="n">e1</span> <span class="o">+</span> <span class="n">eval</span> <span class="n">e2</span>
<span class="n">eval</span> <span class="p">(</span><span class="kt">Mul</span> <span class="n">e1</span> <span class="n">e2</span><span class="p">)</span> <span class="o">=</span> <span class="n">eval</span> <span class="n">e1</span> <span class="o">*</span> <span class="n">eval</span> <span class="n">e2</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">evalStr</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span>
<span class="n">evalStr</span> <span class="o">=</span> <span class="n">fmap</span> <span class="n">eval</span> <span class="o">.</span> <span class="n">parseExp</span> <span class="kt">Lit</span> <span class="kt">Add</span> <span class="kt">Mul</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<p>Defination for <code class="highlighter-rouge">Expr</code></p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">module</span> <span class="nn">Expr</span> <span class="kr">where</span>

<span class="kr">class</span> <span class="kt">Expr</span> <span class="n">a</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="n">a</span>
  <span class="n">add</span> <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span>
  <span class="n">mul</span> <span class="o">::</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">ExprT</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">=</span> <span class="kt">Lit</span>
  <span class="n">add</span> <span class="o">=</span> <span class="kt">Add</span>
  <span class="n">mul</span> <span class="o">=</span> <span class="kt">Mul</span>

<span class="n">reify</span> <span class="o">::</span> <span class="kt">ExprT</span> <span class="o">-&gt;</span> <span class="kt">ExprT</span>
<span class="n">reify</span> <span class="o">=</span> <span class="n">id</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">Integer</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">=</span> <span class="n">id</span>
  <span class="n">add</span> <span class="o">=</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span>
  <span class="n">mul</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">Bool</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="n">i</span>
    <span class="o">|</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">False</span>
    <span class="o">|</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="o">=</span> <span class="kt">True</span>
  <span class="n">add</span> <span class="o">=</span> <span class="p">(</span><span class="o">||</span><span class="p">)</span>
  <span class="n">mul</span> <span class="o">=</span> <span class="p">(</span><span class="o">&amp;&amp;</span><span class="p">)</span>

<span class="kr">newtype</span> <span class="kt">MinMax</span> <span class="o">=</span> <span class="kt">MinMax</span> <span class="kt">Integer</span>
                 <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span> <span class="kt">Show</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">MinMax</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">=</span> <span class="kt">MinMax</span>
  <span class="n">add</span> <span class="p">(</span><span class="kt">MinMax</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="kt">MinMax</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="kt">MinMax</span> <span class="p">(</span><span class="n">max</span> <span class="n">x</span> <span class="n">y</span><span class="p">)</span>
  <span class="n">mul</span> <span class="p">(</span><span class="kt">MinMax</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="kt">MinMax</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="kt">MinMax</span> <span class="p">(</span><span class="n">min</span> <span class="n">x</span> <span class="n">y</span><span class="p">)</span>

<span class="kr">newtype</span> <span class="kt">Mod7</span> <span class="o">=</span> <span class="kt">Mod7</span> <span class="kt">Integer</span>
                 <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span> <span class="kt">Show</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">Mod7</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="n">x</span> <span class="o">=</span> <span class="kt">Mod7</span> <span class="p">(</span><span class="n">x</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">7</span><span class="p">)</span>
  <span class="n">add</span> <span class="p">(</span><span class="kt">Mod7</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="kt">Mod7</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Mod7</span> <span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">7</span><span class="p">)</span>
  <span class="n">mul</span> <span class="p">(</span><span class="kt">Mod7</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="kt">Mod7</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Mod7</span> <span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">7</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">Program</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="kt">PushI</span> <span class="n">x</span><span class="p">]</span>
  <span class="n">add</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">++</span> <span class="n">y</span> <span class="o">++</span> <span class="p">[</span><span class="kt">Add</span><span class="p">]</span>
  <span class="n">mul</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">++</span> <span class="n">y</span> <span class="o">++</span> <span class="p">[</span><span class="kt">Mul</span><span class="p">]</span></code></pre></figure>

<h5 id="exercise-6">Exercise 6</h5>

<p>There are two tricky parts from my view:</p>

<ol>
  <li>
    <p>Same expression can belong to multiple types,
both <code class="highlighter-rouge">add (lit 3) (var "x") :: (M.Map String Integer -&gt; Maybe Integer)</code> and <code class="highlighter-rouge">add (lit 3) (var "x") :: VarExprT</code> are valid</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">add e1 e2 m</code> has the type of <code class="highlighter-rouge">(M.Map String Integer -&gt; Maybe Integer) -&gt; (M.Map String Integer -&gt; Maybe Integer) -&gt; (M.Map String Integer -&gt; Maybe Integer)</code></p>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">data</span> <span class="kt">VarExprT</span> <span class="o">=</span> <span class="kt">Lit</span> <span class="kt">Integer</span>
              <span class="o">|</span> <span class="kt">Add</span> <span class="kt">VarExprT</span> <span class="kt">VarExprT</span>
              <span class="o">|</span> <span class="kt">Mul</span> <span class="kt">VarExprT</span> <span class="kt">VarExprT</span>
              <span class="o">|</span> <span class="kt">Var</span> <span class="kt">String</span>
                <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span> <span class="kt">Show</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="kt">VarExprT</span> <span class="kr">where</span>
  <span class="n">lit</span> <span class="o">=</span> <span class="kt">Lit</span>
  <span class="n">add</span> <span class="o">=</span> <span class="kt">Add</span>
  <span class="n">mul</span> <span class="o">=</span> <span class="kt">Mul</span>

<span class="kr">class</span> <span class="kt">HasVars</span> <span class="n">a</span> <span class="kr">where</span>
  <span class="n">var</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="n">a</span>

<span class="kr">instance</span> <span class="kt">HasVars</span> <span class="kt">VarExprT</span> <span class="kr">where</span>
  <span class="n">var</span> <span class="o">=</span> <span class="kt">Var</span>

<span class="kr">instance</span> <span class="kt">HasVars</span> <span class="p">(</span><span class="kt">M</span><span class="o">.</span><span class="kt">Map</span> <span class="kt">String</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span><span class="p">)</span> <span class="kr">where</span>
  <span class="n">var</span> <span class="o">=</span> <span class="kt">M</span><span class="o">.</span><span class="n">lookup</span>

<span class="kr">instance</span> <span class="kt">Expr</span> <span class="p">(</span><span class="kt">M</span><span class="o">.</span><span class="kt">Map</span> <span class="kt">String</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span><span class="p">)</span> <span class="kr">where</span>
    <span class="n">lit</span> <span class="o">=</span>  <span class="n">const</span> <span class="o">.</span> <span class="kt">Just</span>
    <span class="n">add</span> <span class="n">e1</span> <span class="n">e2</span> <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">&lt;$&gt;</span> <span class="n">e1</span> <span class="n">m</span> <span class="o">&lt;*&gt;</span> <span class="n">e2</span> <span class="n">m</span>
    <span class="n">mul</span> <span class="n">e1</span> <span class="n">e2</span> <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&lt;$&gt;</span> <span class="n">e1</span> <span class="n">m</span> <span class="o">&lt;*&gt;</span> <span class="n">e2</span> <span class="n">m</span>

<span class="n">withVars</span> <span class="o">::</span> <span class="p">[(</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">)]</span>
         <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">M</span><span class="o">.</span><span class="kt">Map</span> <span class="kt">String</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span><span class="p">)</span>
         <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Integer</span>
<span class="n">withVars</span> <span class="n">vs</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">exp</span> <span class="o">$</span> <span class="kt">M</span><span class="o">.</span><span class="n">fromList</span> <span class="n">vs</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/18/lazy-evaluation" rel="next" title="Lazy evaluation">Lazy evaluation</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/17/higher-order-programming-and-type-inference" rel="previous" title="Higher-order programming and type inference">Higher-order programming and type inference</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Higher-order programming and type inference - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Higher-order programming and type inference" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Higher-order programming and type inference</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-17 19:46:29 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-contents">Lecture Contents</h4>
<blockquote>
  <p>There is an art to deciding the order of arguments to a function to make partial applications of it as useful as possible: the arguments should be ordered from from “least to greatest variation”, that is, arguments which will often be the same should be listed first, and arguments which will often be different should come last.</p>
</blockquote>

<p>The only reason why this ordering makes sense is the last one could be made point free when it is in need.</p>

<p>One thing confuses me a lot is the difference between <code class="highlighter-rouge">$</code> and <code class="highlighter-rouge">.</code> when doing the function composition.</p>

<p><a href="http://stackoverflow.com/questions/940382/haskell-difference-between-dot-and-dollar-sign">stackoverflow</a> gives a great answer. To summarize,</p>

<ul>
  <li><code class="highlighter-rouge">$</code> operator is for avoiding parenthesis.Anything appearing after it will take precedence over anything that comes before.</li>
  <li><code class="highlighter-rouge">.</code> operator is for chaining functions. It works like the pipeline, the output on the right goes to the input of the left.</li>
</ul>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">putStrLn</span> <span class="p">(</span><span class="n">show</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="n">putStrLn</span> <span class="o">$</span> <span class="n">show</span> <span class="o">$</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">putStrLn</span> <span class="o">.</span> <span class="n">show</span> <span class="o">$</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span></code></pre></figure>

<h4 id="exercise">Exercise</h4>

<h5 id="exercise-1-wholemeal-programming">Exercise 1 Wholemeal programming</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">fun1</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">fun1</span> <span class="o">=</span> <span class="n">foldr</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="kr">if</span> <span class="n">even</span> <span class="n">x</span> <span class="kr">then</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span> <span class="kr">else</span> <span class="n">y</span><span class="p">)</span> <span class="mi">1</span>

<span class="n">fun2</span><span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">fun2</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">.</span> <span class="n">filter</span> <span class="n">even</span> <span class="o">.</span> <span class="n">takeWhile</span> <span class="p">(</span><span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="n">iterate</span> <span class="p">(</span><span class="nf">\</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="kr">if</span> <span class="n">even</span> <span class="n">n</span> <span class="kr">then</span> <span class="n">n</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">2</span> <span class="kr">else</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></code></pre></figure>

<h5 id="exercise-2-folding-with-trees">Exercise 2 Folding with trees</h5>

<p>Always try to insert into the left subtree while keep it is balanced.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">data</span> <span class="kt">Tree</span> <span class="n">a</span> <span class="o">=</span> <span class="kt">Leaf</span> <span class="o">|</span> <span class="kt">Node</span> <span class="kt">Integer</span> <span class="p">(</span><span class="kt">Tree</span> <span class="n">a</span><span class="p">)</span> <span class="n">a</span> <span class="p">(</span><span class="kt">Tree</span> <span class="n">a</span><span class="p">)</span>
            <span class="kr">deriving</span> <span class="kt">Show</span>

<span class="n">foldTree</span> <span class="o">::</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">Tree</span> <span class="n">a</span>
<span class="n">foldTree</span> <span class="n">xs</span> <span class="o">=</span> <span class="n">foldr</span> <span class="n">insert</span> <span class="kt">Leaf</span> <span class="n">xs</span>
    <span class="kr">where</span>
        <span class="n">height</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">height</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">h</span> <span class="kr">_</span> <span class="kr">_</span> <span class="kr">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">h</span>
        <span class="n">count</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count</span> <span class="p">(</span><span class="kt">Node</span> <span class="kr">_</span> <span class="n">l</span> <span class="kr">_</span> <span class="n">r</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">count</span> <span class="n">l</span> <span class="o">+</span> <span class="n">count</span> <span class="n">r</span>
        <span class="n">insert</span> <span class="n">x</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="kt">Node</span> <span class="mi">0</span> <span class="kt">Leaf</span> <span class="n">x</span> <span class="kt">Leaf</span>
        <span class="n">insert</span> <span class="n">x</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">h</span> <span class="n">l</span> <span class="n">d</span> <span class="n">r</span><span class="p">)</span>
            <span class="o">|</span> <span class="n">height</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">height</span> <span class="n">r</span> <span class="o">=</span> <span class="kt">Node</span> <span class="n">h</span> <span class="n">l</span> <span class="n">d</span> <span class="o">$</span> <span class="n">insert</span> <span class="n">x</span> <span class="n">r</span>
            <span class="o">|</span> <span class="n">count</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">count</span> <span class="n">r</span>   <span class="o">=</span> <span class="kt">Node</span> <span class="n">h</span> <span class="n">l</span> <span class="n">d</span> <span class="p">(</span><span class="n">insert</span> <span class="n">x</span> <span class="n">r</span><span class="p">)</span>
            <span class="o">|</span> <span class="n">otherwise</span>           <span class="o">=</span> <span class="kr">let</span> <span class="n">newl</span> <span class="o">=</span> <span class="n">insert</span> <span class="n">x</span> <span class="n">l</span>
                                        <span class="n">newHeight</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">height</span> <span class="n">newl</span><span class="p">))</span>
                                        <span class="kr">in</span> <span class="kt">Node</span> <span class="n">newHeight</span> <span class="n">newl</span> <span class="n">d</span> <span class="n">r</span></code></pre></figure>

<h5 id="exercise-3-more-folds">Exercise 3 More folds</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">xor</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Bool</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
<span class="n">xor</span> <span class="o">=</span> <span class="n">foldr</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="n">accum</span> <span class="o">-&gt;</span> <span class="kr">if</span> <span class="n">x</span> <span class="kr">then</span> <span class="n">not</span> <span class="n">accum</span> <span class="kr">else</span> <span class="n">accum</span><span class="p">)</span> <span class="kt">False</span>

<span class="n">map'</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">b</span><span class="p">]</span>
<span class="n">map'</span> <span class="n">f</span> <span class="o">=</span> <span class="n">foldr</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="n">accum</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:</span> <span class="n">accum</span><span class="p">)</span> <span class="kt">[]</span></code></pre></figure>

<h5 id="exercise-4-finding-primes">Exercise 4 Finding primes</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">sSundDelete</span> <span class="o">::</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Int</span><span class="p">]</span>
<span class="n">sSundDelete</span> <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="o">|</span><span class="n">i</span><span class="o">&lt;-</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">],</span> <span class="n">j</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">i</span><span class="o">..</span><span class="n">n</span><span class="p">]]</span>

<span class="n">sieveSundaram</span> <span class="o">::</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Int</span><span class="p">]</span>
<span class="n">sieveSundaram</span> <span class="n">n</span> <span class="o">=</span> <span class="kr">let</span> <span class="n">del</span> <span class="o">=</span> <span class="n">sSundDelete</span> <span class="n">n</span> <span class="kr">in</span>
     <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span> <span class="o">|</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">],</span> <span class="n">not</span> <span class="p">(</span><span class="n">x</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="n">del</span><span class="p">)]</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/18/more-polymorphism-and-type-classes" rel="next" title="More polymorphism and type classes">More polymorphism and type classes</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/17/recursion-patterns-polymorphism-and-the-prelude" rel="previous" title="Recursion patterns, polymorphism, and the Prelude">Recursion patterns, polymorphism, and the Prelude</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Recursion patterns, polymorphism, and the Prelude - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Recursion patterns, polymorphism, and the Prelude" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Recursion patterns, polymorphism, and the Prelude</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-17 01:13:17 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-content">Lecture Content</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>In fact, experienced Haskell programmers hardly ever write recursive functions!
</code></pre></div></div>

<p>This is quite unbelieable for me at first glance. Even though <code class="highlighter-rouge">recursive function</code> is not
the best practice in languages which does not provide <a href="http://stackoverflow.com/questions/310974/what-is-tail-call-optimization">tail call optimization</a>.</p>

<p><code class="highlighter-rouge">Recursive function</code> provide more abstract way than <code class="highlighter-rouge">iterative function</code>, while there exists
more abstract way than <code class="highlighter-rouge">Recursive function</code>, which leave the low-level details of actually doing recursion
to these functions.</p>

<h5 id="infix-function">Infix Function</h5>

<p>Backticks can turn any standard function with two argumetns in an infix operator which is called <a href="http://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-300003.5">section syntax</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(op e)  =   \ x -&gt; x op e
(e op)  =   \ x -&gt; e op x
</code></pre></div></div>

<p>For example,</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">elem</span> <span class="mi">2</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span> <span class="p">`</span><span class="n">elem</span><span class="p">`)</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">((`</span><span class="n">elem</span><span class="p">`</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="mi">2</span><span class="p">)</span></code></pre></figure>

<h4 id="exercise-1-hopscotch">Exercise 1 Hopscotch</h4>

<p><code class="highlighter-rouge">zip</code> or <code class="highlighter-rouge">zipwith</code> are convenient to do filter in list.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">skips</span> <span class="o">::</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[[</span><span class="n">a</span><span class="p">]]</span>
<span class="n">skips</span> <span class="n">xs</span> <span class="o">=</span>
        <span class="kr">let</span> <span class="n">ns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">length</span> <span class="n">xs</span><span class="p">]</span>
            <span class="n">extractEvery</span> <span class="n">m</span> <span class="o">=</span> <span class="n">map</span> <span class="n">snd</span> <span class="o">.</span> <span class="n">filter</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">fst</span> <span class="n">x</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">.</span> <span class="n">zip</span> <span class="n">ns</span>
            <span class="kr">in</span> <span class="n">map</span> <span class="p">(`</span><span class="n">extractEvery</span><span class="p">`</span> <span class="n">xs</span><span class="p">)</span> <span class="n">ns</span></code></pre></figure>

<h4 id="exercise-2-local-maxima">Exercise 2 Local maxima</h4>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">localMaxima</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">localMaxima</span> <span class="p">(</span><span class="n">a</span><span class="o">:</span><span class="n">b</span><span class="o">:</span><span class="n">c</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">b</span><span class="o">:</span> <span class="n">p</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">p</span>
    <span class="kr">where</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">localMaxima</span><span class="p">(</span><span class="n">b</span><span class="o">:</span><span class="n">c</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span>
<span class="n">localMaxima</span> <span class="kr">_</span> <span class="o">=</span> <span class="kt">[]</span></code></pre></figure>

<h4 id="exercise-3-histogram">Exercise 3 Histogram</h4>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">histogram</span><span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">String</span>
<span class="n">histogram</span> <span class="n">xs</span> <span class="o">=</span>
        <span class="kr">let</span> <span class="n">count</span> <span class="o">=</span> <span class="n">map</span> <span class="p">(</span><span class="nf">\</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">length</span> <span class="o">$</span> <span class="n">filter</span> <span class="p">(</span><span class="o">==</span> <span class="n">n</span><span class="p">)</span> <span class="n">xs</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">]</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="n">maximum</span> <span class="n">count</span>
            <span class="n">histo</span> <span class="n">m</span> <span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">=</span> <span class="n">show</span> <span class="n">base</span> <span class="o">++</span> <span class="s">"="</span> <span class="o">++</span>
                <span class="n">replicate</span> <span class="n">c</span> <span class="sc">'*'</span> <span class="o">++</span>
                <span class="n">replicate</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="sc">' '</span>
        <span class="kr">in</span>
           <span class="n">unlines</span> <span class="o">.</span> <span class="n">reverse</span> <span class="o">.</span> <span class="n">transpose</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="n">histo</span> <span class="n">maxi</span><span class="p">)</span> <span class="o">$</span> <span class="n">zip</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">]</span> <span class="n">count</span></code></pre></figure>

<p>Test code,</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="o">*</span><span class="kt">Golf</span><span class="o">&gt;</span> <span class="n">putStr</span> <span class="o">$</span> <span class="n">histogram</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
 <span class="o">*</span>        
 <span class="o">*</span>        
 <span class="o">*</span>   <span class="o">*</span>    
<span class="o">==========</span>
<span class="mi">0123456789</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/17/higher-order-programming-and-type-inference" rel="next" title="Higher-order programming and type inference">Higher-order programming and type inference</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/16/algebraic-data-types" rel="previous" title="Algebraic Data Types">Algebraic Data Types</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Algebraic Data Types - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Algebraic Data Types" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Algebraic Data Types</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-16 23:42:59 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-content">Lecture Content</h4>

<h5 id="algebraic-data-types-in-general">Algebraic data types in general</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">data</span> <span class="kt">AlgDataType</span> <span class="o">=</span> <span class="kt">Constr1</span> <span class="kt">Type11</span> <span class="kt">Type12</span>
                 <span class="o">|</span> <span class="kt">Constr2</span> <span class="kt">Type21</span>
                 <span class="o">|</span> <span class="kt">Constr3</span> <span class="kt">Type31</span> <span class="kt">Type32</span> <span class="kt">Type33</span>
                 <span class="o">|</span> <span class="kt">Constr4</span></code></pre></figure>

<p>This is the general <code class="highlighter-rouge">Algebraic data types</code> definition.</p>

<p>One important note:</p>

<ul>
  <li>type and data constructor names must always start with a capital letter</li>
  <li>variables(including names of functions) must always start with a lowercase letter</li>
</ul>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">parseMessage</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">LogMessage</span>
<span class="n">parseMessage</span> <span class="n">s</span> <span class="o">=</span> <span class="kr">case</span> <span class="n">words</span> <span class="n">s</span> <span class="kr">of</span>
  <span class="p">(</span><span class="s">"I"</span><span class="o">:</span><span class="n">t</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">LogMessage</span> <span class="kt">Info</span> <span class="p">(</span><span class="n">read</span> <span class="n">t</span><span class="p">)</span> <span class="p">(</span><span class="n">unwords</span> <span class="n">xs</span><span class="p">)</span>
  <span class="p">(</span><span class="s">"W"</span><span class="o">:</span><span class="n">t</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">LogMessage</span> <span class="kt">Warning</span> <span class="p">(</span><span class="n">read</span> <span class="n">t</span><span class="p">)</span> <span class="p">(</span><span class="n">unwords</span> <span class="n">xs</span><span class="p">)</span>
  <span class="p">(</span><span class="s">"E"</span><span class="o">:</span><span class="n">c</span><span class="o">:</span><span class="n">t</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">LogMessage</span> <span class="p">(</span><span class="kt">Error</span> <span class="o">$</span> <span class="n">read</span> <span class="n">c</span><span class="p">)</span> <span class="p">(</span><span class="n">read</span> <span class="n">t</span><span class="p">)</span> <span class="p">(</span><span class="n">unwords</span> <span class="n">xs</span><span class="p">)</span>
  <span class="kr">_</span> <span class="o">-&gt;</span> <span class="kt">Unknown</span> <span class="n">s</span>

<span class="n">parse</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">LogMessage</span><span class="p">]</span>
<span class="n">parse</span> <span class="o">=</span> <span class="n">map</span> <span class="n">parseMessage</span> <span class="o">.</span> <span class="n">lines</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">insert</span> <span class="o">::</span> <span class="kt">LogMessage</span> <span class="o">-&gt;</span> <span class="kt">MessageTree</span> <span class="o">-&gt;</span> <span class="kt">MessageTree</span>
<span class="n">insert</span> <span class="p">(</span><span class="kt">Unknown</span> <span class="kr">_</span><span class="p">)</span> <span class="n">m</span> <span class="o">=</span> <span class="n">m</span>
<span class="n">insert</span> <span class="n">m</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="kt">Node</span> <span class="kt">Leaf</span> <span class="n">m</span> <span class="kt">Leaf</span>
<span class="n">insert</span> <span class="n">m</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">l</span> <span class="n">lg</span> <span class="n">r</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">mT</span> <span class="o">&lt;</span> <span class="n">logT</span> <span class="o">=</span> <span class="kt">Node</span> <span class="p">(</span><span class="n">insert</span> <span class="n">m</span> <span class="n">l</span><span class="p">)</span> <span class="n">lg</span> <span class="n">r</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="kt">Node</span> <span class="n">l</span> <span class="n">lg</span> <span class="p">(</span><span class="n">insert</span> <span class="n">m</span> <span class="n">r</span><span class="p">)</span>
  <span class="kr">where</span>
    <span class="n">getTimeStamp</span> <span class="n">x</span> <span class="o">=</span> <span class="kr">case</span> <span class="n">x</span> <span class="kr">of</span> <span class="p">(</span><span class="kt">LogMessage</span> <span class="kr">_</span> <span class="n">t</span> <span class="kr">_</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">t</span>
                               <span class="kr">_</span> <span class="o">-&gt;</span> <span class="mi">0</span>
    <span class="n">mT</span> <span class="o">=</span> <span class="n">getTimeStamp</span> <span class="n">m</span>
    <span class="n">logT</span> <span class="o">=</span> <span class="n">getTimeStamp</span> <span class="n">lg</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">build</span> <span class="o">::</span> <span class="p">[</span><span class="kt">LogMessage</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">MessageTree</span>
<span class="n">build</span> <span class="o">=</span> <span class="n">foldr</span> <span class="n">insert</span> <span class="kt">Leaf</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">inOrder</span> <span class="o">::</span> <span class="kt">MessageTree</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">LogMessage</span><span class="p">]</span>
<span class="n">inOrder</span> <span class="kt">Leaf</span> <span class="o">=</span> <span class="kt">[]</span>
<span class="n">inOrder</span> <span class="p">(</span><span class="kt">Node</span> <span class="n">l</span> <span class="n">lg</span> <span class="n">r</span><span class="p">)</span> <span class="o">=</span> <span class="n">inOrder</span> <span class="n">l</span> <span class="o">++</span> <span class="p">[</span><span class="n">lg</span><span class="p">]</span> <span class="o">++</span> <span class="n">inOrder</span> <span class="n">r</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">whatWentWrong</span> <span class="o">::</span> <span class="p">[</span><span class="kt">LogMessage</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="n">whatWentWrong</span> <span class="o">=</span> <span class="n">map</span> <span class="n">getMsg</span> <span class="o">.</span> <span class="n">filter</span> <span class="n">seri</span> <span class="o">.</span> <span class="n">inOrder</span> <span class="o">.</span> <span class="n">build</span>
  <span class="kr">where</span> <span class="n">seri</span> <span class="p">(</span><span class="kt">LogMessage</span> <span class="p">(</span><span class="kt">Error</span> <span class="n">e</span><span class="p">)</span> <span class="kr">_</span> <span class="kr">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mi">50</span>
        <span class="n">seri</span> <span class="kr">_</span> <span class="o">=</span> <span class="kt">False</span>
        <span class="n">getMsg</span> <span class="p">(</span><span class="kt">LogMessage</span> <span class="kr">_</span> <span class="kr">_</span> <span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span></code></pre></figure>

<p>Test code:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*LogAnalysis&gt; testWhatWentWrong parse whatWentWrong "sample.log" 
["Way too many pickles","Bad pickle-flange interaction detected","Flange failed!"]
</code></pre></div></div>

	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/17/recursion-patterns-polymorphism-and-the-prelude" rel="next" title="Recursion patterns, polymorphism, and the Prelude">Recursion patterns, polymorphism, and the Prelude</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/15/introduction" rel="previous" title="Introduction to Haskell">Introduction to Haskell</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Introduction to Haskell - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Introduction part of CIS194" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Introduction to Haskell</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-15 22:16:12 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
			<a href="/tags/CIS194">CIS194</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="lecture-content">Lecture Content</h4>

<p>Among all of them, <code class="highlighter-rouge">Pure</code> is the most tricky part. In the current computer system model,
<code class="highlighter-rouge">side effects</code> are inevitable. Haskell uses <code class="highlighter-rouge">Modad</code> and treats the outside world as static
to implement <code class="highlighter-rouge">Pure</code>.</p>

<h4 id="home-work">Home Work</h4>

<h5 id="exercise-1">Exercise 1</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">toDigits</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">toDigits</span> <span class="n">n</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">[]</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">toDigits</span> <span class="p">(</span><span class="n">n</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">10</span><span class="p">)</span> <span class="o">++</span> <span class="p">[</span><span class="n">n</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">toDigitsRev</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">toDigitsRev</span> <span class="o">=</span> <span class="n">reverse</span> <span class="o">.</span> <span class="n">toDigits</span></code></pre></figure>

<p>Test part,</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">ex1Tests</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Test</span><span class="p">]</span>
<span class="n">ex1Tests</span> <span class="o">=</span> <span class="p">[</span> <span class="n">testF1</span> <span class="s">"toDigits test"</span> <span class="n">toDigits</span>
             <span class="p">[(</span><span class="mi">1234</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kt">[]</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="kt">[]</span><span class="p">)]</span>
           <span class="p">]</span></code></pre></figure>

<h5 id="exercise-2">Exercise 2</h5>

<p>The key lies in generating infinite lists of <code class="highlighter-rouge">[1, 2, 1, 2, ...]</code>
There are several ways to generate infinite lists.</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">numbers1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">map</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="n">numbers1</span>
<span class="n">numbers2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">:</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span> <span class="o">|</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="n">numbers2</span><span class="p">]</span>
<span class="n">numbers3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">]</span></code></pre></figure>

<p>The way to get infinite interchange of <code class="highlighter-rouge">1 2</code> lists is</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell">  <span class="n">oneTwo</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">2</span> <span class="o">:</span> <span class="n">oneTwo</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">doubleEveryOther</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="n">doubleEveryOther</span> <span class="o">=</span> <span class="n">reverse</span> <span class="o">.</span> <span class="n">zipWith</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">oneTwo</span> <span class="o">.</span> <span class="n">reverse</span> <span class="kr">where</span>
  <span class="n">oneTwo</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">2</span> <span class="o">:</span> <span class="n">oneTwo</span></code></pre></figure>

<p>Test code</p>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">ex2Tests</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Test</span><span class="p">]</span>
<span class="n">ex2Tests</span> <span class="o">=</span> <span class="p">[</span><span class="n">testF1</span> <span class="s">"doubleEveryOther test"</span> <span class="n">doubleEveryOther</span>
             <span class="p">[([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">])]</span>
           <span class="p">]</span></code></pre></figure>

<h5 id="exercise-3">Exercise 3</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">sumDigits</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">sumDigits</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="n">sum</span><span class="o">.</span> <span class="n">toDigits</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">ex3Tests</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Test</span><span class="p">]</span>
<span class="n">ex3Tests</span> <span class="o">=</span> <span class="p">[</span><span class="n">testF1</span> <span class="s">"sumDigits test"</span> <span class="n">sumDigits</span>
             <span class="p">[([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">22</span><span class="p">)]</span>
           <span class="p">]</span></code></pre></figure>

<h5 id="exercise-4">Exercise 4</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">validate</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
<span class="n">validate</span> <span class="o">=</span> <span class="p">(</span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">.</span> <span class="p">(`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">10</span><span class="p">)</span> <span class="o">.</span> <span class="n">sumDigits</span> <span class="o">.</span> <span class="n">doubleEveryOther</span> <span class="o">.</span> <span class="n">toDigits</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="n">ex4Tests</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Test</span><span class="p">]</span>
<span class="n">ex4Tests</span> <span class="o">=</span> <span class="p">[</span><span class="n">testF1</span> <span class="s">"validate test"</span> <span class="n">validate</span>
             <span class="p">[(</span><span class="mi">4012888888881881</span><span class="p">,</span> <span class="kt">True</span><span class="p">),</span> <span class="p">(</span><span class="mi">4012888888881882</span><span class="p">,</span> <span class="kt">False</span><span class="p">)]</span>
           <span class="p">]</span></code></pre></figure>

<h5 id="exercise-5">Exercise 5</h5>

<figure class="highlight"><pre><code class="language-haskell" data-lang="haskell"><span class="kr">type</span> <span class="kt">Peg</span> <span class="o">=</span> <span class="kt">String</span>
<span class="kr">type</span> <span class="kt">Move</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Peg</span><span class="p">,</span> <span class="kt">Peg</span><span class="p">)</span>

<span class="n">hanoi</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Peg</span> <span class="o">-&gt;</span> <span class="kt">Peg</span> <span class="o">-&gt;</span> <span class="kt">Peg</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Move</span><span class="p">]</span>
<span class="n">hanoi</span> <span class="n">n</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">=</span> <span class="kt">[]</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)]</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">hanoi</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">a</span> <span class="n">c</span> <span class="n">b</span> <span class="o">++</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)]</span> <span class="o">++</span> <span class="n">hanoi</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">c</span> <span class="n">b</span> <span class="n">a</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/16/algebraic-data-types" rel="next" title="Algebraic Data Types">Algebraic Data Types</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/08/14/cis194-1" rel="previous" title="Learn Haskell">Learn Haskell</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Learn Haskell - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="How to learn Haskell" />
	

	
	<meta name="keywords" content="Haskell, Learning" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Learn Haskell</h1>
	<h4 class="large-bottom">
		Posted on 2015-08-14 02:11:25 +0900
		 in <a href="/categories/Functional Programming">Functional Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Haskell">Haskell</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="why-functional-programming">Why Functional Programming</h3>

<p>In the current world, tons of programming languages exist now, and tons of new ones
are being created.</p>

<h4 id="imperative-programming">Imperative Programming</h4>

<p>I am more confident in <code class="highlighter-rouge">C</code>, <code class="highlighter-rouge">Python</code>, only familliar with <code class="highlighter-rouge">C++</code> and <code class="highlighter-rouge">Java</code> in some sense.</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">C</code> is consise and small, but lacks a lot of libraries in its standard. It is used to
  implement critical componenet such as <a href="https://github.com/torvalds/linux">Kernel</a>, <a href="https://github.com/postgres/postgres">PostgreSQL</a>, <a href="https://github.com/antirez/redis">Redis</a>, etc.
  It worths when the system efficiency overweights the developing speed.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">C++</code> is powerful but much too complex. The compiler does a lot of things behind the scene.
  It really costs to learn the specific conditions in the compiler, such as <a href="https://msdn.microsoft.com/en-us/library/5dhe1hce.aspx">function overloading</a>,
  <a href="http://en.cppreference.com/w/cpp/language/implicit_cast#Numeric_promotions">Numeric promotions</a>, <a href="https://en.wikipedia.org/wiki/Rule_of_three_%28C%2B%2B_programming%29">Rule of three</a>, etc.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Java</code> is much simpler than <code class="highlighter-rouge">C++</code>, which is highly portable on JVM and truly object oriented.
  It consists of tons of frameworks and libraries, but is really verbose. It is used to build
  large softwares and is still popuar in big companies which provide web services.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Python</code> is really simple glue language. Due to its simplicity, people around the world not only
  the professional programmers are contributing all kinds of libraries. As it is <a href="http://stackoverflow.com/questions/11328920/is-python-strongly-typed">dynamic typing</a>,
  it is hard to build large system.</p>
  </li>
</ul>

<p>In my view, the key of Imperative Programming lies in controlling <a href="https://en.wikipedia.org/wiki/Side_effect_%28computer_science%29">side effects</a> which make the
programme hard to reason about and buggy.</p>

<h4 id="how-functional-programming-shines">How Functional Programming shines</h4>

<p>In <code class="highlighter-rouge">Python</code>, <code class="highlighter-rouge">function</code> is the first class, and it supports some basic FP features such as <code class="highlighter-rouge">map</code>, <code class="highlighter-rouge">reduce</code>, <code class="highlighter-rouge">list comprehention</code>, etc.
I find it really cool to have the following features,</p>

<ul>
  <li>Suitable for <a href="http://stackoverflow.com/questions/6957270/what-is-wholemeal-in-functional-programming">wholemeal programming</a></li>
  <li>Easy to reason about as it has no side effects</li>
  <li>Easy to parallelize</li>
</ul>

<h4 id="why-haskell">Why Haskell</h4>

<ul>
  <li>Completely <a href="http://www.haskell.org/haskellwiki/Referential_transparency">referentially transparent</a></li>
  <li>Powerful type system</li>
  <li><a href="https://wiki.haskell.org/Haskell_in_industry">Industrial use</a></li>
  <li>Concise</li>
</ul>

<h4 id="how-to-learn-haskell">How to learn Haskell</h4>

<p>As exercise plays an important role in learning, I would like to follow the suggestions in
<a href="https://github.com/bitemyapp/learnhaskell">learn haskell</a>, first finish <a href="http://www.seas.upenn.edu/%7Ecis194/spring13/lectures.html">CIS194</a>, then try <a href="https://github.com/NICTA/course">NICITA</a>.</p>

<p><a href="https://github.com/kamelzcs/cis-194">Here</a> is the source code for CIS194.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/15/introduction" rel="next" title="Introduction to Haskell">Introduction to Haskell</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/07/27/ipsc2015-h2" rel="previous" title="Decouple the relation and approach in different metrics">Decouple the relation and approach in different metrics</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/IPSC">IPSC</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Decouple the relation and approach in different metrics - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library Decouple the relation and approach in different metrics" />
	

	
	<meta name="keywords" content="Thinking" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Decouple the relation and approach in different metrics</h1>
	<h4 class="large-bottom">
		Posted on 2015-07-27 07:49:07 +0900
		 in <a href="/categories/Algorithm">Algorithm</a> 

		<span class="tag-list">
			
			<a href="/tags/IPSC">IPSC</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="problem-h--humble-captains"><a href="http://ipsc.ksp.sk/2015/real/problems/h.html">Problem H – Humble Captains</a></h3>

<p>The problem is given an undirected graph (Vertices&lt;=300), and need to color its vertices into red and blue in such a way that the total number of edges between the red vertices is as close as possible to the total number of edges between the blue vertices.</p>

<p>The key point lies in the way to count valid edges.</p>

<p>For each edge $e$ with two vertices $v1$, $v2$,
define <script type="math/tex">f(e)=1/2 \times ([v1==red] + [v2==red]) + (-1/2 \times ([v1==blue] + [v2==blue]))</script>, then
<script type="math/tex">count =  \sum_{\forall e \in E}f(e)</script></p>

<p>Now try to find $count$ from vertices.</p>

<script type="math/tex; mode=display">count = \frac{1}{2} \left( \sum_{\forall v \in Red}d_v -  \sum_{\forall v \in Blue}d_v \right)</script>

<p>Then the final problem can be rephrased to look for a partition which minimizes the absolute difference between
the sums of the numbers in each part, which could solved with dynamic programming easily.</p>

<p>This is really a nice problem, which requires to decouple the relations, and approach it in different metrics.
The problem is found from <a href="http://petr-mitrichev.blogspot.com/2015/06/a-week-with-h2.html">Petr’s blog</a>, <a href="http://ipsc.ksp.sk/2015/real/solutions/booklet.pdf">official analysis</a>.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/08/14/cis194-1" rel="next" title="Learn Haskell">Learn Haskell</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/07/27/srm663" rel="previous" title="SRM663">SRM663</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Jackknife">Jackknife</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>From Jackknife to A/B Testing - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Show how get the confidence interval for the effects of A/B Testing" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>From Jackknife to A/B Testing</h1>
	<h4 class="large-bottom">
		Posted on 2019-12-23 22:28:32 +0900
		 in <a href="/categories/Data Science">Data Science</a> 

		<span class="tag-list">
			
			<a href="/tags/Jackknife">Jackknife</a>
			
			<a href="/tags/Math">Math</a>
			
			<a href="/tags/A/B Testing">A/B Testing</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="background">Background</h4>
<p>In A/B Testing, there is a group of data <script type="math/tex">X = (X_1, X_2, ..., X_n)</script> and <script type="math/tex">Y = (Y_1, Y-2, ..., Y_m)</script>, the metrics we interested in are the difference between these two groups and related confidence.</p>

<h4 id="a-quick-introduction-to-jackknife">A Quick Introduction to Jackknife</h4>
<p><a href="https://www.math.wustl.edu/~sawyer/handouts/Jackknife.pdf">Jackknife</a> is a method of resample, which tries to estimate the bias and variability of an estimator <script type="math/tex">\phi_n(X_1, X_2, ..., X_n)</script> by using values of <script type="math/tex">\phi_n(X)</script> on subsamples from <script type="math/tex">X_1, X_2, ..., X_n</script>.</p>

<p>The <script type="math/tex">i^{th}</script> pseudovalue of <script type="math/tex">\phi_n(X)</script> is
<script type="math/tex">ps_i(X) = n\phi_n(X_1, X_2, ..., X_n) - (n - 1)\phi_{n - 1}((X_1, X_2, ..., X_n)_{[i]})</script>, where <script type="math/tex">X_{i}</script> means the sample <script type="math/tex">X_1, X_2, ..., X_n</script> with <script type="math/tex">i^{th}</script> value <script type="math/tex">X_i</script> deleted from the sample.</p>

<p>Treat the pseudovalue <script type="math/tex">ps_i(X)</script> as if they were independent random variables with mean <script type="math/tex">\theta</script>, then the confidence interval could be obtained using Central Limit Theorem. Specifically, let</p>

<p><script type="math/tex">ps(X) = \frac{1}{n}\sum_{i=1}^{n}ps_i(X)</script> and <script type="math/tex">V_{ps}(X) = \frac{1}{n - 1}sum_{i=1}^{n - 1}(ps_i(X) - ps(X))^2</script></p>

<p>be the mean and sample variance of the pseudovalues. The jackknife 95% confidence interval is</p>

<script type="math/tex; mode=display">ps(X) - 1.96\sqrt{\frac{1}{n}V_{ps}(X)}, ps(X) + 1.96\sqrt{\frac{1}{n}V_{ps}(X)}</script>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">sample_count</span> <span class="o">=</span> <span class="mi">500000</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span> <span class="c1"># mean and standard deviation
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">jackknife_sder</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'data'</span><span class="p">])</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_count</span> <span class="o">/</span> <span class="n">K</span> <span class="p">)</span>
    <span class="k">def</span> <span class="nf">label_race</span> <span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">%</span> <span class="n">groups</span>
    <span class="n">df</span><span class="p">[</span><span class="s">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">label_race</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">average</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'data'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="n">total_sum</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">left_k_groups</span> <span class="o">=</span> <span class="p">[(</span><span class="n">total_sum</span> <span class="o">-</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s">'group'</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="nb">sum</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">sample_count</span> <span class="o">-</span> <span class="n">K</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">groups</span><span class="p">)]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">groups</span> <span class="o">*</span> <span class="n">average</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">*</span> <span class="p">(</span><span class="n">groups</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">left_k_groups</span><span class="p">]</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> 
    
    <span class="n">mean</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">groups</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">sample_count</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">s_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">jackknife_sder</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
<span class="n">s_mean</span><span class="p">,</span> <span class="n">s_var</span> <span class="o">=</span>  <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">/</span> <span class="p">(</span><span class="n">sample_count</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">s_vars</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">s_var</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s">'expected {s_var:.4f}'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/output_2_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">confidence</span> <span class="o">=</span> <span class="mf">1.96</span>
<span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_mean</span> <span class="o">-</span> <span class="n">confidence</span> <span class="o">*</span>  <span class="n">s_vars</span><span class="p">,</span> <span class="n">s_mean</span> <span class="o">+</span> <span class="n">confidence</span> <span class="o">*</span>  <span class="n">s_vars</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">'left: {l:.4f}, right: {r:.4f}'</span><span class="p">)</span>


</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>left: 499.7084, right: 500.2740
</code></pre></div></div>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
	
		
		
	
		
			<a href="/2015/08/24/monads" rel="previous" title="Monads">Monads</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Java">Java</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Function_overriding in Java vs C++ - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Function overriding in Java and C++" />
	

	
	<meta name="keywords" content="Polymorphism" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Function_overriding in Java vs C++</h1>
	<h4 class="large-bottom">
		Posted on 2015-06-22 17:27:24 +0900
		 in <a href="/categories/Programming">Programming</a> 

		<span class="tag-list">
			
			<a href="/tags/Java">Java</a>
			
			<a href="/tags/C++">C++</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="similar-code-different-behaviour">Similar code, different behaviour</h3>

<p>Quesion in <a href="http://stackoverflow.com/questions/30883519/function-overriding-in-java-vs-c">stackoverflow</a>:</p>

<h4 id="java-version">Java version:</h4>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">base</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">func1</span><span class="o">(){</span>
        <span class="n">func2</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">func2</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">" I am in base:func2() \n"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

<span class="kd">class</span> <span class="nc">derived</span> <span class="kd">extends</span> <span class="n">base</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">func1</span><span class="o">(){</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">func1</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">func2</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">" I am in derived:func2() \n"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">};</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span>
<span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">derived</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">derived</span><span class="o">();</span>
        <span class="n">d</span><span class="o">.</span><span class="na">func1</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Output:</p>
<blockquote>
  <p>I am in derived:func2()</p>
</blockquote>

<h4 id="c-version">C++ version</h4>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include &lt;stdio.h&gt;
</span>
<span class="k">class</span> <span class="nc">base</span>
<span class="p">{</span>
    <span class="nl">public:</span>
        <span class="kt">void</span> <span class="n">func1</span><span class="p">(){</span>
            <span class="n">func2</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="kt">void</span> <span class="n">func2</span><span class="p">(){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">" I am in base:func2() </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">derived</span> <span class="o">:</span> <span class="k">public</span> <span class="n">base</span>
<span class="p">{</span>
    <span class="nl">public:</span>
        <span class="kt">void</span> <span class="n">func1</span><span class="p">(){</span>
            <span class="n">base</span><span class="o">::</span><span class="n">func1</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="kt">void</span> <span class="n">func2</span><span class="p">(){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">" I am in derived:func2() </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">derived</span> <span class="o">*</span><span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">derived</span><span class="p">();</span>
    <span class="n">d</span><span class="o">-&gt;</span><span class="n">func1</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>Output:</p>
<blockquote>
  <p>I am in base:func2()</p>
</blockquote>

<h3 id="why">Why</h3>

<p>Firstly, I thought the behaviour of <code class="highlighter-rouge">C++</code> is reasonable, <code class="highlighter-rouge">Java</code> version is hard to understand, as I am more used to <code class="highlighter-rouge">static binding</code>.</p>

<p>For both languages, variable binding is <code class="highlighter-rouge">static</code>, no matter it is member variable or not.</p>

<p>But for <code class="highlighter-rouge">method binding</code>, two languages behaviour differently.</p>

<p>In C++, unless this method is virtual, otherwise it is bind staticlly default.</p>

<p>but in Java, all method bindings use late binding unless it is <code class="highlighter-rouge">static</code> or <code class="highlighter-rouge">final</code>(<code class="highlighter-rouge">private</code> is implicly final).</p>

<p>Java version behaves as if you had declared <code class="highlighter-rouge">base::func2</code> as</p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="k">virtual</span> <span class="kt">void</span> <span class="nf">func2</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">" I am in base:func2() </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<h3 id="static-binding-vs-late-binding">Static Binding vs Late Binding</h3>

<p><code class="highlighter-rouge">static binding</code> means references are resovled at <code class="highlighter-rouge">compile time</code>, namely it is possible to resolve it by its <code class="highlighter-rouge">position</code>.</p>

<p><code class="highlighter-rouge">late binding</code> means references are resolved at <code class="highlighter-rouge">run time</code>, which is implemented through <code class="highlighter-rouge">Vtable</code> in C++.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/07/27/srm663" rel="next" title="SRM663">SRM663</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/06/13/srm661" rel="previous" title="SRM 661 div1">SRM 661 div1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Jekyll">Jekyll</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>如何使用模板 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="使用模板的方法" />
	

	
	<meta name="keywords" content="jekyll git github" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>如何使用模板</h1>
	<h4 class="large-bottom">
		Posted on 2012-12-28 06:44:30 +0900
		 in <a href="/categories/jekyll">jekyll</a> 

		<span class="tag-list">
			
			<a href="/tags/Jekyll">Jekyll</a>
			
			<a href="/tags/Git">Git</a>
			
			<a href="/tags/Github">Github</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-介绍">1 介绍</h2>

<p>在github上搭建一个中小型网站，可以充分利用github提供的托管功能，并且不用担心代码丢失的问题，是一件很惬意的事情。</p>

<h2 id="2-安装">2 安装</h2>

<p>基本参照<a href="http://kamelzcs.github.com/2012/08/14/blogging-with-jekyll/">http://kamelzcs.github.com/2012/08/14/blogging-with-jekyll/</a>即可。
说明几个需要注意的问题：</p>

<ol>
  <li>建立 username.github.com 这样的repo，这样就可以直接使用这个域名访问网站.</li>
  <li>_compiled主要用来中转,将_site拷贝过来之后，然后将目录切换到 _compiled，因为 _compiled 克隆的时候用的是master，所以自动切换到了master分支，然后提交到master分支。这里有个疑问,_compiled既然克隆出来的时候是在master分支，为什么在source分支下又可以看到这个文件夹，暂时不清楚。</li>
  <li>git会自动确定切换分支时哪些文件该出现，哪些不应该出现。</li>
</ol>

<p>2013年10月28日 更新：
jekyll升级到1.2.1 以后，jekyll-pagination会导致jekyll在 build的时候失败，只能将pagination.rb手动更新为最新的代码,同时__plugin文件夹中不能使用中文。</p>

<p>2015年1月21日 更新：
jekyll升级到2.5.4 以后，jekyll-pagination已经被内置jekyll-paginate代替。</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/01/02/review-2012" rel="next" title="review 2012">review 2012</a>
		
	
		
			
		
		
	
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Jinja2">Jinja2</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Jinja2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Learning Jinja2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Jinja2</h1>
	<h4 class="large-bottom">
		Posted on 2013-10-29 21:56:46 +0900
		 in <a href="/categories/Technique">Technique</a> 

		<span class="tag-list">
			
			<a href="/tags/Jinja2">Jinja2</a>
			
			<a href="/tags/Template">Template</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="variables">Variables</h3>

<p>{{ foo.bar }}</p>

<p>{{ foo[‘bar’] }}</p>

<h4 id="implementation">Implementation</h4>
<p>Sake foo.bar in Jinja2 does the following thing on the Python layer:</p>

<ul>
  <li>check if there is an attribute called bar on foo.</li>
  <li>if there is not, check if there is an item ‘bar’ in foo.</li>
  <li>if there is not, return an undefined object.</li>
</ul>

<p>foo[‘bar’] works mostly the same with a difference in the order:</p>

<ul>
  <li>check if there is an item ‘bar’ in foo.</li>
  <li>if there is not, check if there is an attribute called bar on foo.</li>
  <li>if there is not, return an undefined object.</li>
</ul>

<p>###Filers###
Variables can be modified by filters.<br />
{{ name|striptags|title }}  will remove all HTML Tags from the name and title-cases it.</p>

<p>###Tests###
Tests can be used to test a variable against a common expression.</p>

<p>{% if loop.index is divisibleby 3 %}</p>

<p>###Comments###</p>

<p>{# note: disabled template because we no longer use this<br />
    {% for user in users %}<br />
        …<br />
    {% endfor %}<br />
#}</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/05/storingdatainappengine" rel="next" title="Storing Data in App Engine">Storing Data in App Engine</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/10/29/gitcommands" rel="previous" title="Git Commands">Git Commands</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Life">Life</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>逝去的2013 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="逝去的2013" />
	

	
	<meta name="keywords" content="life review" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>逝去的2013</h1>
	<h4 class="large-bottom">
		Posted on 2014-01-06 07:41:07 +0900
		 in <a href="/categories/Life">Life</a> 

		<span class="tag-list">
			
			<a href="/tags/Life">Life</a>
			
			<a href="/tags/Review">Review</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="实习生活">实习生活</h3>

<p>过完新年之后的第一个周一，北上帝都。炮君先我一步，与高富帅看好了房子。到了帝都的第一天，在中介的
半忽悠之后，签下了第一份房租合同。略带新鲜，但是失落感很强的帝都生活开始了。</p>

<p>第一家实习的公司算是较大的公司，各方面较为正规，但是所做的事情是自己原来涉及较少的，从头学起是不得不经历的过程。
摸索着用起来了Linux，写起了Python，开始与Excel打交道，阅读关于公司技术框架与业务的文档。看着这个只有十几年历史
的互联网公司的框架，偶尔还能看到读大一大二时就已经耳闻的前辈们留下的文档与代码。在这里，我是1/20000。我是一颗
螺丝钉，想从人堆里面出头，是很难的事情。</p>

<p>但是大公司最大的好处就是培训的课程多，可以在上班的时候学习公司的training课程。线下帝都有特别多的技术交流的活动，
如果不介意帝都那阴沉的天空和让人望而生畏的房价，这里，应该是国内长技术的好地方。</p>

<p>50天的实习，在技术上没有明显的进步，倒是公司的文档与课程让我大开眼界。原来仅有耳闻的技术早已经在使用了。只是，这里
只是我的一个过渡的站点。</p>

<h3 id="走川西">走川西</h3>

<p>第一次也是唯一的一次外出露营,难以忘记在野外的快乐，或许我本身就是一个放荡不羁的人，在野外，我可以放肆的笑，可以傻傻的
看着花花草草发呆，可以在4600米海拔的地方裸露自己的上身，与神圣的贡嘎山合影。</p>

<p>一次又一次的被美丽的川西折服，一次又一次的赞叹自然的造化与人类精神上的纯洁与伟大。当我们出现高原反应的时候，是寺庙的方丈
无偿的给我们红景天泡水。当我第一次那么近距离的仰望满天的繁星的时候，我的心中除了满满的赞叹与心中的崇敬，毫无他念。</p>

<p>川西，一定要好好的走一遍，不至少一遍。川西，请等我。</p>

<h3 id="毕业">毕业</h3>

<p>七年之痒，毕业了。这三年是失去的三年，当初的意气风发被消耗了很多。当初已经能改变世界，后来，我没有能够改变世界，
只能尽量不要让世界改变了我。本科毕业的时候，我忙的不可开交，有很多的朋友要分别，有很多的事情要处理。这最后的毕业，
我居然是如此的清闲，没有未来的扑面而来的压迫，也没有自己迫不及待的期望，真正要分别的朋友也少了很多。</p>

<p>是我把自己封闭了，故作清高的认为周围值得自己认识的人很少，同时在找不到更好的目标的情况下，当我消极失落的时候，更多的
时间留给了三国杀和足球。</p>

<p>我是一个多么肤浅的人，即使技术上这不是一个领先的地方，我有网线，网络上，难道自己想努力，还不能找到适合自己的圈子？
我是一个多么肤浅的人，即使身边看到的优秀的同学不够多，但是，本科的学弟学妹们，在非技术方面优秀的同学难道不足以给自己
更多可以学习的启示？自己的知识系统是如此的不完善，难道有其他专长的同学不值得自己学习？封闭了自己，就是一个信息的孤岛，
信息的孤岛怎么能够与时俱进呢？</p>

<p>如果线下不能有一群志同道合的朋友的话，利用好每一个社交的工具，尽力的追赶，然后尽快的创造自己的圈子。总有很多人值得自己
学习，在每一个方面！</p>

<h3 id="驾照你好">驾照你好</h3>

<p>从7.5号考完理论，到9.4号拿到驾照，不足俩月。期间的考试都是一次性通过，比较满足。学手艺与学技术在我看来没有特别大的区别，
天赋与努力依然是互相依存的。</p>

<p>当然也见到了不少社会中略肮脏的交易，不想向它妥协，除了自己变强，没有它法。改变环境，没有相应的能力与影响，谈何容易。
即使有了相应的能力与影响，这也谈何容易。</p>

<h3 id="日语">日语</h3>

<p>接触日语应该有一年了，认真学习也有三四个月了。略有进步，但是同日本人交流依然问题很大，语法现在慢慢的懂了不少，但是单词
是最大的问题。除了每周周日去小学学习日语以外，每天说日语的时候少的可怜。说更多的日语，才能更好的掌握日语。更多的讲日语，
从与Cathy对话开始。</p>

<h3 id="工作">工作</h3>

<p>开始了公司的工作，在一个没有文档的框架上开发，同时又是基于App Engine的，这是有多的sucks，眼泪直流。不过，同事还好，老板
还好，push的不多，不懂的方法与技术慢慢的摸索与学习。只是每天都至少加班一个小时，让人略伤感。公司的人都是自动加班，暂时还
不知道这是为什么，或许这是日企的文化吧，慢慢体验。珍爱生命，原理加班，提高效率！</p>

<h3 id="更专业更细致">更专业，更细致</h3>

<p>加入了一只足球队，这是我第一次尝试加入日本人的圈子。很开心，很受打击，也很受教育。大家对我都很客气，队长对我也非常的照顾。
日本人专业的精神，让我赞叹。每次练习赛，都会有主裁、边裁，甚至都有入场仪式。而且每次训练前提前两周左右安排已经做好。他们是
如此的专业，这样做上10年，还会有什么不清楚的呢？对长辈的尊敬，不仅仅是出于礼节上，更主要的是别人比自己更专业！</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2014/01/17/bash-command-line-processing" rel="next" title="Bash Command Line Processing">Bash Command Line Processing</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/12/28/gitunderstanding" rel="previous" title="Understanding Git">Understanding Git</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Lisp">Lisp</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-4-3-3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-4-3-3" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-4-3-3</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-16 21:02:58 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="451">4.51</h4>

<p>It would always be <code class="highlighter-rouge">(a b 1)</code>.</p>

<h4 id="452">4.52</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">analyze-if-fail</span> <span class="nv">exp</span><span class="p">)</span>
   <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">first</span> <span class="p">(</span><span class="nf">analyze</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">exp</span><span class="p">)))</span>
         <span class="p">(</span><span class="nf">second</span> <span class="p">(</span><span class="nf">analyze</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">exp</span><span class="p">))))</span>
     <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">env</span> <span class="nv">succeed</span> <span class="nv">fail</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">first</span> <span class="nv">env</span>
              <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">value</span> <span class="nv">fail2</span><span class="p">)</span>
                <span class="p">(</span><span class="nf">succeed</span> <span class="nv">value</span> <span class="nv">fail2</span><span class="p">))</span>
              <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
                <span class="p">(</span><span class="nf">second</span> <span class="nv">env</span> <span class="nv">succeed</span> <span class="nv">fail</span><span class="p">))))))</span></code></pre></figure>

<h4 id="453">4.53</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">pairs</span> <span class="o">'</span><span class="p">()))</span>
  <span class="p">(</span><span class="nf">if-fail</span> <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">p</span> <span class="p">(</span><span class="nf">prime-sum-pair</span> <span class="o">'</span><span class="p">(</span><span class="nf">1</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">8</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">20</span> <span class="mi">35</span> <span class="mi">110</span><span class="p">))))</span>
             <span class="p">(</span><span class="nf">permanent-set!</span> <span class="nv">pairs</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">p</span> <span class="nv">pairs</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">amb</span><span class="p">))</span>
           <span class="nv">pairs</span><span class="p">))</span></code></pre></figure>

<p><code class="highlighter-rouge">pairs</code> would collect all the combinations of the two lists.
<code class="highlighter-rouge">(amb)</code> would force iterate all the valid pairs which would be returned.</p>

<h4 id="454">4.54</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">analyze-require</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">pproc</span> <span class="p">(</span><span class="nf">analyze</span> <span class="p">(</span><span class="nf">require-predicate</span> <span class="nv">exp</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">env</span> <span class="nv">succeed</span> <span class="nv">fail</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">pproc</span> <span class="nv">env</span>
             <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">pred-value</span> <span class="nv">fail2</span><span class="p">)</span>
               <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nf">true?</span> <span class="nv">pre-value</span><span class="p">))</span>
                   <span class="p">(</span><span class="nf">fail2</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">succeed</span> <span class="ss">'ok</span> <span class="nv">fail2</span><span class="p">)))</span>
             <span class="nv">fail</span><span class="p">))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/05/24/polymorphism-c" rel="next" title="One C++ polymorphism quesion">One C++ polymorphism quesion</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/15/sicp-4-3-2" rel="previous" title="sicp-4-3-2">sicp-4-3-2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-4-3-2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-4-3-2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-4-3-2</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-15 06:36:17 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="439">4.39</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme">    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">miller</span> <span class="nv">cooper</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">baker</span> <span class="mi">5</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">cooper</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">fletcher</span> <span class="mi">5</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">fletcher</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">smith</span> <span class="nv">fletcher</span><span class="p">))</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span>
     <span class="p">(</span><span class="nf">distinct?</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">baker</span> <span class="nv">cooper</span> <span class="nv">fletcher</span> <span class="nv">miller</span> <span class="nv">smith</span><span class="p">)))(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">fletcher</span> <span class="nv">cooper</span><span class="p">))</span> <span class="mi">1</span><span class="p">)))</span></code></pre></figure>

<p>The answer will always be correct, but the efficiency would be different.</p>

<p>By putting the more restrictive in the front makes the branch cutting happens earlier.</p>

<h4 id="440">4.40</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">multiple-dwelling</span><span class="p">)</span>
 <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">cooper</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">miller</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">)))</span>
   <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">miller</span> <span class="nv">cooper</span><span class="p">))</span>
   <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">fletcher</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)))</span>
     <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">fletcher</span> <span class="nv">cooper</span><span class="p">))</span> <span class="mi">1</span><span class="p">)))</span>
     <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">smith</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">)))</span>
       <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">smith</span> <span class="nv">fletcher</span><span class="p">))</span> <span class="mi">1</span><span class="p">)))</span>
       <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">baker</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)))</span>
         <span class="p">(</span><span class="nf">require</span>
           <span class="p">(</span><span class="nf">distinct?</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">baker</span> <span class="nv">cooper</span> <span class="nv">fletcher</span> <span class="nv">miller</span> <span class="nv">smith</span><span class="p">)))</span>
         <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'baker</span> <span class="nv">baker</span><span class="p">)</span>
               <span class="p">(</span><span class="nb">list</span> <span class="ss">'cooper</span> <span class="nv">cooper</span><span class="p">)</span>
               <span class="p">(</span><span class="nb">list</span> <span class="ss">'fletcher</span> <span class="nv">fletcher</span><span class="p">)</span>
               <span class="p">(</span><span class="nb">list</span> <span class="ss">'miller</span> <span class="nv">miller</span><span class="p">)</span>
               <span class="p">(</span><span class="nb">list</span> <span class="ss">'smith</span> <span class="nv">smith</span><span class="p">)))))))</span></code></pre></figure>

<h4 id="441">4.41</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">op</span> <span class="nv">initial</span> <span class="nv">sequence</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">sequence</span><span class="p">)</span>
      <span class="nv">initial</span>
      <span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">sequence</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">op</span> <span class="nv">initial</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">sequence</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">flatmap</span> <span class="nv">proc</span> <span class="nv">seq</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">append</span> <span class="nv">nil</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">proc</span> <span class="nv">seq</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">filter</span> <span class="nv">predicate</span> <span class="nv">sequence</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">sequence</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
        <span class="p">((</span><span class="nf">predicate</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">sequence</span><span class="p">))</span>
         <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">sequence</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">filter</span> <span class="nv">predicate</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">sequence</span><span class="p">))))</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">filter</span> <span class="nv">predicate</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">sequence</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">permutations</span> <span class="nv">lst</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">lst</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">list</span> <span class="o">'</span><span class="p">())</span>
    <span class="p">(</span><span class="nf">flatmap</span>
      <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">first</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">map</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">rest</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">first</span> <span class="nv">rest</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">permutations</span> <span class="p">(</span><span class="nf">filter</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">x</span> <span class="nv">first</span><span class="p">)))</span> <span class="nv">lst</span><span class="p">))))</span>
      <span class="nv">lst</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">permutations</span> <span class="o">'</span><span class="p">(</span><span class="nf">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span></code></pre></figure>

<p><code class="highlighter-rouge">permutations</code> function is the key point.</p>

<h4 id="442">4.42</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">xor</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="k">and</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">not</span> <span class="nv">b</span><span class="p">))</span>
      <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">not</span> <span class="nv">a</span><span class="p">)</span><span class="nv">b</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">liars</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">betty</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">ethel</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">joan</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">kitty</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">mary</span> <span class="p">(</span><span class="nf">amb</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span>
      <span class="p">(</span><span class="nf">distinct?</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">betty</span> <span class="nv">ethel</span> <span class="nv">joan</span> <span class="nv">kitty</span> <span class="nv">mary</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nf">xor</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">kitty</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">betty</span> <span class="mi">3</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nf">xor</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">ethel</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">joan</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nf">xor</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">joan</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">ethel</span> <span class="mi">5</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nf">xor</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">kitty</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">mary</span> <span class="mi">4</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nf">xor</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">mary</span> <span class="mi">4</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">betty</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'betty</span> <span class="nv">betty</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">list</span> <span class="ss">'ethel</span> <span class="nv">ethel</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">list</span> <span class="ss">'joan</span> <span class="nv">joan</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">list</span> <span class="ss">'kitty</span> <span class="nv">kitty</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">list</span> <span class="ss">'mary</span> <span class="nv">mary</span><span class="p">))))</span></code></pre></figure>

<p>One important thing to note is, <code class="highlighter-rouge">and</code> and <code class="highlighter-rouge">or</code> is not a regular primitive function
in Scheme, classification is <a href="http://stackoverflow.com/questions/8020870/why-cant-i-define-an-or-function-in-scheme">here</a>, it must be dealt with separatly.</p>

<h4 id="444">4.44</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">safe?</span> <span class="nv">result</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">p</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">result</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">conflict?</span> <span class="nv">q</span> <span class="nv">i</span><span class="p">)</span>
      <span class="p">(</span><span class="k">or</span>
        <span class="p">(</span><span class="nb">=</span> <span class="nv">p</span> <span class="nv">q</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">=</span> <span class="nv">p</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">q</span> <span class="nv">i</span><span class="p">))</span>
        <span class="p">(</span><span class="nb">=</span> <span class="nv">p</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">q</span> <span class="nv">i</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">check</span> <span class="nv">rest</span> <span class="nv">i</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span>
        <span class="p">((</span><span class="nb">null?</span> <span class="nv">rest</span><span class="p">)</span> <span class="nv">true</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">conflict?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">rest</span><span class="p">)</span> <span class="nv">i</span><span class="p">)</span> <span class="nv">false</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">check</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">rest</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">i</span> <span class="mi">1</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nf">check</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">result</span><span class="p">)</span> <span class="mi">1</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">queens</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">result</span> <span class="nv">left</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">0</span> <span class="nv">left</span><span class="p">)</span>
      <span class="nv">result</span>
      <span class="p">(</span><span class="k">begin</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">new</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">an-integer-between</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">)</span>
                         <span class="nv">result</span><span class="p">)))</span>
          <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nf">safe?</span> <span class="nv">new</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">iter</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">left</span> <span class="mi">1</span><span class="p">))))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="o">'</span><span class="p">()</span> <span class="nv">n</span><span class="p">))</span>

<span class="p">(</span><span class="nf">queens</span> <span class="mi">8</span><span class="p">)</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/16/sicp-4-3-3" rel="next" title="sicp-4-3-3">sicp-4-3-3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/13/sicp-4-3-1" rel="previous" title="sicp-4-3-1">sicp-4-3-1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-4-3-1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-4-3-1" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-4-3-1</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-13 22:47:34 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>I just find <code class="highlighter-rouge">4.3</code> very hard to understand.
Eventhough I followed the author’s ideas, and find it work.</p>

<p>But this time I found even try to understand the callings through debug would be very difficult.</p>

<p>There should be theoretical foundations for this, finally, though <a href="https://www.ida.liu.se/~TDDA69/fo/2014/9-non-deterministic.pdf">this tutorial</a>, I found
the idea befind it is <a href="http://en.wikipedia.org/wiki/Continuation-passing_style">CPS</a>. There are other materials <a href="https://cgi.soic.indiana.edu/~c311/lib/exe/fetch.php?media=cps-notes.scm">here</a>, <a href="https://cgi.soic.indiana.edu/~c311/doku.php?id=cps-refresher">here</a>.</p>

<h4 id="435">4.35</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">an-integer-between</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">&lt;=</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">amb</span> <span class="nv">low</span> <span class="p">(</span><span class="nf">an-integer-between</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">low</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">high</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">a-pythagorean-triple-between</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">i</span> <span class="p">(</span><span class="nf">an-integer-between</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">j</span> <span class="p">(</span><span class="nf">an-integer-between</span> <span class="nv">i</span> <span class="nv">high</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">k</span> <span class="p">(</span><span class="nf">an-integer-between</span> <span class="nv">j</span> <span class="nv">high</span><span class="p">)))</span>
        <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">i</span> <span class="nv">i</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">j</span> <span class="nv">j</span><span class="p">))</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="nv">k</span><span class="p">)))</span>
        <span class="p">(</span><span class="nb">list</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span><span class="p">)))))</span>

<span class="p">(</span><span class="nf">a-pythagorean-triple-between</span> <span class="mi">1</span> <span class="mi">100</span><span class="p">)</span></code></pre></figure>

<h4 id="436">4.36</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">a-pythagorean-triple-from</span> <span class="nv">low</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">k</span> <span class="p">(</span><span class="nf">an-integer-starting-from</span> <span class="nv">low</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">i</span> <span class="p">(</span><span class="nf">an-integer-between</span> <span class="nv">low</span> <span class="nv">k</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">j</span> <span class="p">(</span><span class="nf">an-integer-between</span> <span class="nv">i</span> <span class="nv">k</span><span class="p">)))</span>
        <span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">i</span> <span class="nv">i</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">j</span> <span class="nv">j</span><span class="p">))</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="nv">k</span><span class="p">)))</span>
        <span class="p">(</span><span class="nb">list</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span><span class="p">)))))</span>

<span class="p">(</span><span class="nf">a-pythagorean-triple-from</span> <span class="mi">1</span><span class="p">)</span></code></pre></figure>

<h4 id="437">4.37</h4>

<p>It would cut many useless branches.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/15/sicp-4-3-2" rel="next" title="sicp-4-3-2">sicp-4-3-2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/12/sicp-4-2-3" rel="previous" title="sicp-4-2-3">sicp-4-2-3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-4-2-3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-4-2-3" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-4-2-3</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-12 20:27:03 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="432">4.32</h4>

<p>In the current version, <code class="highlighter-rouge">car</code> is lazy as well, which makes it possible to build structures such as <code class="highlighter-rouge">infinite tree</code>.</p>

<h4 id="433">4.33</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="c1">;'(a b c)--&gt;(cons 'a (cons 'b (cons 'c '())))</span>

<span class="p">((</span><span class="nf">quoted?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">text-of-quotation</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">list-&gt;cons</span> <span class="nv">lst</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">lst</span><span class="p">)</span>
    <span class="o">'</span><span class="p">()</span>
    <span class="p">(</span><span class="nb">list</span> <span class="ss">'cons</span>
          <span class="p">(</span><span class="nb">list</span> <span class="ss">'quote</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lst</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">list-&gt;cons</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lst</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">text-of-quotation</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">quoted-operand</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">exp</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">quoted-operand</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nf">list-&gt;cons</span> <span class="nv">quoted-operand</span><span class="p">)</span> <span class="nv">env</span><span class="p">)</span>
      <span class="nv">quoted-operand</span><span class="p">)))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/13/sicp-4-3-1" rel="next" title="sicp-4-3-1">sicp-4-3-1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/11/sicp-4-2-1" rel="previous" title="sicp-4-2-1">sicp-4-2-1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-4-2-1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-4-2-1" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-4-2-1</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-11 19:20:01 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="425">4.25</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unless</span> <span class="nv">condition</span> <span class="nv">usual-value</span> <span class="nv">exceptional-value</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="nv">condition</span> <span class="nv">exceptional-value</span> <span class="nv">usual-value</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">*</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">factorial</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="mi">1</span><span class="p">))</span></code></pre></figure>

<p>In applicative-order, <code class="highlighter-rouge">factorial</code> will enter an infinite loop, as
the <code class="highlighter-rouge">exceptional-value</code> is evaluated regardless the <code class="highlighter-rouge">condition</code>.</p>

<p>While in normal-order, the <code class="highlighter-rouge">condition</code> is judged before <code class="highlighter-rouge">exceptional-value</code> is evaluated.</p>

<h4 id="426">4.26</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unless?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">exp</span> <span class="ss">'unless</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unless-clauses</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">exp</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unless-condition</span> <span class="nv">clauses</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">clauses</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unless-usual-value</span> <span class="nv">clauses</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">clauses</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unless-exceptional-value</span> <span class="nv">clauses</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">clauses</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unless-&gt;if</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">expand-unless-clauses</span> <span class="p">(</span><span class="nf">unless-clauses</span> <span class="nv">exp</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">expand-unless-clauses</span> <span class="nv">clauses</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">make-if</span> <span class="p">(</span><span class="nf">unless-condition</span> <span class="nv">clauses</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">unless-exceptional-value</span> <span class="nv">clauses</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">unless-usual-value</span> <span class="nv">clauses</span><span class="p">)))</span></code></pre></figure>

<p>It would fail if <code class="highlighter-rouge">unless</code> is passed as parameter, as there is no such
procedure.</p>

<h4 id="427">4.27</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">count</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">id</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">set!</span> <span class="nv">count</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">count</span> <span class="mi">1</span><span class="p">))</span>
  <span class="nv">x</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">w</span> <span class="p">(</span><span class="nf">id</span> <span class="p">(</span><span class="nf">id</span> <span class="mi">10</span><span class="p">)))</span>
<span class="c1">;;; L-Eval input:</span>
<span class="nv">count</span>
<span class="c1">;;; L-Eval value:</span>
<span class="mi">1</span>
<span class="c1">;;; L-Eval input:</span>
<span class="nv">w</span>
<span class="c1">;;; L-Eval value:</span>
<span class="mi">10</span>
<span class="c1">;;; L-Eval input:</span>
<span class="nv">count</span>
<span class="c1">;;; L-Eval value:</span>
<span class="mi">2</span></code></pre></figure>

<p><code class="highlighter-rouge">(define w (id (id 10)))</code> will cause the outer <code class="highlighter-rouge">id</code> being force, <code class="highlighter-rouge">(id 10)</code> is not evaluated and being returned as a thunk.</p>

<p>The evaluation of <code class="highlighter-rouge">w</code> forces the inner <code class="highlighter-rouge">id</code> being forced.</p>

<h4 id="428">4.28</h4>

<p>I think it would cause trouble if the <code class="highlighter-rouge">operator</code> is a thunk instead of actual procedure.
In order to make the <code class="highlighter-rouge">operator</code> be a thunk, the easiest way is to pass the procedure as a parameter.
such as:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">g</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">g</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">g</span> <span class="nv">x</span><span class="p">))</span>
<span class="p">(</span><span class="nf">f</span> <span class="nv">g</span> <span class="mi">10</span><span class="p">)</span></code></pre></figure>

<h4 id="429">4.29</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nf">id</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="mi">100</span>
<span class="c1">;;; L-Eval input:</span>
<span class="nv">count</span>
<span class="c1">;;; L-Eval value:</span>
<span class="mi">1</span> <span class="c1">; with memorization, (id 10) is called once.</span>
<span class="mi">2</span> <span class="c1">; without memorization, (id 10) is called twice</span></code></pre></figure>

<p>To test the efficiency, simillar to the <code class="highlighter-rouge">4.24</code> problem.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="nb">eval</span> <span class="o">'</span><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
      <span class="mi">1</span>
      <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">factorial</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="nv">n</span><span class="p">)))</span> <span class="nv">the-global-environment</span><span class="p">)</span>

<span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">t0</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">t1</span> <span class="mi">0</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">loop</span> <span class="nv">i</span> <span class="nv">n</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">eval</span> <span class="o">'</span><span class="p">(</span><span class="nf">factorial</span> <span class="mi">1234</span><span class="p">)</span> <span class="nv">the-global-environment</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">i</span> <span class="nv">n</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">loop</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">n</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">set!</span> <span class="nv">t0</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">loop</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">(</span><span class="k">set!</span> <span class="nv">t1</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">-</span> <span class="nv">t1</span> <span class="nv">t0</span><span class="p">))</span>

<span class="c1">;9.864471 second without memorization</span>
<span class="c1">;0.027408 second with memorization</span></code></pre></figure>

<h4 id="430">4.30</h4>

<ol>
  <li><code class="highlighter-rouge">display</code> is a primitive function, so Ben is right.</li>
  <li>with original version, <code class="highlighter-rouge">(p1 1) = (1,2)</code> and <code class="highlighter-rouge">(p2 1) = 1</code> while in Cy’s version, both of them would be <code class="highlighter-rouge">(1, 2)</code>.</li>
</ol>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">p2</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">p</span> <span class="nv">e</span><span class="p">)</span>
    <span class="nv">e</span>
    <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">p</span> <span class="p">(</span><span class="k">set!</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="o">'</span><span class="p">(</span><span class="nf">2</span><span class="p">)))))</span></code></pre></figure>

<p><code class="highlighter-rouge">(set! x (cons x '(2)))</code> is passed in as a thunk parameter <code class="highlighter-rouge">e</code> of the internal <code class="highlighter-rouge">p</code> procedure in the
original version and is not forced as it is not passed to a primitive procedure.</p>

<ol>
  <li>Obviously.</li>
  <li>I prefer the text’s. As lazy evalution is better not involved with side effects.</li>
</ol>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/12/sicp-4-2-3" rel="next" title="sicp-4-2-3">sicp-4-2-3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/09/sicp-4-1-6-4-1-7" rel="previous" title="sicp-4-1-6-4-1-7">sicp-4-1-6-4-1-7</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-4-1-6-4-1-7 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-4-1-6-4-1-7" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-4-1-6-4-1-7</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-09 23:37:54 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="416">4.16</h4>

<p>a:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">lookup-variable-value</span> <span class="nv">var</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">env-loop</span> <span class="nv">env</span><span class="p">)</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">scan</span> <span class="nv">vars</span> <span class="nv">vals</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">vars</span><span class="p">)</span>
             <span class="p">(</span><span class="nf">env-loop</span> <span class="p">(</span><span class="nf">enclosing-environment</span> <span class="nv">env</span><span class="p">)))</span>
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">var</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">vars</span><span class="p">))</span>
             <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">equal?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">vals</span><span class="p">)</span> <span class="ss">'*unassigned*</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">error</span> <span class="s">"Unassigned variable"</span> <span class="nv">var</span><span class="p">)</span>
               <span class="p">(</span><span class="nb">car</span> <span class="nv">vals</span><span class="p">)))</span>
            <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">scan</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">vars</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">vals</span><span class="p">)))))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">eq?</span> <span class="nv">env</span> <span class="nv">the-empty-environment</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">error</span> <span class="s">"Unbound variable"</span> <span class="nv">var</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">frame</span> <span class="p">(</span><span class="nf">first-frame</span> <span class="nv">env</span><span class="p">)))</span>
        <span class="p">(</span><span class="nf">scan</span> <span class="p">(</span><span class="nf">frame-variables</span> <span class="nv">frame</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">frame-values</span> <span class="nv">frame</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">env-loop</span> <span class="nv">env</span><span class="p">))</span></code></pre></figure>

<p>b:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">scan-out-defines</span> <span class="nv">body</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nf">definitions</span> <span class="p">(</span><span class="nf">filter</span> <span class="nv">definition?</span> <span class="nv">body</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">rest-of-lambda</span> <span class="p">(</span><span class="nf">filter</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
                                   <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nf">definition?</span> <span class="nv">x</span><span class="p">)))</span>
                                 <span class="nv">body</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">symbols</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">cadr</span> <span class="nv">definitions</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">let-body</span> <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">s</span> <span class="o">'</span><span class="ss">'*unassigned*</span><span class="p">))</span>
                              <span class="nv">symbols</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">set-body</span> <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'set!</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">s</span><span class="p">)))</span>
                        <span class="nv">definitions</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">let-body</span><span class="p">)</span>
      <span class="nv">body</span>
      <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'let</span> <span class="nv">let-body</span><span class="p">)</span> <span class="nv">set-body</span> <span class="nv">rest-of-lambda</span><span class="p">)))))</span></code></pre></figure>

<p>This part is tricky, which took me several hours to make it.</p>
<ol>
  <li><code class="highlighter-rouge">''*unassigned*</code> needs two single quotes. Because <code class="highlighter-rouge">'*unassigned*</code> is the value
of a variable.</li>
  <li>The returned value should be in a list.</li>
  <li>The <code class="highlighter-rouge">(null? let-body)</code> should be used, otherwise it would loop forever.</li>
</ol>

<h4 id="417">4.17</h4>

<p>There is an extra frame in the transformed program because <code class="highlighter-rouge">let</code> is transformed to a <code class="highlighter-rouge">lambda</code> call.</p>

<p>To make the scope role “simultaneous” without creating a new frame, the internal definations could
be extract to the top before being runned.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rearrange</span> <span class="nv">body</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nf">definitions</span> <span class="p">(</span><span class="nf">filter</span> <span class="nv">definition?</span> <span class="nv">body</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">rest-of-lambda</span> <span class="p">(</span><span class="nf">filter</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
                                   <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nf">definition?</span> <span class="nv">x</span><span class="p">)))</span>
                                 <span class="nv">body</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">append</span> <span class="nv">definitions</span> <span class="nv">rest-of-lambda</span><span class="p">)))</span></code></pre></figure>

<h4 id="418">4.18</h4>

<p>Both this version and the original version would not work, as the values of <code class="highlighter-rouge">u</code> and <code class="highlighter-rouge">v</code> are
evaluated directly without through other proxy values.</p>

<h4 id="419">4.19</h4>

<p>The footnote gives the opinion of the author.
It is complicated implement the <code class="highlighter-rouge">simutaneous</code>, even though <code class="highlighter-rouge">Topological sort</code> could be used to deal with
simple defination order problem.</p>

<p>But when the <code class="highlighter-rouge">mutual_recursion</code> happens, it would not be possible to get the actual defination order at all.
For racket:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">a</span> <span class="mi">1</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">define</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="nv">x</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="nv">a</span> <span class="mi">5</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">f</span> <span class="mi">10</span><span class="p">))</span>

<span class="nv">a:</span> <span class="nv">undefined</span><span class="c1">;</span>
 <span class="nv">cannot</span> <span class="nv">use</span> <span class="nv">before</span> <span class="nv">initialization</span></code></pre></figure>

<h4 id="420">4.20</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">letrec?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">exp</span> <span class="ss">'letrec</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">letrec-&gt;let</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nf">assi</span> <span class="p">(</span><span class="nf">let-associations</span> <span class="nv">exp</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">rest-of-lambda</span> <span class="p">(</span><span class="nf">let-body</span> <span class="nv">exp</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">symbols</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">car</span> <span class="nv">assi</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">let-body</span> <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">s</span> <span class="o">'</span><span class="ss">'*unassigned*</span><span class="p">))</span>
                              <span class="nv">symbols</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">set-body</span> <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'set!</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">s</span><span class="p">)))</span>
                        <span class="nv">assi</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">let-body</span><span class="p">)</span>
      <span class="nv">exp</span>
      <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'let</span> <span class="nv">let-body</span><span class="p">)</span> <span class="nv">set-body</span> <span class="nv">rest-of-lambda</span><span class="p">))))</span></code></pre></figure>

<p><code class="highlighter-rouge">letrec</code>is evaluated includes all the <code class="highlighter-rouge">letrec</code> bindings, while <code class="highlighter-rouge">let</code> is not.</p>

<h4 id="421">4.21</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span>
   <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">fact</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">fact</span> <span class="nv">fact</span> <span class="nv">n</span><span class="p">))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">k</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)</span>
        <span class="mi">1</span>
        <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">ft</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)))))))</span>
 <span class="mi">10</span><span class="p">)</span>

<span class="c1">;--&gt;</span>
<span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">k</span><span class="p">)</span>
   <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)</span>
     <span class="mi">1</span>
     <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">ft</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)))))</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">k</span><span class="p">)</span>
   <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)</span>
     <span class="mi">1</span>
     <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">ft</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)))))</span>
 <span class="mi">10</span><span class="p">)</span>

<span class="c1">;--&gt;</span>
<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">10</span> <span class="mi">1</span><span class="p">)</span>
  <span class="mi">1</span>
  <span class="p">(</span><span class="nb">*</span> <span class="mi">10</span>
     <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">k</span><span class="p">)</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)</span>
          <span class="mi">1</span>
          <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">ft</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">k</span><span class="p">)</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)</span>
          <span class="mi">1</span>
          <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">ft</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)))))</span>
      <span class="mi">9</span><span class="p">)))</span>

<span class="c1">;--&gt;</span>
<span class="p">(</span><span class="nb">*</span> <span class="mi">10</span>
   <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">k</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)</span>
        <span class="mi">1</span>
        <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">ft</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)))))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">k</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)</span>
        <span class="mi">1</span>
        <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="p">(</span><span class="nf">ft</span> <span class="nv">ft</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)))))</span>
    <span class="mi">9</span><span class="p">)))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nb">even?</span> <span class="nv">odd?</span><span class="p">)</span>
     <span class="p">(</span><span class="nb">even?</span> <span class="nv">even?</span> <span class="nv">odd?</span> <span class="nv">x</span><span class="p">))</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">ev?</span> <span class="nv">od?</span> <span class="nv">n</span><span class="p">)</span>
     <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">true</span> <span class="p">(</span><span class="nf">od?</span> <span class="nv">ev?</span> <span class="nv">od?</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))))</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">ev?</span> <span class="nv">od?</span> <span class="nv">n</span><span class="p">)</span>
     <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">false</span> <span class="p">(</span><span class="nf">ev?</span> <span class="nv">ev?</span> <span class="nv">od?</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))))))</span></code></pre></figure>

<p>$\lambda$ makes functional programming possible.</p>

<h4 id="422">4.22</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">((</span><span class="nf">let?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">analyze</span> <span class="p">(</span><span class="nf">let-&gt;combination</span> <span class="nv">exp</span><span class="p">)))</span></code></pre></figure>

<p>Analyze is able to handle it.</p>

<h4 id="423">4.23</h4>

<p><code class="highlighter-rouge">execute-sequence</code> has <code class="highlighter-rouge">cond</code> and other extra commands, while the text version
is just some runnable procedure.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">env</span><span class="p">)</span>
  <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">env</span><span class="p">)</span> 
     <span class="p">(</span><span class="nf">proc1</span> <span class="nv">env</span><span class="p">)</span> 
     <span class="p">(</span><span class="nf">proc2</span> <span class="nv">env</span><span class="p">))</span>
   <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">proc3</span> <span class="nv">env</span><span class="p">))</span></code></pre></figure>

<h4 id="424">4.24</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="nb">eval</span> <span class="o">'</span><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
      <span class="mi">1</span>
      <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">factorial</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="nv">n</span><span class="p">)))</span> <span class="nv">the-global-environment</span><span class="p">)</span>

<span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">t0</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">t1</span> <span class="mi">0</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">loop</span> <span class="nv">i</span> <span class="nv">n</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">eval</span> <span class="o">'</span><span class="p">(</span><span class="nf">factorial</span> <span class="mi">1234</span><span class="p">)</span> <span class="nv">the-global-environment</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">i</span> <span class="nv">n</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">loop</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">n</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">set!</span> <span class="nv">t0</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">loop</span> <span class="mi">0</span> <span class="mi">200</span><span class="p">)</span>
  <span class="p">(</span><span class="k">set!</span> <span class="nv">t1</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">-</span> <span class="nv">t1</span> <span class="nv">t0</span><span class="p">))</span></code></pre></figure>

<p>For original version: $3.302853$ second, while for optimized version $2.106789$ second.</p>

	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/11/sicp-4-2-1" rel="next" title="sicp-4-2-1">sicp-4-2-1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/06/sicp-4-1-3-4-1-5" rel="previous" title="sicp-4-1-3-4-1-5">sicp-4-1-3-4-1-5</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-4-1-3-4-1-5 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-4-1-3-4-1-5" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-4-1-3-4-1-5</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-06 20:12:10 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="411">4.11</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-frame</span> <span class="nv">variables</span> <span class="nv">values</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">length</span> <span class="nv">variables</span><span class="p">)</span> <span class="p">(</span><span class="nb">length</span> <span class="nv">values</span><span class="p">))</span>
    <span class="p">(</span><span class="nb">map</span> <span class="nv">cons</span> <span class="nv">variables</span> <span class="nv">values</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">error</span> <span class="s">"length mismatch -- MAKE-FRAME"</span> <span class="nv">variables</span> <span class="nv">values</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">frame-variables</span> <span class="nv">frame</span><span class="p">)</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">car</span> <span class="nv">frame</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">frame-values</span> <span class="nv">frame</span><span class="p">)</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">cdr</span> <span class="nv">frame</span><span class="p">))</span></code></pre></figure>

<h4 id="412">4.12</h4>

<p>I can only come up with a <code class="highlighter-rouge">find-binding-frame</code> function and manually controls its
process under different situations.
But <a href="https://wqzhang.wordpress.com/2009/11/03/sicp-exercise-4-12/">Zhang</a> come up with a more higher level abstraction which only expose two
functions to all the rest logic, which is <code class="highlighter-rouge">null-action</code> and <code class="highlighter-rouge">eq-action</code>. Clean and robust!</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">env-loop</span> <span class="nv">var</span> <span class="nv">null-action</span> <span class="nv">eq-action</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">scan</span> <span class="nv">vars</span> <span class="nv">vals</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">vars</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">null-action</span> <span class="nv">env</span><span class="p">))</span>
          <span class="p">((</span><span class="nb">eq?</span> <span class="nv">var</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">vars</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">eq-action</span> <span class="nv">vals</span><span class="p">))</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">scan</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">vars</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">vals</span><span class="p">)))))</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">eq?</span> <span class="nv">env</span> <span class="nv">the-empty-environment</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">error</span> <span class="s">"Unbound variable"</span> <span class="nv">var</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">frame</span> <span class="p">(</span><span class="nf">first-frame</span> <span class="nv">env</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">scan</span> <span class="p">(</span><span class="nf">frame-variables</span> <span class="nv">frame</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">frame-values</span> <span class="nv">frame</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">set-variable-value!</span> <span class="nv">var</span> <span class="nv">val</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">null-action</span> <span class="nv">e</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">env-loop</span> <span class="nv">var</span> <span class="nv">null-action</span> <span class="nv">eq-action</span> <span class="p">(</span><span class="nf">enclosing-environment</span> <span class="nv">e</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">eq-action</span> <span class="nv">vs</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">set-car!</span> <span class="nv">vs</span> <span class="nv">val</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">env-loop</span> <span class="nv">var</span> <span class="nv">null-action</span> <span class="nv">eq-action</span> <span class="nv">env</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">lookup-variable-value</span> <span class="nv">var</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">null-action</span> <span class="nv">e</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">env-loop</span> <span class="nv">var</span> <span class="nv">null-action</span> <span class="nv">eq-action</span> <span class="p">(</span><span class="nf">enclosing-environment</span> <span class="nv">e</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define</span> <span class="nv">eq-action</span> <span class="nv">car</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">env-loop</span> <span class="nv">var</span> <span class="nv">null-action</span> <span class="nv">eq-action</span> <span class="nv">env</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">define-variable!</span> <span class="nv">var</span> <span class="nv">val</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">null-action</span> <span class="nv">e</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">add-binding-to-frame!</span> <span class="nv">var</span> <span class="nv">val</span> <span class="p">(</span><span class="nf">first-frame</span> <span class="nv">e</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">eq-action</span> <span class="nv">vs</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">set-car!</span> <span class="nv">vs</span> <span class="nv">val</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">env-loop</span> <span class="nv">var</span> <span class="nv">null-action</span> <span class="nv">eq-action</span> <span class="nv">env</span><span class="p">))</span></code></pre></figure>

<h4 id="413">4.13</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"> <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-unbound</span> <span class="nv">variable</span> <span class="nv">env</span><span class="p">)</span>
   <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">vars</span> <span class="p">(</span><span class="nf">frame-variables</span> <span class="p">(</span><span class="nf">first-frame</span> <span class="nv">env</span><span class="p">)))</span>
         <span class="p">(</span><span class="nf">vals</span> <span class="p">(</span><span class="nf">frame-values</span> <span class="p">(</span><span class="nf">first-frame</span> <span class="nv">env</span><span class="p">))))</span>
     <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unbound</span> <span class="nv">vars</span> <span class="nv">vals</span> <span class="nv">new-vars</span> <span class="nv">new-vals</span><span class="p">)</span>
       <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">vars</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">error</span> <span class="s">"variable is not in the environment -- MAKE-UNBOUND"</span>
                     <span class="nv">variable</span><span class="p">))</span>
             <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">vars</span><span class="p">)</span> <span class="nv">variable</span><span class="p">)</span>
              <span class="p">(</span><span class="nb">set-car!</span> <span class="nv">env</span>
                        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">append</span> <span class="nv">new-vars</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">vars</span><span class="p">))</span>
                              <span class="p">(</span><span class="nb">append</span> <span class="nv">new-vals</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">vals</span><span class="p">)))))</span>
             <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">unbound</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">vars</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">vals</span><span class="p">)</span>
                            <span class="p">(</span><span class="nb">append</span>  <span class="nv">new-vars</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">vars</span><span class="p">)))</span>
                            <span class="p">(</span><span class="nb">append</span>  <span class="nv">new-vals</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">vals</span><span class="p">)))</span>
     <span class="p">(</span><span class="nf">unbound</span> <span class="nv">vars</span> <span class="nv">vals</span> <span class="o">'</span><span class="p">()</span> <span class="o">'</span><span class="p">())))</span></code></pre></figure>

<h4 id="414">4.14</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">((</span><span class="nf">application?</span> <span class="nv">exp</span><span class="p">)</span>
 <span class="p">(</span><span class="nb">apply</span> <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nf">operator</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">list-of-values</span> <span class="p">(</span><span class="nf">operands</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">apply</span> <span class="nv">procedure</span> <span class="nv">arguments</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">primitive-procedure?</span> <span class="nv">procedure</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">apply-primitive-procedure</span> <span class="nv">procedure</span> <span class="nv">arguments</span><span class="p">))</span>
        <span class="o">...</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">apply-primitive-procedure</span> <span class="nv">proc</span> <span class="nv">args</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">apply-in-underlying-scheme</span>
   <span class="p">(</span><span class="nf">primitive-implementation</span> <span class="nv">proc</span><span class="p">)</span> <span class="nv">args</span><span class="p">))</span></code></pre></figure>

<p>When eval <code class="highlighter-rouge">'(map + '(1 2) '(3 4))</code>, primitive procedure <code class="highlighter-rouge">+</code> is evaluated as <code class="highlighter-rouge">'(primitive +)</code>.
Then expression becomes <code class="highlighter-rouge">(apply-in-underlying-scheme map '(primitive +) '(1 2) '(3 4))</code>, then failed.</p>

<h4 id="415">4.15</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">run-forever</span><span class="p">)</span> <span class="p">(</span><span class="nf">run-forever</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">try</span> <span class="nv">p</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">halts?</span> <span class="nv">p</span> <span class="nv">p</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">run-forever</span><span class="p">)</span>
    <span class="ss">'halted</span><span class="p">))</span></code></pre></figure>

<p>There are two possible outcomes to run <code class="highlighter-rouge">(try try)</code>, either returns <code class="highlighter-rouge">halted</code> or runs forever.</p>

<ol>
  <li><code class="highlighter-rouge">(try try)</code> returns <code class="highlighter-rouge">halted</code>: then it would fall into the <code class="highlighter-rouge">(run-forever)</code> trap. Contradiction.</li>
  <li><code class="highlighter-rouge">(try try)</code> runs forever: then the first condition is false, <code class="highlighter-rouge">halted</code> is returned. Contradiction.</li>
</ol>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/09/sicp-4-1-6-4-1-7" rel="next" title="sicp-4-1-6-4-1-7">sicp-4-1-6-4-1-7</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/06/sicp-4-1" rel="previous" title="sicp-4-1">sicp-4-1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-4-1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-4-1" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-4-1</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-06 00:51:11 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="41">4.1</h4>

<p>It takes me several minutes to really understand the quanstion. :(</p>

<p>It really only has something to do with the order of the parameter evaluation.
To restrict the order, the parameters passed in to <code class="highlighter-rouge">cons</code> should be taken out
explicitly before being used.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">list-of-values-left-right</span> <span class="nv">exps</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">no-operands</span> <span class="nv">exps</span><span class="p">)</span>
    <span class="o">'</span><span class="p">()</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">left</span> <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nf">first-operand</span> <span class="nv">exps</span><span class="p">)</span> <span class="nv">env</span><span class="p">)))</span>
      <span class="p">(</span><span class="nb">cons</span> <span class="nv">left</span>
            <span class="p">(</span><span class="nf">list-of-values-left-right</span> <span class="p">(</span><span class="nf">rest-operands</span> <span class="nv">exps</span><span class="p">)</span> <span class="nv">env</span><span class="p">)))))</span></code></pre></figure>

<h4 id="42">4.2</h4>

<blockquote>
  <p>A procedure application is any compound expression that is not one of the above expression types. The car of the expression is the operator, and the cdr is the list of operands</p>
</blockquote>

<p>The problem lies in the way to determain a procedure which is much too simple.</p>

<p>If it is put at the very beginning, then <code class="highlighter-rouge">(define x 3)</code> would be recognized as a procedure, the operator of which is
<code class="highlighter-rouge">define</code> and the operands are <code class="highlighter-rouge">x</code> and <code class="highlighter-rouge">3</code>. But at that time, there is no procedure called <code class="highlighter-rouge">define</code> at all.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">application?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">exp</span> <span class="ss">'call</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">operator</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">exp</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">operands</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">cddr</span> <span class="nv">exp</span><span class="p">))</span></code></pre></figure>

<h4 id="44">4.4</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">((</span><span class="nf">and?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">eval-and</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>
<span class="p">((</span><span class="nf">or?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">eval-or</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">and?</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">exp</span> <span class="ss">'and</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">eval-and</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">eval-and-operands</span> <span class="nv">operands</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">operands</span><span class="p">)</span> <span class="nv">false</span><span class="p">)</span>
          <span class="p">((</span><span class="nf">true?</span> <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">operands</span><span class="p">)</span> <span class="nv">env</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">eval-and-operands</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">operands</span><span class="p">)))</span>
          <span class="p">(</span><span class="k">else</span> <span class="nv">false</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">eval-and-operands</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">exp</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">or?</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">exp</span> <span class="ss">'or</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">eval-or</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">eval-or-operands</span> <span class="nv">operands</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">operands</span><span class="p">)</span> <span class="nv">false</span><span class="p">)</span>
          <span class="p">((</span><span class="nf">true?</span> <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">operands</span><span class="p">)</span> <span class="nv">env</span><span class="p">))</span>
           <span class="nv">true</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nf">eval-or-operands</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">operands</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">eval-or-operands</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">exp</span><span class="p">)))</span>

<span class="c1">;derived version</span>
<span class="p">((</span><span class="nf">and?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nf">and-&gt;if</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">))</span>
<span class="p">((</span><span class="nf">or?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nf">or-&gt;if</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">and?</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">exp</span> <span class="ss">'and</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">and-clauses</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">exp</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">expand-and-clauses</span> <span class="nv">clauses</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">clauses</span><span class="p">)</span>
      <span class="ss">'true</span>
      <span class="p">(</span><span class="nf">make-if</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">clauses</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">expand-and-clauses</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">clauses</span><span class="p">))</span>
               <span class="ss">'false</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">and-&gt;if</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">expand-and-clauses</span> <span class="p">(</span><span class="nf">and-clauses</span> <span class="nv">exp</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">or?</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">exp</span> <span class="ss">'or</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">or-clauses</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">exp</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">expand-or-clauses</span> <span class="nv">clauses</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">clauses</span><span class="p">)</span>
      <span class="ss">'false</span>
      <span class="p">(</span><span class="nf">make-if</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">clauses</span><span class="p">)</span>
               <span class="ss">'true</span>
               <span class="p">(</span><span class="nf">expand-or-clauses</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">clauses</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">or-&gt;if</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">expand-or-clauses</span> <span class="p">(</span><span class="nf">or-clauses</span> <span class="nv">exp</span><span class="p">)))</span></code></pre></figure>

<p>The tricky thing is the type of the return value.
For <code class="highlighter-rouge">derived</code> expression, the returned type is some data,
while for other kinds, it would return some code.</p>

<h4 id="45">4.5</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">expand-clauses</span> <span class="nv">clauses</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">clauses</span><span class="p">)</span>
    <span class="ss">'false</span>                          <span class="c1">; no else clause</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">first</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">clauses</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">rest</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">clauses</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">cond-else-clause?</span> <span class="nv">first</span><span class="p">)</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">rest</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">sequence-&gt;exp</span> <span class="p">(</span><span class="nf">cond-actions</span> <span class="nv">first</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">error</span> <span class="s">"ELSE clause isn't last -- COND-&gt;IF"</span> <span class="nv">clauses</span><span class="p">))</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">test</span> <span class="p">(</span><span class="nf">cond-predicate</span> <span class="nv">first</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">recepient</span> <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nf">cond-actions</span> <span class="nv">first</span><span class="p">))</span> <span class="ss">'=&gt;</span><span class="p">)</span>
                           <span class="p">(</span><span class="nb">cadr</span> <span class="p">(</span><span class="nf">cond-actions</span> <span class="nv">first</span><span class="p">))</span>
                           <span class="nv">false</span><span class="p">)))</span>
          <span class="p">(</span><span class="nf">make-if</span> <span class="nv">test</span>
                  <span class="p">(</span><span class="k">if</span> <span class="nv">recepient</span>
                    <span class="p">(</span><span class="nb">list</span> <span class="nv">recepient</span> <span class="nv">test</span><span class="p">)</span> <span class="c1">;test-recepient cond</span>
                    <span class="p">(</span><span class="nf">sequence-&gt;exp</span> <span class="p">(</span><span class="nf">cond-actions</span> <span class="nv">first</span><span class="p">)))</span> <span class="c1">;normal cond</span>
                  <span class="p">(</span><span class="nf">expand-clauses</span> <span class="nv">rest</span><span class="p">)))))))</span></code></pre></figure>

<h4 id="46">4.6</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"> <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let?</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">expr</span> <span class="ss">'let</span><span class="p">))</span>
 <span class="p">(</span><span class="k">define</span> <span class="nv">let-associations</span> <span class="nv">cadr</span><span class="p">)</span>
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let-vars</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">car</span> <span class="p">(</span><span class="nf">let-associations</span> <span class="nv">expr</span><span class="p">)))</span>
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let-value</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">cadr</span> <span class="p">(</span><span class="nf">let-associations</span> <span class="nv">expr</span><span class="p">)))</span>
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let-body</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nb">cddr</span> <span class="nv">expr</span><span class="p">))</span>
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let-&gt;combination</span> <span class="nv">expr</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">make-lambda</span> <span class="p">(</span><span class="nf">let-vars</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nf">let-body</span> <span class="nv">expr</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">let-value</span> <span class="nv">expr</span><span class="p">)))</span></code></pre></figure>

<h4 id="47">4.7</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"> <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let*?</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">expr</span> <span class="ss">'let*</span><span class="p">))</span>
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let*-body</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">expr</span><span class="p">))</span>
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let*-inits</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">expr</span><span class="p">))</span>
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let*-&gt;nested-lets</span> <span class="nv">expr</span><span class="p">)</span>
   <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">inits</span> <span class="p">(</span><span class="nf">let*-inits</span> <span class="nv">expr</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">body</span> <span class="p">(</span><span class="nf">let*-body</span> <span class="nv">expr</span><span class="p">)))</span>
     <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-lets</span> <span class="nv">exprs</span><span class="p">)</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">exprs</span><span class="p">)</span>
         <span class="nv">body</span>
         <span class="p">(</span><span class="nb">list</span> <span class="ss">'let</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">exprs</span><span class="p">))</span> <span class="p">(</span><span class="nf">make-lets</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">exprs</span><span class="p">)))))</span>
     <span class="p">(</span><span class="nf">make-lets</span> <span class="nv">inits</span><span class="p">)))</span></code></pre></figure>

<h4 id="48">4.8</h4>

<p>It should be transformed like this.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fib</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fib-iter</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">count</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">count</span> <span class="mi">0</span><span class="p">)</span>
      <span class="nv">b</span>
      <span class="p">(</span><span class="nf">fib-iter</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">count</span> <span class="mi">1</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">fib-iter</span> <span class="mi">1</span> <span class="mi">0</span> <span class="nv">n</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"> <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">named-let-&gt;func</span> <span class="nv">expr</span><span class="p">)</span> 
     <span class="p">(</span><span class="nb">list</span> <span class="ss">'define</span>  
           <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">named-let-func-name</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nf">named-let-func-parameters</span> <span class="nv">expr</span><span class="p">))</span> 
           <span class="p">(</span><span class="nf">named-let-func-body</span> <span class="nv">expr</span><span class="p">)))</span> 
  
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">let-&gt;combination</span> <span class="nv">expr</span><span class="p">)</span> 
     <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">named-let?</span> <span class="nv">expr</span><span class="p">)</span> 
         <span class="p">(</span><span class="nf">sequence-&gt;exp</span> 
           <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">named-let-&gt;func</span> <span class="nv">expr</span><span class="p">)</span> 
                 <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">named-let-func-name</span> <span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nf">named-let-func-inits</span> <span class="nv">expr</span><span class="p">))))</span> 
         <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">make-lambda</span> <span class="p">(</span><span class="nf">let-vars</span> <span class="nv">expr</span><span class="p">)</span> 
               <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">let-body</span> <span class="nv">expr</span><span class="p">)))</span> 
               <span class="p">(</span><span class="nf">let-inits</span> <span class="nv">expr</span><span class="p">))))</span> </code></pre></figure>

<h4 id="49">4.9</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">while-&gt;combination</span> <span class="nv">expr</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">sequence-&gt;exp</span>
    <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'define</span>
                <span class="p">(</span><span class="nb">list</span> <span class="ss">'while-iter</span><span class="p">)</span>
                <span class="p">(</span><span class="nf">make-if</span> <span class="p">(</span><span class="nf">while-condition</span> <span class="nv">expr</span><span class="p">)</span>
                         <span class="p">(</span><span class="nf">sequence-&gt;exp</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">while-body</span> <span class="nv">expr</span><span class="p">)</span>
                                              <span class="p">(</span><span class="nb">list</span> <span class="ss">'while-iter</span><span class="p">)))</span>
                         <span class="ss">'true</span><span class="p">))</span>
          <span class="p">(</span><span class="nb">list</span> <span class="ss">'while-iter</span><span class="p">))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/06/sicp-4-1-3-4-1-5" rel="next" title="sicp-4-1-3-4-1-5">sicp-4-1-3-4-1-5</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/05/sicp-3-5-4-3-5-5" rel="previous" title="sicp-3-5-4-3-5-5">sicp-3-5-4-3-5-5</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-5-4-3-5-5 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-5-4-3-5-5" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-5-4-3-5-5</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-05 06:11:43 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="377">3.77</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"> <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">integral</span> <span class="nv">delayed-integrand</span> <span class="nv">initial-value</span> <span class="nv">dt</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">cons-stream</span>
     <span class="nv">initial-value</span>
     <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">integrand</span> <span class="p">(</span><span class="nb">force</span> <span class="nv">delayed-integrand</span><span class="p">)))</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">stream-null?</span> <span class="nv">integrand</span><span class="p">)</span>
         <span class="nv">the-empty-stream</span>
         <span class="p">(</span><span class="nf">integral</span>
           <span class="p">(</span><span class="k">delay</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">integrand</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">dt</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">integrand</span><span class="p">))</span> <span class="nv">initial-value</span><span class="p">)</span>
           <span class="nv">dt</span><span class="p">)))))</span></code></pre></figure>

<h4 id="378">3.78</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"> <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">integral</span> <span class="nv">delayed-integrand</span> <span class="nv">initial-value</span> <span class="nv">dt</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">cons-stream</span>
     <span class="nv">initial-value</span>
     <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">integrand</span> <span class="p">(</span><span class="nb">force</span> <span class="nv">delayed-integrand</span><span class="p">)))</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">stream-null?</span> <span class="nv">integrand</span><span class="p">)</span>
         <span class="nv">the-empty-stream</span>
         <span class="p">(</span><span class="nf">integral</span>
           <span class="p">(</span><span class="k">delay</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">integrand</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">dt</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">integrand</span><span class="p">))</span> <span class="nv">initial-value</span><span class="p">)</span>
           <span class="nv">dt</span><span class="p">)))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">solve-2nd</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">dt</span> <span class="nv">y0</span> <span class="nv">dy0</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="nv">y</span> <span class="p">(</span><span class="nf">integral</span> <span class="p">(</span><span class="k">delay</span> <span class="nv">dy</span><span class="p">)</span> <span class="nv">y0</span> <span class="nv">dt</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="nv">dy</span> <span class="p">(</span><span class="nf">integral</span> <span class="p">(</span><span class="k">delay</span> <span class="nv">ddy</span><span class="p">)</span> <span class="nv">dy0</span> <span class="nv">dt</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="nv">ddy</span>
    <span class="p">(</span><span class="nf">add-streams</span>
      <span class="p">(</span><span class="nf">scale-stream</span> <span class="nv">dy</span> <span class="nv">a</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">scale-stream</span> <span class="nv">y</span> <span class="nv">b</span><span class="p">)))</span>
  <span class="nv">y</span><span class="p">)</span></code></pre></figure>

<h4 id="379">3.79</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"> <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">general-solve-2nd</span> <span class="nv">f</span> <span class="nv">y0</span> <span class="nv">dy0</span> <span class="nv">dt</span><span class="p">)</span>
   <span class="p">(</span><span class="k">define</span> <span class="nv">y</span> <span class="p">(</span><span class="nf">integral</span> <span class="p">(</span><span class="k">delay</span> <span class="nv">dy</span><span class="p">)</span> <span class="nv">y0</span> <span class="nv">dt</span><span class="p">))</span>
   <span class="p">(</span><span class="k">define</span> <span class="nv">dy</span> <span class="p">(</span><span class="nf">integral</span> <span class="p">(</span><span class="k">delay</span> <span class="nv">ddy</span><span class="p">)</span> <span class="nv">dy0</span> <span class="nv">dt</span><span class="p">))</span>
   <span class="p">(</span><span class="k">define</span> <span class="nv">ddy</span> <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">f</span> <span class="nv">dy</span> <span class="nv">y</span><span class="p">))</span>
   <span class="nv">y</span><span class="p">)</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/06/sicp-4-1" rel="next" title="sicp-4-1">sicp-4-1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/03/sicp-3-5-3" rel="previous" title="sicp-3-5-3">sicp-3-5-3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-5-3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-5-3" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-5-3</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-03 22:24:29 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="363">3.63</h4>

<p><code class="highlighter-rouge">guess</code> is used to share the computation result between the succssive calling.
Otherwise each call to <code class="highlighter-rouge">sqrt-stream x</code> would require recursively calling.</p>

<p>If <code class="highlighter-rouge">memo-proc</code> is not used, these two versions would be the same efficiency.</p>

<h4 id="364">3.64</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">stream-limit</span> <span class="nv">s</span> <span class="nv">tolerance</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">s2</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">abs</span>
             <span class="p">(</span><span class="nb">-</span>
               <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s2</span><span class="p">)))</span>
           <span class="nv">tolerance</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s2</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">stream-limit</span> <span class="nv">s2</span> <span class="nv">tolerance</span><span class="p">))))</span></code></pre></figure>

<h4 id="365">3.65</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">euler-transform</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">s0</span> <span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">s</span> <span class="mi">0</span><span class="p">))</span>           <span class="c1">; Sn-1</span>
        <span class="p">(</span><span class="nf">s1</span> <span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">s</span> <span class="mi">1</span><span class="p">))</span>           <span class="c1">; Sn</span>
        <span class="p">(</span><span class="nf">s2</span> <span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">s</span> <span class="mi">2</span><span class="p">)))</span>          <span class="c1">; Sn+1</span>
    <span class="p">(</span><span class="nf">cons-stream</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">s2</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">s2</span> <span class="nv">s1</span><span class="p">))</span>
                          <span class="p">(</span><span class="nb">+</span> <span class="nv">s0</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">-2</span> <span class="nv">s1</span><span class="p">)</span> <span class="nv">s2</span><span class="p">)))</span>
                 <span class="p">(</span><span class="nf">euler-transform</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-tableau</span> <span class="nv">transform</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cons-stream</span> <span class="nv">s</span>
               <span class="p">(</span><span class="nf">make-tableau</span> <span class="nv">transform</span>
                             <span class="p">(</span><span class="nf">transform</span> <span class="nv">s</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accelerated-sequence</span> <span class="nv">transform</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">stream-car</span>
              <span class="p">(</span><span class="nf">make-tableau</span> <span class="nv">transform</span> <span class="nv">s</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">log2-summands</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cons-stream</span> <span class="p">(</span><span class="nb">/</span> <span class="mf">1.0</span> <span class="nv">n</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">-</span> <span class="p">(</span><span class="nf">log2-summands</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">log2-stream</span>
  <span class="p">(</span><span class="nf">partial-sums</span> <span class="p">(</span><span class="nf">log2-summands</span> <span class="mi">1</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">stream-limit</span>
  <span class="p">(</span><span class="nf">accelerated-sequence</span> <span class="nv">euler-transform</span> <span class="nv">log2-stream</span><span class="p">)</span> <span class="mf">0.0001</span><span class="p">)</span></code></pre></figure>

<h4 id="366">3.66</h4>

<table>
  <thead>
    <tr>
      <th>1</th>
      <th>2</th>
      <th>4</th>
      <th>6</th>
      <th>8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td>3</td>
      <td>5</td>
      <td>9</td>
      <td>13</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td>7</td>
      <td>11</td>
      <td>19</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>15</td>
      <td>23</td>
    </tr>
  </tbody>
</table>

<p>The order to traverse the pair is listed as above.
Some observations:</p>

<p>$(i,i)=2^i-1$</p>

<p>$(i, i + 1) = 3*2^{i-1}-1$</p>

<p>$(i, k) = 3*2^{i-1}-1 + (k- i - 1) * 2^i$</p>

<h4 id="367">3.67</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">pairs</span> <span class="nv">s</span> <span class="nv">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cons-stream</span>
   <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">t</span><span class="p">))</span>
   <span class="p">(</span><span class="nf">interleave</span>
     <span class="p">(</span><span class="nf">interleave</span>
       <span class="p">(</span><span class="nf">stream-map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>
                   <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">t</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">stream-map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">t</span><span class="p">)))</span>
                   <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)))</span>
     <span class="p">(</span><span class="nf">pairs</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">t</span><span class="p">)))))</span></code></pre></figure>

<h4 id="368">3.68</h4>

<p>Only the <code class="highlighter-rouge">cons-stream</code> is a normal-order function, while <code class="highlighter-rouge">interleave</code> is not.
When <code class="highlighter-rouge">interleave</code> evaluate its two parameters, which includes <code class="highlighter-rouge">pair</code>, would lead to
infinite loop.</p>

<h4 id="369">3.69</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">triples</span> <span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">s3</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cons-stream</span>
    <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s1</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s2</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s3</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">interleave</span>
      <span class="p">(</span><span class="nf">stream-map</span>
        <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s1</span><span class="p">))</span>
                            <span class="nv">x</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">stream-cdr</span>
          <span class="p">(</span><span class="nf">pair</span> <span class="nv">s2</span> <span class="nv">s3</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">triples</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s1</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s2</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s3</span><span class="p">)))))</span></code></pre></figure>

<h4 id="370">3.70</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">merge-weighted</span> <span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">weight</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">stream-null?</span> <span class="nv">s1</span><span class="p">)</span> <span class="nv">s2</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">stream-null?</span> <span class="nv">s2</span><span class="p">)</span> <span class="nv">s1</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">s1car</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s1</span><span class="p">))</span>
                <span class="p">(</span><span class="nf">s2car</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s2</span><span class="p">)))</span>
            <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;=</span> <span class="p">(</span><span class="nf">weight</span> <span class="nv">s1car</span><span class="p">)</span>
                    <span class="p">(</span><span class="nf">weight</span> <span class="nv">s2car</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">cons-stream</span> <span class="nv">s1car</span>
                           <span class="p">(</span><span class="nf">merge-weighted</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s1</span><span class="p">)</span>
                                           <span class="nv">s2</span>
                                           <span class="nv">weight</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">cons-stream</span> <span class="nv">s2car</span>
                           <span class="p">(</span><span class="nf">merge-weighted</span> <span class="nv">s1</span>
                                           <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s2</span><span class="p">)</span>
                                           <span class="nv">weight</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">weighted-pairs</span> <span class="nv">s</span> <span class="nv">t</span> <span class="nv">weight</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cons-stream</span>
    <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">t</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">merge-weighted</span>
      <span class="p">(</span><span class="nf">stream-map</span>
        <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">t</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">weighted-pairs</span>
        <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">t</span><span class="p">)</span>
        <span class="nv">weight</span><span class="p">)</span>
      <span class="nv">weight</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">weighted-pairs</span> <span class="nv">integers</span>
                <span class="nv">integers</span>
                <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
                  <span class="p">(</span><span class="nb">apply</span> <span class="nv">+</span> <span class="nv">x</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">no-factors</span>
  <span class="p">(</span><span class="nf">stream-filter</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">not</span>
        <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nf">divides?</span> <span class="nv">x</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">divides?</span> <span class="nv">x</span> <span class="mi">3</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">divides?</span> <span class="nv">x</span> <span class="mi">5</span><span class="p">))))</span>
    <span class="nv">integers</span><span class="p">))</span>

<span class="p">(</span><span class="nf">weighted-pairs</span> <span class="nv">no-factors</span>
                <span class="nv">no-factors</span>
                <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">lst</span><span class="p">)</span>
                  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">i</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lst</span><span class="p">))</span>
                        <span class="p">(</span><span class="nf">j</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">lst</span><span class="p">)))</span>
                    <span class="p">(</span><span class="nb">+</span>
                      <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span> <span class="nv">i</span><span class="p">)</span>
                      <span class="p">(</span><span class="nb">*</span> <span class="mi">3</span> <span class="nv">j</span><span class="p">)</span>
                      <span class="p">(</span><span class="nb">*</span> <span class="mi">5</span> <span class="nv">i</span> <span class="nv">j</span><span class="p">)))))</span></code></pre></figure>

<h4 id="371">3.71</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum-cube</span> <span class="nv">pair</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">i</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">pair</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">j</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">pair</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">i</span> <span class="nv">i</span> <span class="nv">i</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">*</span> <span class="nv">j</span> <span class="nv">j</span> <span class="nv">j</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">all-pairs</span>
  <span class="p">(</span><span class="nf">weighted-pairs</span> <span class="nv">integers</span> <span class="nv">integers</span> <span class="nv">sum-cube</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">ram-numbers</span> <span class="nv">stream</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nf">w1</span> <span class="p">(</span><span class="nf">sum-cube</span>
               <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">stream</span><span class="p">)))</span>
         <span class="p">(</span><span class="nf">rest</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">stream</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">w2</span> <span class="p">(</span><span class="nf">sum-cube</span>
               <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">rest</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">w1</span> <span class="nv">w2</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">cons-stream</span> <span class="nv">w1</span>
                   <span class="p">(</span><span class="nf">ram-numbers</span> <span class="p">(</span><span class="nf">stream-cdr</span>
                                  <span class="nv">rest</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">ram-numbers</span> <span class="nv">rest</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">show-stream</span> <span class="p">(</span><span class="nf">ram-numbers</span> <span class="nv">all-pairs</span><span class="p">)</span> <span class="mi">6</span><span class="p">)</span></code></pre></figure>

<h4 id="373">3.73</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">RC</span> <span class="nv">r</span> <span class="nv">c</span> <span class="nv">dt</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">i</span> <span class="nv">v</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">add-streams</span>
      <span class="p">(</span><span class="nf">scale-stream</span> <span class="nv">i</span> <span class="nv">r</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">integral</span> <span class="p">(</span><span class="nf">scale-stream</span> <span class="nv">i</span>
                              <span class="p">(</span><span class="nb">/</span> <span class="mi">1</span> <span class="nv">c</span><span class="p">))</span>
                <span class="nv">v</span>
                <span class="nv">dt</span><span class="p">))))</span></code></pre></figure>

<h4 id="374">3.74</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">zero-crossings</span>
  <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">sign-change-detector</span> <span class="nv">sense-data</span>
              <span class="p">(</span><span class="nf">cons-stream</span> <span class="mi">0</span> <span class="nv">sense-data</span><span class="p">)))</span></code></pre></figure>

<h4 id="375">3.75</h4>

<p>The last value of the origin stream should be passed in, otherwise <code class="highlighter-rouge">avpt</code>
would acutally become a recursive version.</p>

<h4 id="376">3.76</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">smooth</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">stream-map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">cons-stream</span> <span class="mi">0</span> <span class="nv">s</span><span class="p">)</span>
              <span class="nv">s</span><span class="p">))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/05/sicp-3-5-4-3-5-5" rel="next" title="sicp-3-5-4-3-5-5">sicp-3-5-4-3-5-5</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/02/sicp-3-5-1-3-5-2" rel="previous" title="sicp-3-5-1-3-5-2">sicp-3-5-1-3-5-2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-5-1-3-5-2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-5-1-3-5-2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-5-1-3-5-2</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-02 20:24:25 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>Code from the text.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">s</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">stream-ref</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">proc</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">stream-null?</span> <span class="nv">s</span><span class="p">)</span>
      <span class="nv">the-empty-stream</span>
      <span class="p">(</span><span class="nf">cons-stream</span> <span class="p">(</span><span class="nf">proc</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s</span><span class="p">))</span>
                   <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">proc</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">stream-for-each</span> <span class="nv">proc</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">stream-null?</span> <span class="nv">s</span><span class="p">)</span>
      <span class="ss">'done</span>
      <span class="p">(</span><span class="k">begin</span> <span class="p">(</span><span class="nf">proc</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">stream-for-each</span> <span class="nv">proc</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">display-stream</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">stream-for-each</span> <span class="nv">display-line</span> <span class="nv">s</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">display-line</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">newline</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">display</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">stream</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">stream</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">stream</span><span class="p">)</span> <span class="p">(</span><span class="nb">force</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">stream</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">stream-enumerate-interval</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">)</span>
      <span class="nv">the-empty-stream</span>
      <span class="p">(</span><span class="nf">cons-stream</span>
       <span class="nv">low</span>
       <span class="p">(</span><span class="nf">stream-enumerate-interval</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">low</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">high</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">stream-filter</span> <span class="nv">pred</span> <span class="nv">stream</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">stream-null?</span> <span class="nv">stream</span><span class="p">)</span> <span class="nv">the-empty-stream</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">pred</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">stream</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">cons-stream</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">stream</span><span class="p">)</span>
                      <span class="p">(</span><span class="nf">stream-filter</span> <span class="nv">pred</span>
                                     <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">stream</span><span class="p">))))</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">stream-filter</span> <span class="nv">pred</span> <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">stream</span><span class="p">)))))</span>

<span class="p">(</span><span class="nf">stream-ref</span>
   <span class="p">(</span><span class="nf">stream-enumerate-interval</span> <span class="mi">1</span> <span class="mi">100</span><span class="p">)</span>
   <span class="mi">10</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">memo-proc</span> <span class="nv">proc</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">already-run?</span> <span class="nv">false</span><span class="p">)</span> <span class="p">(</span><span class="nf">result</span> <span class="nv">false</span><span class="p">))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="nv">already-run?</span><span class="p">)</span>
          <span class="p">(</span><span class="k">begin</span> <span class="p">(</span><span class="k">set!</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">proc</span><span class="p">))</span>
                 <span class="p">(</span><span class="k">set!</span> <span class="nv">already-run?</span> <span class="nv">true</span><span class="p">)</span>
                 <span class="nv">result</span><span class="p">)</span>
          <span class="nv">result</span><span class="p">))))</span></code></pre></figure>

<h4 id="350">3.50</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">proc</span> <span class="o">.</span> <span class="nv">argstreams</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">argstreams</span><span class="p">))</span>
      <span class="nv">the-empty-stream</span>
      <span class="p">(</span><span class="nf">cons-stream</span>
       <span class="p">(</span><span class="nb">apply</span> <span class="nv">proc</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">stream-car</span> <span class="nv">argstreams</span><span class="p">))</span>
       <span class="p">(</span><span class="nb">apply</span> <span class="nv">stream-map</span>
              <span class="p">(</span><span class="nb">cons</span> <span class="nv">proc</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">stream-cdr</span> <span class="nv">argstreams</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">s1</span> <span class="p">(</span><span class="nf">stream-enumerate-interval</span> <span class="mi">10</span> <span class="mi">100</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">s2</span> <span class="p">(</span><span class="nf">stream-enumerate-interval</span> <span class="mi">20</span> <span class="mi">200</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">s3</span> <span class="p">(</span><span class="nf">stream-enumerate-interval</span> <span class="mi">30</span> <span class="mi">300</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">test</span> <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">+</span> <span class="nv">s1</span> <span class="nv">s2</span> <span class="nv">s3</span><span class="p">))</span>
<span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">test</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">test</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">test</span> <span class="mi">2</span><span class="p">)</span></code></pre></figure>

<h4 id="351">3.51</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">show</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">display-line</span> <span class="nv">x</span><span class="p">)</span>
  <span class="nv">x</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">show</span> <span class="p">(</span><span class="nf">stream-enumerate-interval</span> <span class="mi">0</span> <span class="mi">10</span><span class="p">)))</span>
<span class="mi">0</span>
<span class="c1">;Value: x</span>
<span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">x</span> <span class="mi">5</span><span class="p">)</span>

<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">5</span>

<span class="c1">;Value: 5</span>

<span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">x</span> <span class="mi">7</span><span class="p">)</span>

<span class="mi">6</span>
<span class="mi">7</span>
<span class="c1">;Value: 7</span></code></pre></figure>

<p>It is confusing for me to understand this  <code class="highlighter-rouge">memo-proc</code> function.
All the <code class="highlighter-rouge">delayed</code> functions are cached after the first running.</p>

<h4 id="352">3.52</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">sum</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accum</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">set!</span> <span class="nv">sum</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="nv">sum</span><span class="p">))</span>
  <span class="nv">sum</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">seq</span> <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">accum</span> <span class="p">(</span><span class="nf">stream-enumerate-interval</span> <span class="mi">1</span> <span class="mi">20</span><span class="p">)))</span>
<span class="c1">; sum = 1</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">y</span> <span class="p">(</span><span class="nf">stream-filter</span> <span class="nv">even?</span> <span class="nv">seq</span><span class="p">))</span>
<span class="c1">; sum = 6</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">z</span> <span class="p">(</span><span class="nf">stream-filter</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">remainder</span> <span class="nv">x</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
                         <span class="nv">seq</span><span class="p">))</span>
<span class="c1">; sum = 10</span>

<span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">y</span> <span class="mi">7</span><span class="p">)</span>
<span class="c1">;Value: 136</span>

<span class="p">(</span><span class="nf">display-stream</span> <span class="nv">z</span><span class="p">)</span>
<span class="c1">; 10</span>
<span class="c1">; 15</span>
<span class="c1">; 45</span>
<span class="c1">; 55</span>
<span class="c1">; 105</span>
<span class="c1">; 120</span>
<span class="c1">; 190</span>
<span class="c1">; 210</span>
<span class="c1">; sum = 210</span></code></pre></figure>

<p><code class="highlighter-rouge">sum</code> acts as a global value, which is a bad idea in the stream.
When the <code class="highlighter-rouge">delay</code> is <code class="highlighter-rouge">memorized</code>, <code class="highlighter-rouge">seq</code> is the same no matter how many times it is called.</p>

<p>If the <code class="highlighter-rouge">non-memorized</code> version is used, then <code class="highlighter-rouge">seq</code> would have different result
because of the sharing <code class="highlighter-rouge">sum</code>.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">sum</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accum</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">set!</span> <span class="nv">sum</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="nv">sum</span><span class="p">))</span>
  <span class="nv">sum</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">seq</span> <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">accum</span> <span class="p">(</span><span class="nf">stream-enumerate-interval</span> <span class="mi">1</span> <span class="mi">20</span><span class="p">)))</span>
<span class="c1">;seq=(1, (accum 2), (accum 3)...(accum 20))</span>
<span class="c1">;sum=1</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">y</span> <span class="p">(</span><span class="nf">stream-filter</span> <span class="nv">even?</span> <span class="nv">seq</span><span class="p">))</span>
<span class="c1">;y=(6, (stream-filter even? ((accum 4), (accum 5), ...)))</span>
<span class="c1">;sum=6</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">z</span> <span class="p">(</span><span class="nf">stream-filter</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">remainder</span> <span class="nv">x</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
                         <span class="nv">seq</span><span class="p">))</span>
<span class="c1">;z=(15, (stream-filter (lambda (x) (...)) ((accum 5) ...)))</span>
<span class="c1">;sum=15</span>

<span class="p">(</span><span class="nf">stream-ref</span> <span class="nv">y</span> <span class="mi">7</span><span class="p">)</span>
<span class="c1">;y=(6, 24, 30, 54,...)</span></code></pre></figure>

<h4 id="353">3.53</h4>

<p>(1 2 4 8 16 32 …)</p>

<h4 id="354">3.54</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">mul-streams</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">*</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">factorials</span>
  <span class="p">(</span><span class="nf">cons-stream</span> <span class="mi">1</span> <span class="p">(</span><span class="nf">mul-streams</span>
                  <span class="nv">factorials</span>
                  <span class="p">(</span><span class="nf">integers-starting-from</span> <span class="mi">2</span><span class="p">))))</span></code></pre></figure>

<h4 id="355">3.55</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">partial-sum</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cons-stream</span>
    <span class="p">(</span><span class="nb">car</span> <span class="nv">s</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">add-streams</span>
      <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">partial-sum</span> <span class="nv">s</span><span class="p">))))</span></code></pre></figure>

<h4 id="356">3.56</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">S</span>
  <span class="p">(</span><span class="nf">cons-stream</span>
   <span class="mi">1</span> <span class="p">(</span><span class="nf">merge</span> <span class="p">(</span><span class="nf">scale-stream</span> <span class="nv">S</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">merge</span> <span class="p">(</span><span class="nf">scale-stream</span> <span class="nv">S</span> <span class="mi">3</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">scale-stream</span> <span class="nv">S</span> <span class="mi">5</span><span class="p">)))))</span></code></pre></figure>

<h4 id="357">3.57</h4>
<p><code class="highlighter-rouge">memorized</code> version is $O(n)$ while naive version is $O(2^n)$</p>

<h4 id="358">3.58</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">expand</span> <span class="nv">num</span> <span class="nv">den</span> <span class="nv">radix</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cons-stream</span>
   <span class="p">(</span><span class="nb">quotient</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">num</span> <span class="nv">radix</span><span class="p">)</span> <span class="nv">den</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">expand</span> <span class="p">(</span><span class="nb">remainder</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">num</span> <span class="nv">radix</span><span class="p">)</span> <span class="nv">den</span><span class="p">)</span> <span class="nv">den</span> <span class="nv">radix</span><span class="p">)))</span></code></pre></figure>

<p>It is long divide.</p>

<h4 id="359">3.59</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">integrate-series</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">stream-map</span> <span class="nv">/</span> <span class="nv">s</span> <span class="nv">integers</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">sine-series</span>
  <span class="p">(</span><span class="nf">cons-stream</span> <span class="mi">0</span> <span class="p">(</span><span class="nf">integrate-series</span> <span class="nv">cosine-series</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">cosine-series</span>
  <span class="p">(</span><span class="nf">cons-stream</span> <span class="mi">1</span>
               <span class="p">(</span><span class="nf">scale-stream</span>
                 <span class="p">(</span><span class="nf">integrate-series</span> <span class="nv">sine-series</span><span class="p">)</span>
                 <span class="mi">-1</span><span class="p">))</span></code></pre></figure>

<h4 id="360">3.60</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">mul-series</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cons-stream</span>
    <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s2</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">add-streams</span>
      <span class="p">(</span><span class="nf">scale-stream</span>
        <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s2</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">s1</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">mul-series</span>
        <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s1</span><span class="p">)</span>
        <span class="nv">s2</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">t</span>
  <span class="p">(</span><span class="nf">add-streams</span>
    <span class="p">(</span><span class="nf">mul-series</span> <span class="nv">sine-series</span> <span class="nv">sine-series</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">mul-series</span> <span class="nv">cosine-series</span> <span class="nv">cosine-series</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">display-stream</span> <span class="nv">t</span><span class="p">)</span></code></pre></figure>

<p>$(h1 + tail1) * (h2 + tail2) = h1 * h2 + h1<em>tail2 + tail1</em>(h2+tail2)$</p>

<h4 id="361">3.61</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">invert-unit-series</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cons-stream</span> <span class="mi">1</span>
               <span class="p">(</span><span class="nf">scale-stream</span>
                 <span class="p">(</span><span class="nf">mul-series</span>
                   <span class="p">(</span><span class="nf">stream-cdr</span> <span class="nv">s</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">invert-unit-series</span> <span class="nv">s</span><span class="p">)))))</span></code></pre></figure>

<h4 id="362">3.62</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">div-series</span> <span class="nv">num</span> <span class="nv">den</span><span class="p">)</span>
   <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">den0</span> <span class="p">(</span><span class="nf">stream-car</span> <span class="nv">den</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">den-const</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">error</span> <span class="s">"The constant term of the denominator must be nonzero"</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">scale-stream</span>
         <span class="p">(</span><span class="nf">mul-series</span>
          <span class="nv">num</span> <span class="p">(</span><span class="nf">invert-unit-series</span>
                <span class="p">(</span><span class="nf">scale-stream</span> <span class="nv">den</span> <span class="p">(</span><span class="nb">/</span> <span class="mi">1</span> <span class="nv">den-const</span><span class="p">))))</span>
         <span class="p">(</span><span class="nb">/</span> <span class="mi">1</span> <span class="nv">den-const</span><span class="p">)))))</span></code></pre></figure>

<p>The <code class="highlighter-rouge">den</code> should be normalized to have the $constant=1$</p>

	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/03/sicp-3-5-3" rel="next" title="sicp-3-5-3">sicp-3-5-3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/02/sicp-3-4" rel="previous" title="sicp-3-4">sicp-3-4</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-4 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-4" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-4</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-02 01:03:22 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="339">3.39</h4>

<ol>
  <li>101: P1 , P2</li>
  <li>121: P2, P1</li>
  <li>100: P1 computes <code class="highlighter-rouge">(* x x)</code>, then P2 completes and sets x to 101, then P1 executes the assignment.</li>
</ol>

<h4 id="341">3.41</h4>

<p>As <code class="highlighter-rouge">withdraw</code> and <code class="highlighter-rouge">diposit</code> are both single modification operations,
it is not necessary to protect the <code class="highlighter-rouge">balance</code> value, as it would always be valid.</p>

<h4 id="342">3.42</h4>

<p>It seems both of them would work.</p>

<h4 id="343">3.43</h4>

<p>The sum would be kept just because each account is consistent individually.</p>

<h4 id="344">3.44</h4>

<p>Ben is correct.
Exchange requires consitent states for both accounts, while transfer
would be fine as long as the sum of two accounts is correct.</p>

<h4 id="345">3.45</h4>

<p><code class="highlighter-rouge">serialized-exchange</code> has locked both accounts, which makes it impossible to
run <code class="highlighter-rouge">deposit</code> or <code class="highlighter-rouge">withdraw</code>.</p>

<h4 id="346">3.46</h4>

<p>If atomic is not guaranteed, then multiple process can gain the same mutex at the same time which
would result in wrong result.</p>

<h4 id="347">3.47</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-semaphore</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">the-mutex</span> <span class="p">(</span><span class="nf">make-mutex</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">count</span> <span class="mi">0</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">the-semaphore</span> <span class="nv">m</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'acquire</span><span class="p">)</span>
             <span class="p">(</span><span class="nf">the-mutex</span> <span class="ss">'acquire</span><span class="p">)</span>
             <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">count</span> <span class="nv">n</span><span class="p">)</span> <span class="c1">; full, have to wait</span>
               <span class="p">(</span><span class="k">begin</span>
                 <span class="p">(</span><span class="nf">the-mutex</span> <span class="ss">'release</span><span class="p">)</span>
                 <span class="p">(</span><span class="nf">the-semaphore</span> <span class="ss">'acquire</span><span class="p">))</span>
               <span class="p">(</span><span class="k">begin</span>
                 <span class="p">(</span><span class="k">set!</span> <span class="nv">count</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">count</span> <span class="mi">1</span><span class="p">))</span>
                 <span class="p">(</span><span class="nf">the-mutex</span> <span class="ss">'release</span><span class="p">))))</span>
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'release</span><span class="p">)</span>
             <span class="p">(</span><span class="nf">the-mux</span> <span class="ss">'require</span><span class="p">)</span>
             <span class="p">(</span><span class="k">set!</span> <span class="nv">count</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">count</span> <span class="mi">1</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">the-mux</span> <span class="ss">'release</span><span class="p">))))</span>
    <span class="nv">the-semaphore</span><span class="p">))</span></code></pre></figure>

<h4 id="348">3.48</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-account-and-serializer</span> <span class="nv">balance</span> <span class="nv">id</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">withdraw</span> <span class="nv">amount</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;=</span> <span class="nv">balance</span> <span class="nv">amount</span><span class="p">)</span>
        <span class="p">(</span><span class="k">begin</span> <span class="p">(</span><span class="k">set!</span> <span class="nv">balance</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span>
               <span class="nv">balance</span><span class="p">)</span>
        <span class="s">"Insufficient funds"</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deposit</span> <span class="nv">amount</span><span class="p">)</span>
    <span class="p">(</span><span class="k">set!</span> <span class="nv">balance</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span>
    <span class="nv">balance</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">balance-serializer</span> <span class="p">(</span><span class="nf">make-serializer</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">m</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'withdraw</span><span class="p">)</span> <span class="nv">withdraw</span><span class="p">)</span>
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'deposit</span><span class="p">)</span> <span class="nv">deposit</span><span class="p">)</span>
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'balance</span><span class="p">)</span> <span class="nv">balance</span><span class="p">)</span>
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'id</span><span class="p">)</span> <span class="nv">id</span><span class="p">)</span>
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'serializer</span><span class="p">)</span> <span class="nv">balance-serializer</span><span class="p">)</span>
            <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown request -- MAKE-ACCOUNT"</span>
                         <span class="nv">m</span><span class="p">))))</span>
    <span class="nv">dispatch</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">serialized-exchange</span> <span class="nv">account1</span> <span class="nv">account2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">serializer1</span> <span class="p">(</span><span class="nf">account1</span> <span class="ss">'serializer</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">serializer2</span> <span class="p">(</span><span class="nf">account2</span> <span class="ss">'serializer</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">id1</span> <span class="p">((</span><span class="nf">account1</span> <span class="ss">'id1</span><span class="p">)))</span>
        <span class="p">(</span><span class="nf">id2</span> <span class="p">((</span><span class="nf">account1</span> <span class="ss">'id2</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">id1</span> <span class="nv">id2</span><span class="p">))</span>
    <span class="p">((</span><span class="nf">serializer2</span> <span class="p">(</span><span class="nf">serializer1</span> <span class="nv">exchange</span><span class="p">))</span>
     <span class="nv">account1</span>
     <span class="nv">account2</span><span class="p">)</span>
    <span class="p">((</span><span class="nf">serializer1</span> <span class="p">(</span><span class="nf">serializer2</span> <span class="nv">exchange</span><span class="p">))</span>
     <span class="nv">account1</span>
     <span class="nv">account2</span><span class="p">)))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/02/sicp-3-5-1-3-5-2" rel="next" title="sicp-3-5-1-3-5-2">sicp-3-5-1-3-5-2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/01/sicp-3-3-5" rel="previous" title="sicp-3-3-5">sicp-3-3-5</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-3-5 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-3-5" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-3-5</h1>
	<h4 class="large-bottom">
		Posted on 2015-03-01 22:37:18 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="333">3.33</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">average</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">x</span> <span class="p">(</span><span class="nf">make-connector</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">y</span> <span class="p">(</span><span class="nf">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">adder</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">c</span> <span class="nv">v</span> <span class="nv">u</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">constant</span> <span class="mi">2</span> <span class="nv">v</span><span class="p">))</span>
  <span class="ss">'ok</span><span class="p">)</span></code></pre></figure>

<h4 id="334">3.34</h4>

<p>it is only one-directianl computation. Given the value of <code class="highlighter-rouge">b</code>, the value of
<code class="highlighter-rouge">a</code> can not be evaluated, as the multiplier does not know the left two values should be the same.</p>

<h4 id="335">3.35</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">squarer</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">process-new-value</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">has-value?</span> <span class="nv">b</span><span class="p">)</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nf">get-value</span> <span class="nv">b</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">error</span> <span class="s">"square less than 0 -- SQUARER"</span> <span class="p">(</span><span class="nf">get-value</span> <span class="nv">b</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">set-value!</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">sqrt</span> <span class="p">(</span><span class="nf">get-value</span> <span class="nv">b</span><span class="p">))</span> <span class="nv">me</span><span class="p">))</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">has-value?</span> <span class="nv">a</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">set-value!</span> <span class="nv">b</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nf">get-value</span> <span class="nv">a</span><span class="p">))</span> <span class="nv">me</span><span class="p">))))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">process-forget-value</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">forget-value!</span> <span class="nv">b</span> <span class="nv">me</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">forget-value!</span> <span class="nv">a</span> <span class="nv">me</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">me</span> <span class="nv">request</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">request</span> <span class="ss">'I-have-a-value</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">process-new-value</span><span class="p">))</span>
          <span class="p">((</span><span class="nb">eq?</span> <span class="nv">request</span> <span class="ss">'I-lost-my</span> <span class="nv">value</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">process-new-value</span><span class="p">))</span>
          <span class="p">(</span><span class="k">else</span>
            <span class="p">(</span><span class="nf">error</span> <span class="s">"Unkown request  SQUARE"</span> <span class="nv">request</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">connect</span> <span class="nv">a</span> <span class="nv">me</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">connect</span> <span class="nv">b</span> <span class="nv">me</span><span class="p">)</span>
  <span class="nv">me</span><span class="p">)</span></code></pre></figure>

<h4 id="337">3.37</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">c-</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">z</span> <span class="p">(</span><span class="nf">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">adder</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
    <span class="nv">z</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">c*</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">z</span> <span class="p">(</span><span class="nf">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
    <span class="nv">z</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">c/</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">z</span> <span class="p">(</span><span class="nf">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">x</span><span class="p">)</span>
    <span class="nv">z</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cv</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">z</span> <span class="p">(</span><span class="nf">make-connector</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">constant</span> <span class="nv">x</span> <span class="nv">z</span><span class="p">)</span>
    <span class="nv">z</span><span class="p">))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/02/sicp-3-4" rel="next" title="sicp-3-4">sicp-3-4</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/28/sicp-3-3-4" rel="previous" title="sicp-3-3-4">sicp-3-3-4</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-3-4 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-3-4" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-3-4</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-28 07:36:07 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="328">3.28</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">or-gate</span> <span class="nv">a1</span> <span class="nv">a2</span> <span class="nv">output</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="nv">or-action-procedure</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">new-value</span>
            <span class="p">(</span><span class="nf">logical-or</span> <span class="p">(</span><span class="nf">get-signal</span> <span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nf">get-signal</span> <span class="nv">a2</span><span class="p">))))</span>
      <span class="p">(</span><span class="nf">after-delay</span> <span class="nv">or-gate-delay</span>
                   <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
                     <span class="nv">set-signal!</span> <span class="nv">output</span> <span class="nv">new_value</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">add-action!</span> <span class="nv">a1</span> <span class="nv">or-action-procedure</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">add-action!</span> <span class="nv">a2</span> <span class="nv">or-action-procedure</span><span class="p">)</span>
  <span class="ss">'ok</span><span class="p">)</span></code></pre></figure>

<h4 id="329">3.29</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">or-gate</span> <span class="nv">a1</span> <span class="nv">a2</span> <span class="nv">output</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">or-action-procedure</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">not-a1</span> <span class="p">(</span><span class="nf">make-wire</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">not-a2</span> <span class="p">(</span><span class="nf">make-wire</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">b</span> <span class="p">(</span><span class="nf">make-wire</span><span class="p">))</span>
          <span class="p">)</span>
      <span class="p">(</span><span class="nf">inverter</span> <span class="nv">a1</span> <span class="nv">not-a1</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">inverter</span> <span class="nv">a2</span> <span class="nv">not-a2</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">and-gate</span> <span class="nv">not-a1</span> <span class="nv">not-a2</span> <span class="nv">b</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">inverter</span> <span class="nv">b</span> <span class="nv">result</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">add-action!</span> <span class="nv">a1</span> <span class="nv">or-action-procedure</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">add-action!</span> <span class="nv">a2</span> <span class="nv">or-action-procedure</span><span class="p">)</span>
  <span class="ss">'ok</span><span class="p">)</span></code></pre></figure>

<p><code class="highlighter-rouge">2 * inverter + and-gate</code></p>

<h4 id="330">3.30</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">ripple-carry-adder</span> <span class="nv">A</span> <span class="nv">B</span> <span class="nv">S</span> <span class="nv">C</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">c-middle</span> <span class="p">(</span><span class="nf">make-wire</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">A</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">set-signal!</span> <span class="nv">c-middle</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">ripple-carry-adder</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">A</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">B</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">S</span><span class="p">)</span> <span class="nv">c-middle</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">full-adder</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">A</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">B</span><span class="p">)</span> <span class="nv">c-middle</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">S</span><span class="p">)</span> <span class="nv">C</span><span class="p">)))</span></code></pre></figure>

<h4 id="331">3.31</h4>

<p>After calling it immediatly, the initial value of the circuit is propagated.
But there is somoe overhead here, in the <code class="highlighter-rouge">and-date</code> function, both <code class="highlighter-rouge">a1</code> and <code class="highlighter-rouge">a2</code>
will call the <code class="highlighter-rouge">and-function-procedure</code>, there would be two function calls and yield
two same results, one of which will be looked over by the <code class="highlighter-rouge">set-my-signal</code> function.</p>

<h4 id="332">3.32</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-wire</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">signal-value</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">action-procedures</span> <span class="o">'</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">set-my-signal!</span> <span class="nv">new-value</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">signal-value</span> <span class="nv">new-value</span><span class="p">))</span>
          <span class="p">(</span><span class="k">begin</span> <span class="p">(</span><span class="k">set!</span> <span class="nv">signal-value</span> <span class="nv">new-value</span><span class="p">)</span>
                 <span class="p">(</span><span class="nf">call-each</span> <span class="nv">action-procedures</span><span class="p">))</span>
          <span class="ss">'done</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accept-action-procedure!</span> <span class="nv">proc</span><span class="p">)</span>
      <span class="p">(</span><span class="k">set!</span> <span class="nv">action-procedures</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">proc</span> <span class="nv">action-procedures</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">proc</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">m</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'get-signal</span><span class="p">)</span> <span class="nv">signal-value</span><span class="p">)</span>
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'set-signal!</span><span class="p">)</span> <span class="nv">set-my-signal!</span><span class="p">)</span>
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'add-action!</span><span class="p">)</span> <span class="nv">accept-action-procedure!</span><span class="p">)</span>
            <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown operation -- WIRE"</span> <span class="nv">m</span><span class="p">))))</span>
    <span class="nv">dispatch</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">and-gate</span> <span class="nv">a1</span> <span class="nv">a2</span> <span class="nv">output</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">and-action-procedure</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">new-value</span>
           <span class="p">(</span><span class="nf">logical-and</span> <span class="p">(</span><span class="nf">get-signal</span> <span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nf">get-signal</span> <span class="nv">a2</span><span class="p">))))</span>
      <span class="p">(</span><span class="nf">after-delay</span> <span class="nv">and-gate-delay</span>
                   <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
                     <span class="p">(</span><span class="nf">set-signal!</span> <span class="nv">output</span> <span class="nv">new-value</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">add-action!</span> <span class="nv">a1</span> <span class="nv">and-action-procedure</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">add-action!</span> <span class="nv">a2</span> <span class="nv">and-action-procedure</span><span class="p">)</span>
  <span class="ss">'ok</span><span class="p">)</span></code></pre></figure>

<p>It is important to note that <code class="highlighter-rouge">set-my-value</code> will set the state and
push the procedure into the queue of the agenda.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">make-wire</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">b</span> <span class="p">(</span><span class="nf">make-wire</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">o</span> <span class="p">(</span><span class="nf">make-wire</span><span class="p">))</span>
<span class="p">(</span><span class="nf">and-gate</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">o</span><span class="p">)</span>
<span class="p">(</span><span class="nf">propagate</span><span class="p">)</span>

<span class="p">(</span><span class="nf">set-signal!</span> <span class="nv">a</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="nf">set-signal!</span> <span class="nv">b</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nf">propagate</span><span class="p">)</span>

<span class="p">(</span><span class="nf">set-signal!</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nf">set-signal!</span> <span class="nv">b</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="nf">propagate</span><span class="p">)</span></code></pre></figure>

<p>When <code class="highlighter-rouge">a</code> changed from <code class="highlighter-rouge">0</code> to <code class="highlighter-rouge">1</code>, <code class="highlighter-rouge">output=1</code> is pushed to the agenda queue,
in the following, when <code class="highlighter-rouge">b</code> changed from <code class="highlighter-rouge">1</code> to <code class="highlighter-rouge">0</code>, <code class="highlighter-rouge">output=0</code> is pushed to the agenda queue.</p>

<p>If <code class="highlighter-rouge">FIFO</code> is used in the agenda, the final result would be <code class="highlighter-rouge">output=0</code>, otherwise,
<code class="highlighter-rouge">FILO</code> is used, the final result would be <code class="highlighter-rouge">output=1</code>, which is not the correct answer at all!</p>

	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/03/01/sicp-3-3-5" rel="next" title="sicp-3-3-5">sicp-3-3-5</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/27/sicp-3-3-3" rel="previous" title="sicp-3-3-3">sicp-3-3-3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-3-3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-3-3" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-3-3</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-27 19:57:55 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="324">3.24</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-table</span> <span class="nv">same-key?</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">local-table</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'*table*</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">assoc</span> <span class="nv">key</span> <span class="nv">records</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">records</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
            <span class="p">((</span><span class="nf">same-key?</span> <span class="nv">key</span> <span class="p">(</span><span class="nb">caar</span> <span class="nv">records</span><span class="p">))</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">records</span><span class="p">))</span>
            <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">assoc</span> <span class="nv">key</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">records</span><span class="p">)))))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">lookup</span> <span class="nv">key-1</span> <span class="nv">key-2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">subtable</span> <span class="p">(</span><span class="nb">assoc</span> <span class="nv">key-1</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">local-table</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">if</span> <span class="nv">subtable</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">record</span> <span class="p">(</span><span class="nb">assoc</span> <span class="nv">key-2</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">subtable</span><span class="p">))))</span>
          <span class="p">(</span><span class="k">if</span> <span class="nv">record</span>
            <span class="p">(</span><span class="nb">cdr</span> <span class="nv">record</span><span class="p">)</span>
            <span class="no">#f</span>
            <span class="p">))</span>
        <span class="no">#f</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">insert!</span> <span class="nv">key-1</span> <span class="nv">key-2</span> <span class="nv">value</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">subtable</span> <span class="p">(</span><span class="nb">assoc</span> <span class="nv">key-1</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">local-table</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">if</span> <span class="nv">subtable</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">record</span> <span class="p">(</span><span class="nb">assoc</span> <span class="nv">key-2</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">subtable</span><span class="p">))))</span>
          <span class="p">(</span><span class="k">if</span> <span class="nv">record</span>
            <span class="p">(</span><span class="nb">set-cdr!</span> <span class="nv">record</span> <span class="nv">value</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">set-cdr!</span> <span class="nv">subtable</span> <span class="p">(</span><span class="nb">cons</span>
                                 <span class="p">(</span><span class="nb">cons</span> <span class="nv">key-2</span> <span class="nv">value</span><span class="p">)</span>
                                 <span class="p">(</span><span class="nb">cdr</span> <span class="nv">subtable</span><span class="p">)))))</span>
        <span class="p">(</span><span class="nb">set-cdr!</span> <span class="nv">local-table</span> <span class="p">(</span><span class="nb">cons</span>
                                <span class="p">(</span><span class="nb">list</span> <span class="nv">key-1</span>
                                      <span class="p">(</span><span class="nb">cons</span> <span class="nv">key-2</span> <span class="nv">value</span><span class="p">))</span>
                                <span class="p">(</span><span class="nb">cdr</span> <span class="nv">local-table</span><span class="p">))))))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'lookup-proc</span><span class="p">)</span> <span class="nv">lookup</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'insert-proc!</span><span class="p">)</span> <span class="nv">insert!</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Unkown operation -- TABLE"</span> <span class="nv">m</span><span class="p">))))</span>
  <span class="nv">dispatch</span><span class="p">))</span></code></pre></figure>

<h4 id="325">3.25</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fold-left</span> <span class="nv">op</span> <span class="nv">init</span> <span class="nv">seq</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">ans</span> <span class="nv">res</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">res</span><span class="p">)</span>
      <span class="nv">ans</span>
      <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">op</span> <span class="nv">ans</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">res</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">res</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="nv">init</span> <span class="nv">seq</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-table</span> <span class="nv">same-key?</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">associate</span> <span class="nv">key</span> <span class="nv">records</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">records</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
          <span class="p">((</span><span class="nf">same-key?</span> <span class="nv">key</span> <span class="p">(</span><span class="nb">caar</span> <span class="nv">records</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">car</span> <span class="nv">records</span><span class="p">))</span>
           <span class="p">(</span><span class="k">else</span>
             <span class="p">(</span><span class="nf">associate</span> <span class="nv">key</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">records</span><span class="p">)))))</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">the-table</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'*table*</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">lookup</span> <span class="nv">keys</span><span class="p">)</span>
      <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">lookup-record</span> <span class="nv">record-list</span> <span class="nv">key</span><span class="p">)</span>
        <span class="p">(</span><span class="k">if</span> <span class="nv">record-list</span>
          <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">record</span> <span class="p">(</span><span class="nf">associate</span> <span class="nv">key</span> <span class="nv">record-list</span><span class="p">)))</span>
            <span class="p">(</span><span class="k">if</span> <span class="nv">record</span>
              <span class="p">(</span><span class="nb">cdr</span> <span class="nv">record</span><span class="p">)</span>
              <span class="no">#f</span><span class="p">))</span>
          <span class="no">#f</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">fold-left</span> <span class="nv">lookup-record</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">the-table</span><span class="p">)</span> <span class="nv">keys</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">insert!</span> <span class="nv">keys</span> <span class="nv">value</span><span class="p">)</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">descend</span> <span class="nv">table</span> <span class="nv">key</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">record</span> <span class="p">(</span><span class="nf">associate</span> <span class="nv">key</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">table</span><span class="p">))))</span>
        <span class="p">(</span><span class="k">if</span> <span class="nv">record</span>
          <span class="nv">record</span>
          <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">new</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">key</span><span class="p">)</span>
                           <span class="p">(</span><span class="nb">cdr</span> <span class="nv">table</span><span class="p">))))</span>
            <span class="p">(</span><span class="nb">set-cdr!</span> <span class="nv">table</span> <span class="nv">new</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">car</span> <span class="nv">new</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nb">set-cdr!</span> <span class="p">(</span><span class="nf">fold-left</span> <span class="nv">descend</span> <span class="nv">the-table</span> <span class="nv">keys</span><span class="p">)</span>
              <span class="nv">value</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'lookup</span><span class="p">)</span> <span class="nv">lookup</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'insert!</span><span class="p">)</span> <span class="nv">insert!</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Undefined method"</span> <span class="nv">m</span><span class="p">))))</span>
    <span class="nv">dispatch</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">op-table</span> <span class="p">(</span><span class="nf">make-table</span> <span class="nv">eq?</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">put</span> <span class="p">(</span><span class="nf">op-table</span> <span class="ss">'insert!</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">get</span> <span class="p">(</span><span class="nf">op-table</span> <span class="ss">'lookup</span><span class="p">))</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nf">letters</span> <span class="nv">a</span><span class="p">)</span> <span class="mi">97</span><span class="p">)</span>  <span class="c1">; Two dimensions</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nf">letters</span> <span class="nv">b</span><span class="p">)</span> <span class="mi">98</span><span class="p">)</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nf">math</span> <span class="nv">+</span><span class="p">)</span> <span class="mi">43</span><span class="p">)</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nf">math</span> <span class="nv">-</span><span class="p">)</span> <span class="mi">45</span><span class="p">)</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nf">math</span> <span class="nv">*</span><span class="p">)</span> <span class="mi">42</span><span class="p">)</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nf">greek</span> <span class="nv">majiscule</span> <span class="err">Λ</span><span class="p">)</span> <span class="mi">923</span><span class="p">)</span>  <span class="c1">; Three dimensions</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nf">greek</span> <span class="nv">miniscule</span> <span class="err">λ</span><span class="p">)</span> <span class="mi">955</span><span class="p">)</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span> <span class="mi">42</span><span class="p">)</span>  <span class="c1">; One dimension</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span> <span class="mi">955</span><span class="p">)</span>
<span class="p">(</span><span class="nf">get</span> <span class="o">'</span><span class="p">(</span><span class="nb">min</span><span class="p">))</span>
<span class="p">(</span><span class="nf">get</span> <span class="o">'</span><span class="p">(</span><span class="nf">letters</span> <span class="nv">b</span><span class="p">))</span>
<span class="p">(</span><span class="nf">put</span> <span class="o">'</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span> <span class="mi">43</span><span class="p">)</span>  <span class="c1">; update</span>
<span class="p">(</span><span class="nf">get</span> <span class="o">'</span><span class="p">(</span><span class="nb">min</span><span class="p">))</span></code></pre></figure>

<p>This is a hard problem for me, as recursive problem is always hard for me to understand.
<a href="http://community.schemewiki.org/?sicp-ex-3.25">schemewiki</a> provides a great base for this problem, especially the <code class="highlighter-rouge">fold-left</code> is used,
which simplifies the logic a lot.</p>

<p>Recursive relies on split the problem into smaller consistently defined subproblems.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">((</span><span class="nf">k11</span>
   <span class="p">(</span><span class="nf">k12</span>
     <span class="p">(</span><span class="nf">k13</span> <span class="nv">v1</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">k21</span>
   <span class="p">(</span><span class="nf">k22</span>
     <span class="p">(</span><span class="nf">k23</span> <span class="nv">v2</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">k31</span>
   <span class="p">(</span><span class="nf">k32</span> <span class="nv">v3</span><span class="p">)))</span></code></pre></figure>

<p>Multi-dimention table looks like this.</p>

<h4 id="326">3.26</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">entry</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">tree</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">entry-key</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nb">caar</span> <span class="nv">tree</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">entry-value</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdar</span> <span class="nv">tree</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">tree</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">tree</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-tree</span> <span class="nv">entry</span> <span class="nv">left</span> <span class="nv">right</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">list</span> <span class="nv">entry</span> <span class="nv">left</span> <span class="nv">right</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">adjoin-set</span> <span class="nv">x</span> <span class="nv">set</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">set</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">make-tree</span> <span class="nv">x</span> <span class="o">'</span><span class="p">()</span> <span class="o">'</span><span class="p">()))</span>
        <span class="p">((</span><span class="nb">=</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">entry-key</span> <span class="nv">set</span><span class="p">))</span>
         <span class="p">(</span><span class="nb">set-cdr!</span> <span class="p">(</span><span class="nf">entry</span> <span class="nv">set</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>
        <span class="p">((</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">entry-key</span> <span class="nv">set</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">make-tree</span> <span class="p">(</span><span class="nf">entry</span> <span class="nv">set</span><span class="p">)</span>
                    <span class="p">(</span><span class="nf">adjoin-set</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">set</span><span class="p">))</span>
                    <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">set</span><span class="p">)))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nf">make-tree</span> <span class="p">(</span><span class="nf">entry</span> <span class="nv">set</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">set</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">adjoin-set</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">set</span><span class="p">))</span>
                     <span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-table</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">local-table</span> <span class="o">'</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">associate</span> <span class="nv">key</span><span class="p">)</span>
      <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">tree</span><span class="p">)</span>
        <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">tree</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
              <span class="p">((</span><span class="nb">=</span> <span class="nv">key</span> <span class="p">(</span><span class="nf">entry-key</span> <span class="nv">tree</span><span class="p">))</span>
               <span class="p">(</span><span class="nf">entry</span> <span class="nv">tree</span><span class="p">))</span>
              <span class="p">((</span><span class="nb">&lt;</span> <span class="nv">key</span> <span class="p">(</span><span class="nf">entry-key</span> <span class="nv">tree</span><span class="p">))</span>
               <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">tree</span><span class="p">)))</span>
              <span class="p">(</span><span class="k">else</span>
                <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">tree</span><span class="p">)))))</span>
      <span class="p">(</span><span class="nf">iter</span> <span class="nv">local-table</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">insert!</span> <span class="nv">key</span> <span class="nv">value</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">record</span> <span class="p">(</span><span class="nf">associate</span> <span class="nv">key</span><span class="p">)))</span>
        <span class="p">(</span><span class="k">if</span> <span class="nv">record</span>
          <span class="p">(</span><span class="nb">set-cdr!</span> <span class="nv">record</span> <span class="nv">value</span><span class="p">)</span>
          <span class="p">(</span><span class="k">set!</span> <span class="nv">local-table</span>
            <span class="p">(</span><span class="nf">adjoin-set</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">key</span> <span class="nv">value</span><span class="p">)</span> <span class="nv">local-table</span><span class="p">)</span>
            <span class="p">))))</span>
     <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">m</span><span class="p">)</span>
       <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'get-proc</span><span class="p">)</span> <span class="nv">associate</span><span class="p">)</span>
             <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'insert-proc</span><span class="p">)</span> <span class="nv">insert!</span><span class="p">)))</span>
     <span class="nv">dispatch</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">table</span> <span class="p">(</span><span class="nf">make-table</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">get</span> <span class="p">(</span><span class="nf">table</span> <span class="ss">'get-proc</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">put</span> <span class="p">(</span><span class="nf">table</span> <span class="ss">'insert-proc</span><span class="p">))</span>

<span class="p">(</span><span class="nf">put</span> <span class="mi">43</span> <span class="ss">'a</span><span class="p">)</span>
<span class="p">(</span><span class="nf">put</span> <span class="mi">42</span> <span class="ss">'b</span><span class="p">)</span>
<span class="p">(</span><span class="nf">get</span> <span class="mi">43</span><span class="p">)</span>
<span class="p">(</span><span class="nf">get</span> <span class="mi">42</span><span class="p">)</span>

<span class="p">(</span><span class="nf">put</span> <span class="mi">43</span> <span class="ss">'e</span><span class="p">)</span>
<span class="p">(</span><span class="nf">get</span> <span class="mi">43</span><span class="p">)</span></code></pre></figure>

<h4 id="327">3.27</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">memoize</span> <span class="nv">f</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">table</span> <span class="p">(</span><span class="nf">make-table</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">previously-computed-result</span> <span class="p">(</span><span class="nf">lookup</span> <span class="nv">x</span> <span class="nv">table</span><span class="p">)))</span>
        <span class="p">(</span><span class="k">or</span> <span class="nv">previously-computed-result</span>
            <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">result</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)))</span>
              <span class="p">(</span><span class="nf">insert!</span> <span class="nv">x</span> <span class="nv">result</span> <span class="nv">table</span><span class="p">)</span>
              <span class="nv">result</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">memo-fib</span>
  <span class="p">(</span><span class="nf">memoize</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span>
             <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
                   <span class="p">((</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
                   <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">memo-fib</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>
                            <span class="p">(</span><span class="nf">memo-fib</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))))))))</span></code></pre></figure>

<p>The key lies in the <code class="highlighter-rouge">memo-fib</code> will share the table cache.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/28/sicp-3-3-4" rel="next" title="sicp-3-3-4">sicp-3-3-4</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/27/sicp-3-3-2" rel="previous" title="sicp-3-3-2">sicp-3-3-2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-3-2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-3-2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-3-2</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-27 00:17:13 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="321">3.21</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">front-ptr</span> <span class="nv">queue</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">queue</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rear-ptr</span> <span class="nv">queue</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">queue</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">set-front-ptr!</span> <span class="nv">queue</span> <span class="nv">item</span><span class="p">)</span> <span class="p">(</span><span class="nb">set-car!</span> <span class="nv">queue</span> <span class="nv">item</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">set-rear-ptr!</span> <span class="nv">queue</span> <span class="nv">item</span><span class="p">)</span> <span class="p">(</span><span class="nb">set-cdr!</span> <span class="nv">queue</span> <span class="nv">item</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">empty-queue?</span> <span class="nv">queue</span><span class="p">)</span> <span class="p">(</span><span class="nb">null?</span> <span class="p">(</span><span class="nf">front-ptr</span> <span class="nv">queue</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-queue</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="o">'</span><span class="p">()</span> <span class="o">'</span><span class="p">()))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">front-queue</span> <span class="nv">queue</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">empty-queue?</span> <span class="nv">queue</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">error</span> <span class="s">"FRONT called with an empty queue"</span> <span class="nv">queue</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nf">front-ptr</span> <span class="nv">queue</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">insert-queue!</span> <span class="nv">queue</span> <span class="nv">item</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">new-pair</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">item</span> <span class="o">'</span><span class="p">())))</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">empty-queue?</span> <span class="nv">queue</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">set-front-ptr!</span> <span class="nv">queue</span> <span class="nv">new-pair</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">set-rear-ptr!</span> <span class="nv">queue</span> <span class="nv">new-pair</span><span class="p">)</span>
           <span class="nv">queue</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nb">set-cdr!</span> <span class="p">(</span><span class="nf">rear-ptr</span> <span class="nv">queue</span><span class="p">)</span> <span class="nv">new-pair</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">set-rear-ptr!</span> <span class="nv">queue</span> <span class="nv">new-pair</span><span class="p">)</span>
           <span class="nv">queue</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">delete-queue!</span> <span class="nv">queue</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">empty-queue?</span> <span class="nv">queue</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">error</span> <span class="s">"DELETE! called with an empty queue"</span> <span class="nv">queue</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span>
         <span class="p">(</span><span class="nf">set-front-ptr!</span> <span class="nv">queue</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nf">front-ptr</span> <span class="nv">queue</span><span class="p">)))</span>
         <span class="nv">queue</span><span class="p">)))</span></code></pre></figure>

<h4 id="322">3.22</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">make-queue</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">front-ptr</span> <span class="o">'</span><span class="p">())</span>
        <span class="p">(</span><span class="nf">rear-ptr</span> <span class="o">'</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">empty-queue?</span><span class="p">)</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">front-ptr</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">set-front-ptr!</span> <span class="nv">item</span><span class="p">)</span> <span class="p">(</span><span class="k">set!</span> <span class="nv">front-ptr</span> <span class="nv">item</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">set-rear-ptr!</span> <span class="nv">item</span><span class="p">)</span> <span class="p">(</span><span class="k">set!</span> <span class="nv">rear-ptr</span> <span class="nv">item</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">front-queue</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">empty-queue?</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">error</span> <span class="s">"FRONT called with an empty queue"</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">car</span> <span class="nv">front-ptr</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">insert-queue!</span> <span class="nv">item</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">new-pair</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">item</span> <span class="o">'</span><span class="p">())))</span>
        <span class="p">(</span><span class="k">cond</span> <span class="p">(</span><span class="nf">empty-queue?</span>
               <span class="p">(</span><span class="nf">set-front-ptr!</span> <span class="nv">new-pair</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">set-rear-ptr!</span> <span class="nv">new-pair</span><span class="p">))</span>
              <span class="p">(</span><span class="k">else</span>
                <span class="p">(</span><span class="nb">set-cdr!</span> <span class="nv">rear-ptr</span> <span class="nv">new-pair</span><span class="p">)</span>
                <span class="p">(</span><span class="nf">set-rear-ptr!</span> <span class="nv">new-pair</span><span class="p">)))))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">delete-queue!</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span> <span class="p">(</span><span class="nf">empty-queue?</span>
             <span class="p">(</span><span class="nf">error</span> <span class="s">"DELETE! called with an empty queue"</span><span class="p">))</span>
            <span class="p">(</span><span class="k">else</span>
              <span class="p">(</span><span class="nf">set-front-ptr!</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">front-ptr</span><span class="p">)))))</span>
    <span class="p">(</span><span class="k">define</span> <span class="nv">print-queue</span> <span class="nv">front-ptr</span><span class="p">)</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">m</span><span class="p">)</span> 
      <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'empty-queue</span><span class="p">)</span> <span class="nv">empty-queue?</span><span class="p">)</span> 
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'front-queue</span><span class="p">)</span> <span class="nv">front-queue</span><span class="p">)</span> 
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'insert-queue!</span><span class="p">)</span> <span class="nv">insert-queue!</span><span class="p">)</span> 
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'delete-queue!</span><span class="p">)</span> <span class="nv">delete-queue!</span><span class="p">)</span> 
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'print-queue</span><span class="p">)</span> <span class="nv">print-queue</span><span class="p">)</span> 
            <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"undefined operation -- QUEUE"</span> <span class="nv">m</span><span class="p">))))</span>
     <span class="nv">dispatch</span><span class="p">))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/27/sicp-3-3-3" rel="next" title="sicp-3-3-3">sicp-3-3-3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/26/sicp-3-3-1" rel="previous" title="sicp-3-3-1">sicp-3-3-1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-3-1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-3-1" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-3-1</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-26 20:23:25 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="316">3.16</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">count-pairs</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">))</span>
      <span class="mi">0</span>
      <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">count-pairs</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">count-pairs</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">x</span><span class="p">))</span>
         <span class="mi">1</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">z3</span> <span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="p">(</span><span class="nf">count-pairs</span> <span class="nv">z3</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">z1</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">z4</span>
  <span class="p">(</span><span class="nb">list</span> <span class="nv">z1</span> <span class="nv">z1</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">z23</span>
  <span class="p">(</span><span class="nb">cons</span> <span class="nv">z1</span> <span class="nv">z1</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">z7</span>
  <span class="p">(</span><span class="nb">cons</span> <span class="nv">z23</span> <span class="nv">z23</span><span class="p">))</span>


<span class="p">(</span><span class="k">define</span> <span class="nv">zi</span> <span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="p">(</span><span class="nb">set-cdr!</span> <span class="p">(</span><span class="nb">cddr</span> <span class="nv">zi</span><span class="p">)</span> <span class="nv">zi</span><span class="p">)</span>
<span class="p">(</span><span class="nf">count-pairs</span> <span class="nv">zi</span><span class="p">)</span></code></pre></figure>

<p>The construct of <code class="highlighter-rouge">zi</code> is hard for me.
It could be built with the <code class="highlighter-rouge">lazy evaluation</code> as well.</p>

<h4 id="317">3.17</h4>

<blockquote>
  <p><code class="highlighter-rouge">(eq? x y)</code> tests whether x and y are the same object (that is, whether x and y are equal as pointers)</p>
</blockquote>

<p>Understanding the pointer is the key to understand sameness and sharing.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">count-pairs</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">aux</span> <span class="o">'</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">uncounted?</span> <span class="nv">x</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">memq</span> <span class="nv">x</span> <span class="nv">aux</span><span class="p">)</span>
        <span class="mi">0</span>
        <span class="p">(</span><span class="k">begin</span>
          <span class="p">(</span><span class="k">set!</span> <span class="nv">aux</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="nv">aux</span><span class="p">))</span>
          <span class="mi">1</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">count</span> <span class="nv">x</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">))</span>
        <span class="mi">0</span>
        <span class="p">(</span><span class="nb">+</span>
          <span class="p">(</span><span class="nf">count</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">count</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">x</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">uncounted?</span> <span class="nv">x</span><span class="p">))))</span>
    <span class="p">(</span><span class="nf">count</span> <span class="nv">x</span><span class="p">)))</span></code></pre></figure>

<h4 id="318">3.18</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cycle?</span> <span class="nv">l</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">detect</span> <span class="nv">pair</span> <span class="nv">countedList</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">pair</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">memq</span> <span class="nv">pair</span> <span class="nv">countedList</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span>
            <span class="p">(</span><span class="nf">detect</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">pair</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">pair</span> <span class="nv">countedList</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">detect</span> <span class="nv">l</span> <span class="o">'</span><span class="p">()))</span></code></pre></figure>

<h4 id="319">3.19</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">has_cycle?</span> <span class="nv">l</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">l</span> <span class="nv">r</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">l</span> <span class="nv">r</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">r</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">r</span><span class="p">)))</span> <span class="no">#f</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">r</span><span class="p">))))))</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">l</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))</span> <span class="no">#f</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))</span></code></pre></figure>

<p>It is a frequently asked question in a interview.
Special attention should be paied to the corner cases.</p>

	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/27/sicp-3-3-2" rel="next" title="sicp-3-3-2">sicp-3-3-2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/26/sicp-3-2" rel="previous" title="sicp-3-2">sicp-3-2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-2</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-26 07:59:06 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<blockquote>
  <p>In the environment model of evaluation, a procedure is always a pair consisting of some code and a pointer to an environment. Procedures are created in one way only: by evaluating a lambda expression. This produces a procedure whose code is obtained from the text of the lambda expression and whose environment is the environment in which the lambda expression was evaluated to produce the procedure.</p>
</blockquote>

<p>Important quote from the SICP text, which is the principle to understand the model part.
<code class="highlighter-rouge">Lambda</code> expression is the key to create a procedure.</p>

<p>Each procedure contains a environment pointer and a code pointer. When calling a procedure, a new environment is derived from the defining environment
with new parameters added in.</p>

<p>Drawing the graphs is time consuming, skip them for now.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/26/sicp-3-3-1" rel="next" title="sicp-3-3-1">sicp-3-3-1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/26/sicp-3-1-2-3-1-3" rel="previous" title="sicp-3-1-2-3-1-3">sicp-3-1-2-3-1-3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-1-2-3-1-3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-1-2-3-1-3" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-1-2-3-1-3</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-26 01:59:04 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="35">3.5</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="o">#</span><span class="nv">lang</span> <span class="nv">racket</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">random-in-range</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">range</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">high</span> <span class="nv">low</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">+</span> <span class="nv">low</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">random</span><span class="p">)</span> <span class="nv">range</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">monte-carlo</span> <span class="nv">trials</span> <span class="nv">experiment</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">trials-remaining</span> <span class="nv">trials-passed</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">trials-remaining</span> <span class="mi">0</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">/</span> <span class="nv">trials-passed</span> <span class="nv">trials</span><span class="p">))</span>
          <span class="p">((</span><span class="nf">experiment</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">trials-remaining</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">trials-passed</span> <span class="mi">1</span><span class="p">)))</span>
          <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">trials-remaining</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">trials-passed</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="nv">trials</span> <span class="mi">0</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rect-area</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">y1</span> <span class="nv">y2</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">x2</span> <span class="nv">x1</span><span class="p">)</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">y2</span> <span class="nv">y1</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">estimate-integral</span> <span class="nv">P</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">y1</span> <span class="nv">y2</span> <span class="nv">trials</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">test</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">P</span> <span class="p">(</span><span class="nf">random-in-range</span> <span class="nv">x1</span> <span class="nv">x2</span><span class="p">)</span> <span class="p">(</span><span class="nf">random-in-range</span> <span class="nv">y1</span> <span class="nv">y2</span><span class="p">)))</span>
  <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">monte-carlo</span> <span class="nv">trials</span> <span class="nv">test</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">rect-area</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">y1</span> <span class="nv">y2</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">estimate-pi</span> <span class="nv">trials</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">P</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">y</span><span class="p">))</span> <span class="mf">1.0</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">estimate-integral</span> <span class="nv">P</span> <span class="mf">-1.0</span> <span class="mf">1.0</span> <span class="mf">-1.0</span> <span class="mf">1.0</span> <span class="nv">trials</span><span class="p">))</span>

<span class="p">(</span><span class="nf">estimate-pi</span> <span class="mi">10000000</span><span class="p">)</span></code></pre></figure>

<p>The <code class="highlighter-rouge">random</code> function in <code class="highlighter-rouge">neil/sicp</code> dialect would only return <code class="highlighter-rouge">integer</code>,
to return a <code class="highlighter-rouge">real</code> number back, I have to rely on the <code class="highlighter-rouge">racket</code> dialect.</p>

<h4 id="37">3.7</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-joint</span> <span class="nv">acc</span> <span class="nv">acc-pass</span> <span class="nv">new-pass</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">password</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">eq?</span> <span class="nv">password</span> <span class="nv">new-pass</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">acc</span> <span class="nv">acc-pass</span> <span class="nv">m</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">error</span> <span class="s">"Bad password"</span> <span class="nv">password</span><span class="p">)))</span>
  <span class="nv">dispatch</span><span class="p">)</span></code></pre></figure>

<h4 id="38">3.8</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">f</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">state</span> <span class="mi">0</span><span class="p">))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">old-state</span> <span class="nv">state</span><span class="p">))</span>
        <span class="p">(</span><span class="k">set!</span> <span class="nv">state</span> <span class="nv">x</span><span class="p">)</span>
        <span class="nv">old-state</span><span class="p">))))</span></code></pre></figure>

<p>The key lies in to make a closure and make use of its side effect.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/26/sicp-3-2" rel="next" title="sicp-3-2">sicp-3-2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/25/sicp-3-1-1" rel="previous" title="sicp-3-1-1">sicp-3-1-1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-3-1-1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-3-1-1" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-3-1-1</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-25 20:47:35 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="31">3.1</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-accumulator</span> <span class="nv">initial</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">accumulate</span> <span class="nv">initial</span><span class="p">))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
      <span class="p">(</span><span class="k">set!</span> <span class="nv">accumulate</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">accumulate</span> <span class="nv">x</span><span class="p">))</span>
      <span class="nv">accumulate</span><span class="p">)))</span></code></pre></figure>

<h4 id="32">3.2</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-monitored</span> <span class="nv">proc</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">call-times</span> <span class="mi">0</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">m</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span>
        <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'how-many-calls?</span><span class="p">)</span> <span class="nv">call-times</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'reset-count</span><span class="p">)</span> <span class="p">(</span><span class="k">set!</span> <span class="nv">call-count</span> <span class="mi">0</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="k">set!</span> <span class="nv">call-times</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="nv">call-times</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">proc</span> <span class="nv">m</span><span class="p">))))</span>
    <span class="nv">dispatch</span><span class="p">))</span></code></pre></figure>

<h4 id="33">3.3</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-account</span> <span class="nv">balance</span> <span class="nv">password</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">withdraw</span> <span class="nv">amount</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;=</span> <span class="nv">balance</span> <span class="nv">amount</span><span class="p">)</span> <span class="p">(</span><span class="k">begin</span> <span class="p">(</span><span class="k">set!</span> <span class="nv">balance</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span> <span class="nv">balance</span><span class="p">)</span>
        <span class="s">"Insufficient funds"</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deposit</span> <span class="nv">amount</span><span class="p">)</span>
    <span class="p">(</span><span class="k">set!</span> <span class="nv">balance</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span> <span class="nv">balance</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">pass</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">eq?</span> <span class="nv">pass</span> <span class="nv">password</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">error</span> <span class="s">"Bad password -- "</span> <span class="nv">pass</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'withdraw</span><span class="p">)</span> <span class="nv">withdraw</span><span class="p">)</span>
            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'deposit</span><span class="p">)</span> <span class="nv">deposit</span><span class="p">)</span>
            <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown request -- MAKE-ACCOUNT"</span> <span class="nv">m</span><span class="p">)))))</span>
  <span class="nv">dispatch</span><span class="p">)</span></code></pre></figure>

<h4 id="34">3.4</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-account</span> <span class="nv">balance</span> <span class="nv">password</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">withdraw</span> <span class="nv">amount</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;=</span> <span class="nv">balance</span> <span class="nv">amount</span><span class="p">)</span> <span class="p">(</span><span class="k">begin</span> <span class="p">(</span><span class="k">set!</span> <span class="nv">balance</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span> <span class="nv">balance</span><span class="p">)</span>
        <span class="s">"Insufficient funds"</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deposit</span> <span class="nv">amount</span><span class="p">)</span>
    <span class="p">(</span><span class="k">set!</span> <span class="nv">balance</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">balance</span> <span class="nv">amount</span><span class="p">))</span> <span class="nv">balance</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">error-message</span> <span class="nv">amount</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display</span> <span class="ss">'incorrect-password</span><span class="p">))</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">incorrect-pass-count</span> <span class="mi">0</span><span class="p">))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">pass</span> <span class="nv">m</span><span class="p">)</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">eq?</span> <span class="nv">pass</span> <span class="nv">password</span><span class="p">))</span>
          <span class="p">(</span><span class="k">begin</span>
            <span class="p">(</span><span class="k">set!</span> <span class="nv">incorrect-pass-count</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="nv">incorrect-pass-count</span><span class="p">))</span>
            <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">incorrect-pass-count</span> <span class="mi">7</span><span class="p">)</span>
              <span class="nv">call-the-cops</span>
              <span class="nv">error-message</span><span class="p">))</span>
          <span class="p">(</span><span class="k">begin</span>
            <span class="p">(</span><span class="k">set!</span> <span class="nv">incorrect-pass-count</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'withdraw</span><span class="p">)</span> <span class="nv">withdraw</span><span class="p">)</span>
                            <span class="p">((</span><span class="nb">eq?</span> <span class="nv">m</span> <span class="ss">'deposit</span><span class="p">)</span> <span class="nv">deposit</span><span class="p">)</span>
                            <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown request -- MAKE-ACCOUNT"</span> <span class="nv">m</span><span class="p">)))))))</span>
  <span class="nv">dispatch</span><span class="p">)</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/26/sicp-3-1-2-3-1-3" rel="next" title="sicp-3-1-2-3-1-3">sicp-3-1-2-3-1-3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/25/sicp-2-5-2" rel="previous" title="sicp-2-5-2">sicp-2-5-2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2-5-2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2-5-2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2-5-2</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-25 07:03:37 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="281">2.81</h4>

<p>If try to coerce two numbers, it would fall into a infinite loop.</p>

<p>It would show an error message if trying to convert an augument to
its own type, which is correct.</p>

<h4 id="282">2.82</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">apply-generic</span> <span class="nv">op</span> <span class="o">.</span> <span class="nv">args</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">apply-generic</span> <span class="nv">op</span> <span class="nv">args</span> <span class="nv">type-list</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">type-list</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">error</span> <span class="s">"No method for types"</span>
             <span class="p">(</span><span class="nb">list</span> <span class="nv">op</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">type-tag</span> <span class="nv">args</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">new-args</span> <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
                           <span class="p">(</span><span class="nf">convert</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">type-list</span><span class="p">)))</span>
                         <span class="nv">args</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">new-tags</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">type-tag</span> <span class="nv">new-args</span><span class="p">)))</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">proc</span> <span class="p">(</span><span class="nf">get</span> <span class="nv">op</span> <span class="nv">new-tags</span><span class="p">)))</span>
          <span class="p">(</span><span class="k">if</span> <span class="nv">proc</span>
            <span class="p">(</span><span class="nb">apply</span> <span class="nv">proc</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">contents</span> <span class="nv">new-args</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">apply-generic</span> <span class="nv">op</span> <span class="nv">args</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">type-list</span><span class="p">)))))))</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">type-tags</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">type-tag</span> <span class="nv">args</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">proc</span> <span class="p">(</span><span class="nf">get</span> <span class="nv">op</span> <span class="nv">type-tags</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if</span> <span class="nv">proc</span>
        <span class="p">(</span><span class="nb">apply</span> <span class="nv">proc</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">contents</span> <span class="nv">args</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">apply-generic</span> <span class="nv">op</span> <span class="nv">args</span> <span class="nv">type-tags</span><span class="p">)))))</span></code></pre></figure>

<h4 id="283">2.83</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">raise</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">apply-generic</span> <span class="ss">'raise</span> <span class="nv">x</span><span class="p">))</span>
 <span class="p">(</span><span class="nf">put</span> <span class="ss">'raise</span> <span class="ss">'integer</span>
      <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">make-rational</span> <span class="nv">x</span> <span class="mi">1</span><span class="p">)))</span>

 <span class="p">(</span><span class="nf">put</span> <span class="ss">'raise</span> <span class="ss">'rational</span>
      <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">make-real</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nf">numer</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">denom</span> <span class="nv">x</span><span class="p">)))))</span>

 <span class="p">(</span><span class="nf">put</span> <span class="ss">'raise</span> <span class="ss">'real</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">make-from-real-imag</span> <span class="nv">x</span> <span class="mi">0</span><span class="p">)))</span></code></pre></figure>

<h4 id="284--297">2.84 ~ 2.97</h4>

<p>I decided to skip the above ones just because they are so code intense,
maybe I will come back to them in the future.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/25/sicp-3-1-1" rel="next" title="sicp-3-1-1">sicp-3-1-1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/24/sicp-2-5-1" rel="previous" title="sicp-2-5-1">sicp-2-5-1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2-5-1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2-5-1" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2-5-1</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-24 21:01:24 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="277">2.77</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="nf">apply-generic</span> <span class="ss">'magnitude</span> <span class="o">'</span><span class="p">(</span><span class="nf">complex</span> <span class="nv">rectangular</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>
<span class="nv">--&gt;</span>
<span class="p">((</span><span class="nf">get</span> <span class="ss">'magnitude</span> <span class="o">'</span><span class="p">(</span><span class="nf">complex</span><span class="p">))</span> <span class="o">'</span><span class="p">(</span><span class="nf">rectangular</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>
<span class="nv">--&gt;</span>
<span class="p">(</span><span class="nb">magnitude</span> <span class="o">'</span><span class="p">(</span><span class="nf">rectangular</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>
<span class="nv">--&gt;</span>
<span class="p">(</span><span class="nf">apply-generic</span> <span class="ss">'magnitude</span> <span class="o">'</span><span class="p">(</span><span class="nf">rectangular</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>
<span class="nv">--&gt;</span>
<span class="p">((</span><span class="nf">get</span> <span class="ss">'magnitude</span> <span class="o">'</span><span class="p">(</span><span class="nf">rectangular</span><span class="p">))</span> <span class="p">(</span><span class="nf">3</span> <span class="mi">4</span><span class="p">))</span>
<span class="nv">--&gt;</span>
<span class="p">(</span><span class="nb">magnitude</span> <span class="p">(</span><span class="nf">3</span> <span class="mi">4</span><span class="p">))</span></code></pre></figure>

<h4 id="278">2.78</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">attach-tag</span> <span class="nv">type-tag</span> <span class="nv">contents</span><span class="p">)</span>
   <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">contents</span><span class="p">)</span>
       <span class="nv">contents</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">type-tag</span> <span class="nv">contents</span><span class="p">)))</span>

 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">type-tag</span> <span class="nv">datum</span><span class="p">)</span>
   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">number?</span> <span class="nv">datum</span><span class="p">)</span> <span class="ss">'scheme-number</span><span class="p">)</span>
         <span class="p">((</span><span class="nb">pair?</span> <span class="nv">datum</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">datum</span><span class="p">))</span>
         <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Bad taged datum -- TYPE-TAG"</span> <span class="nv">datum</span><span class="p">))))</span>

 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">contents</span> <span class="nv">datum</span><span class="p">)</span>
   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">number?</span> <span class="nv">datum</span><span class="p">)</span> <span class="nv">datum</span><span class="p">)</span>
         <span class="p">((</span><span class="nb">pair?</span> <span class="nv">datum</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">datum</span><span class="p">))</span>
         <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Bad taged datum -- CONTENTS"</span> <span class="nv">datum</span><span class="p">))))</span></code></pre></figure>

<h4 id="279">2.79</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">equ?</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">apply-generic</span> <span class="ss">'equ</span> <span class="nv">?</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">))</span>

<span class="p">(</span><span class="nf">put</span> <span class="ss">'equ?</span> <span class="o">'</span><span class="p">(</span><span class="nf">scheme-number</span> <span class="nv">scheme-number</span><span class="p">)</span> <span class="nv">=</span><span class="p">)</span>
<span class="p">(</span><span class="nf">put</span> <span class="ss">'equ?</span> <span class="o">'</span><span class="p">(</span><span class="nf">rational</span> <span class="nv">rational</span><span class="p">)</span> <span class="nv">equ-rat?</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">equ-rat?</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nf">numer</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">numer</span> <span class="nv">y</span><span class="p">))</span>
       <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nf">denom</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">denom</span> <span class="nv">y</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">put</span> <span class="ss">'equ?</span> <span class="o">'</span><span class="p">(</span><span class="nf">complex</span> <span class="nv">complex</span><span class="p">)</span> <span class="nv">equ-complex?</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">equ-complex?</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">real-part</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">real-part</span> <span class="nv">y</span><span class="p">))</span>
       <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">imag-part</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">imag-part</span> <span class="nv">y</span><span class="p">))))</span></code></pre></figure>

<p>The tag of the number should be managed separately in the procedures.</p>

<h4 id="280">2.80</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">=zero?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">apply-generic</span> <span class="ss">'=zero?</span> <span class="nv">x</span><span class="p">))</span>
<span class="p">(</span><span class="nf">put</span> <span class="ss">'=zero?</span> <span class="ss">'scheme-number</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">x</span> <span class="mi">0</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">put</span> <span class="ss">'=zero?</span> <span class="ss">'rational-number</span>
        <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nf">number</span> <span class="nv">x</span><span class="p">)</span> <span class="mi">0</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">put</span> <span class="ss">'=zero?</span> <span class="ss">'complex-number</span>
        <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">magnitude</span> <span class="nv">x</span><span class="p">)</span> <span class="mi">0</span><span class="p">)))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/25/sicp-2-5-2" rel="next" title="sicp-2-5-2">sicp-2-5-2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/24/sicp-2-4" rel="previous" title="sicp-2-4">sicp-2-4</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2-4 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2-4" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2-4</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-24 06:45:38 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="273">2.73</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">global-array</span> <span class="o">'</span><span class="p">())</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-entry</span> <span class="nv">k</span> <span class="nv">v</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">k</span> <span class="nv">v</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">key</span> <span class="nv">entry</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">entry</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">value</span> <span class="nv">entry</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">entry</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">put</span> <span class="nv">op</span> <span class="nv">type</span> <span class="nv">item</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">put-helper</span> <span class="nv">k</span> <span class="nv">array</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">array</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nf">make-entry</span> <span class="nv">k</span> <span class="nv">item</span><span class="p">)))</span>
          <span class="p">((</span><span class="nb">equal?</span> <span class="p">(</span><span class="nf">key</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">array</span><span class="p">))</span> <span class="nv">k</span><span class="p">)</span> <span class="nv">array</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">array</span><span class="p">)</span> <span class="p">(</span><span class="nf">put-helper</span> <span class="nv">k</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">array</span><span class="p">))))))</span>
  <span class="p">(</span><span class="k">set!</span> <span class="nv">global-array</span> <span class="p">(</span><span class="nf">put-helper</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">op</span> <span class="nv">type</span><span class="p">)</span> <span class="nv">global-array</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">get</span> <span class="nv">op</span> <span class="nv">type</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">get-helper</span> <span class="nv">k</span> <span class="nv">array</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">array</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">equal?</span> <span class="p">(</span><span class="nf">key</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">array</span><span class="p">))</span> <span class="nv">k</span><span class="p">)</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">array</span><span class="p">)))</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">get-helper</span> <span class="nv">k</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">array</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">get-helper</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">op</span> <span class="nv">type</span><span class="p">)</span> <span class="nv">global-array</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">variable?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">symbol?</span> <span class="nv">x</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">same-variable?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">variable?</span> <span class="nv">v1</span><span class="p">)</span> <span class="p">(</span><span class="nf">variable?</span> <span class="nv">v2</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum?</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)</span> <span class="ss">'+</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deriv</span> <span class="nv">exp</span> <span class="nv">var</span><span class="p">)</span>
   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">number?</span> <span class="nv">exp</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
         <span class="p">((</span><span class="nf">variable?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">same-variable?</span> <span class="nv">exp</span> <span class="nv">var</span><span class="p">)</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
         <span class="p">(</span><span class="k">else</span> <span class="p">((</span><span class="nf">get</span> <span class="ss">'deriv</span> <span class="p">(</span><span class="nf">operator</span> <span class="nv">exp</span><span class="p">))</span> <span class="p">(</span><span class="nf">operands</span> <span class="nv">exp</span><span class="p">)</span>
                                            <span class="nv">var</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">operator</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">exp</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">operands</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">exp</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">attach-tag</span> <span class="nv">type-tag</span> <span class="nv">contents</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">type-tag</span> <span class="ss">'scheme-number</span><span class="p">)</span>
      <span class="nv">contents</span>
      <span class="p">(</span><span class="nb">cons</span> <span class="nv">type-tag</span> <span class="nv">contents</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">type-tag</span> <span class="nv">datum</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">number?</span> <span class="nv">datum</span><span class="p">)</span> <span class="ss">'scheme-number</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">pair?</span> <span class="nv">datum</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">datum</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Bad tagged datum -- TYPE-TAG"</span> <span class="nv">datum</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">contents</span> <span class="nv">datum</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">number?</span> <span class="nv">datum</span><span class="p">)</span> <span class="nv">datum</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">pair?</span> <span class="nv">datum</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">datum</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"Bad tagged datum -- CONTENTS"</span> <span class="nv">datum</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">install-deriv-package</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">=number?</span> <span class="nv">exp</span> <span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">exp</span> <span class="nv">num</span><span class="p">)))</span>

  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-sum</span> <span class="nv">a1</span> <span class="nv">a2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">=number?</span> <span class="nv">a1</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">a2</span><span class="p">)</span>
          <span class="p">((</span><span class="nf">=number?</span> <span class="nv">a2</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">a1</span><span class="p">)</span>
          <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">a2</span><span class="p">))</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a1</span> <span class="nv">a2</span><span class="p">))</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'+</span> <span class="nv">a1</span> <span class="nv">a2</span><span class="p">))))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">addend</span> <span class="nv">data</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">data</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">augend</span> <span class="nv">data</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">data</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deriv-sum</span> <span class="nv">data</span> <span class="nv">var</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">make-sum</span> <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">addend</span> <span class="nv">data</span><span class="p">)</span> <span class="nv">var</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">augend</span> <span class="nv">data</span><span class="p">)</span> <span class="nv">var</span><span class="p">)))</span>

  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-product</span> <span class="nv">m1</span> <span class="nv">m2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nf">=number?</span> <span class="nv">m1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">=number?</span> <span class="nv">m2</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
          <span class="p">((</span><span class="nf">=number?</span> <span class="nv">m1</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m2</span><span class="p">)</span>
          <span class="p">((</span><span class="nf">=number?</span> <span class="nv">m2</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m1</span><span class="p">)</span>
          <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">m1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">m2</span><span class="p">))</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">m1</span> <span class="nv">m2</span><span class="p">))</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'*</span> <span class="nv">m1</span> <span class="nv">m2</span><span class="p">))))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">data</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">data</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">multiplicand</span> <span class="nv">data</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">data</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deriv-product</span> <span class="nv">data</span> <span class="nv">var</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">make-sum</span>
     <span class="p">(</span><span class="nf">make-product</span> <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">data</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">multiplicand</span> <span class="nv">data</span><span class="p">)</span> <span class="nv">var</span><span class="p">))</span>
     <span class="p">(</span><span class="nf">make-product</span> <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">data</span><span class="p">)</span> <span class="nv">var</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">multiplicand</span> <span class="nv">data</span><span class="p">))))</span>

  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-exponentiation</span> <span class="nv">base</span> <span class="nv">exp</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">=number?</span> <span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
          <span class="p">((</span><span class="nf">=number?</span> <span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">base</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'**</span> <span class="nv">base</span> <span class="nv">exp</span><span class="p">))))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">base</span> <span class="nv">data</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">data</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">exponent</span> <span class="nv">data</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">data</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deriv-exponentation</span> <span class="nv">data</span> <span class="nv">var</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">make-product</span>
     <span class="p">(</span><span class="nf">exponent</span> <span class="nv">data</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">make-product</span>
      <span class="p">(</span><span class="nf">make-exponentiation</span> <span class="p">(</span><span class="nf">base</span> <span class="nv">data</span><span class="p">)</span>
                           <span class="p">(</span><span class="nf">make-sum</span> <span class="p">(</span><span class="nf">exponent</span> <span class="nv">data</span><span class="p">)</span> <span class="p">(</span><span class="nb">-</span> <span class="mi">1</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">base</span> <span class="nv">data</span><span class="p">)</span> <span class="nv">var</span><span class="p">))))</span>

  <span class="p">(</span><span class="nf">put</span> <span class="ss">'deriv</span> <span class="ss">'+</span> <span class="nv">deriv-sum</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">put</span> <span class="ss">'deriv</span> <span class="ss">'*</span> <span class="nv">deriv-product</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">put</span> <span class="ss">'deriv</span> <span class="ss">'**</span> <span class="nv">deriv-exponentation</span><span class="p">)</span>
  <span class="ss">'done</span><span class="p">)</span>

<span class="p">(</span><span class="nf">install-deriv-package</span><span class="p">)</span>
<span class="p">(</span><span class="nf">deriv</span> <span class="o">'</span><span class="p">(</span><span class="nf">**</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">**</span> <span class="nv">x</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="ss">'x</span><span class="p">)</span></code></pre></figure>

<p><code class="highlighter-rouge">put</code> and <code class="highlighter-rouge">get</code> is from <a href="http://stackoverflow.com/questions/5499005/how-do-i-get-the-functions-put-and-get-in-sicp-scheme-exercise-2-78-and-on">stackoverflow</a>.</p>

<h4 id="275">2.75</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-from-mag-ang</span> <span class="nv">r</span> <span class="nv">a</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dispatch</span> <span class="nv">op</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">eq?</span> <span class="nv">op</span> <span class="ss">'real-part</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">r</span> <span class="p">(</span><span class="nb">cos</span> <span class="nv">a</span><span class="p">)))</span>
          <span class="p">((</span><span class="nb">eq?</span> <span class="nv">op</span> <span class="ss">'imag-part</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">r</span> <span class="p">(</span><span class="nb">sin</span> <span class="nv">a</span><span class="p">)))</span>
          <span class="p">((</span><span class="nb">eq?</span> <span class="nv">op</span> <span class="ss">'magnitude</span><span class="p">)</span> <span class="nv">r</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">eq?</span> <span class="nv">op</span> <span class="ss">'angle</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown op -- MAKE-FROM-MAG-ANG"</span> <span class="nv">op</span><span class="p">))))</span>
  <span class="nv">dispatch</span><span class="p">)</span></code></pre></figure>

<h4 id="276">2.76</h4>
<p><code class="highlighter-rouge">Message passing</code> style is more flexible compared with  <code class="highlighter-rouge">data driven</code> style, which is self contained.
But <code class="highlighter-rouge">message passing</code> suffers from the <code class="highlighter-rouge">only generic procedures of one argument</code>.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/24/sicp-2-5-1" rel="next" title="sicp-2-5-1">sicp-2-5-1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/23/sicp-2-3-4" rel="previous" title="sicp-2-3-4">sicp-2-3-4</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2-3-4 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2-3-4" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2-3-4</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-23 02:20:49 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="267">2.67</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-leaf</span> <span class="nv">symbol</span> <span class="nv">weight</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">list</span> <span class="ss">'leaf</span> <span class="nv">symbol</span> <span class="nv">weight</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">leaf?</span> <span class="nv">object</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">object</span><span class="p">)</span> <span class="ss">'leaf</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">symbol-leaf</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">x</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">weight-leaf</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">x</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-code-tree</span> <span class="nv">left</span> <span class="nv">right</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">list</span> <span class="nv">left</span>
        <span class="nv">right</span>
        <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nf">symbols</span> <span class="nv">left</span><span class="p">)</span> <span class="p">(</span><span class="nf">symbols</span> <span class="nv">right</span><span class="p">))</span>
        <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">weight</span> <span class="nv">left</span><span class="p">)</span> <span class="p">(</span><span class="nf">weight</span> <span class="nv">right</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">tree</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">tree</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">tree</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">symbols</span> <span class="nv">tree</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">leaf?</span> <span class="nv">tree</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">symbol-leaf</span> <span class="nv">tree</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">caddr</span> <span class="nv">tree</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">weight</span> <span class="nv">tree</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">leaf?</span> <span class="nv">tree</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">weight-leaf</span> <span class="nv">tree</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">cadddr</span> <span class="nv">tree</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">decode</span> <span class="nv">bits</span> <span class="nv">tree</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">decode-1</span> <span class="nv">bits</span> <span class="nv">current-branch</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">bits</span><span class="p">)</span>
        <span class="o">'</span><span class="p">()</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">next-branch</span>
               <span class="p">(</span><span class="nf">choose-branch</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">bits</span><span class="p">)</span> <span class="nv">current-branch</span><span class="p">)))</span>
          <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">leaf?</span> <span class="nv">next-branch</span><span class="p">)</span>
              <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">symbol-leaf</span> <span class="nv">next-branch</span><span class="p">)</span>
                    <span class="p">(</span><span class="nf">decode-1</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">bits</span><span class="p">)</span> <span class="nv">tree</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">decode-1</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">bits</span><span class="p">)</span> <span class="nv">next-branch</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">decode-1</span> <span class="nv">bits</span> <span class="nv">tree</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">choose-branch</span> <span class="nv">bit</span> <span class="nv">branch</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">bit</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">branch</span><span class="p">))</span>
        <span class="p">((</span><span class="nb">=</span> <span class="nv">bit</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">branch</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">error</span> <span class="s">"bad bit -- CHOOSE-BRANCH"</span> <span class="nv">bit</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">adjoin-set</span> <span class="nv">x</span> <span class="nv">set</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">set</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">x</span><span class="p">))</span>
        <span class="p">((</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nf">weight</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">weight</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set</span><span class="p">)))</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="nv">set</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set</span><span class="p">)</span>
                    <span class="p">(</span><span class="nf">adjoin-set</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">set</span><span class="p">))))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-leaf-set</span> <span class="nv">pairs</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">pairs</span><span class="p">)</span>
      <span class="o">'</span><span class="p">()</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">pair</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">pairs</span><span class="p">)))</span>
        <span class="p">(</span><span class="nf">adjoin-set</span> <span class="p">(</span><span class="nf">make-leaf</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">pair</span><span class="p">)</span>    <span class="c1">; symbol</span>
                               <span class="p">(</span><span class="nb">cadr</span> <span class="nv">pair</span><span class="p">))</span>  <span class="c1">; frequency</span>
                    <span class="p">(</span><span class="nf">make-leaf-set</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">pairs</span><span class="p">))))))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">sample-tree</span>
  <span class="p">(</span><span class="nf">make-code-tree</span> <span class="p">(</span><span class="nf">make-leaf</span> <span class="ss">'A</span> <span class="mi">4</span><span class="p">)</span>
                  <span class="p">(</span><span class="nf">make-code-tree</span>
                   <span class="p">(</span><span class="nf">make-leaf</span> <span class="ss">'B</span> <span class="mi">2</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">make-code-tree</span> <span class="p">(</span><span class="nf">make-leaf</span> <span class="ss">'D</span> <span class="mi">1</span><span class="p">)</span>
                                   <span class="p">(</span><span class="nf">make-leaf</span> <span class="ss">'C</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="o">'</span><span class="p">(</span><span class="nf">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">'</span><span class="p">(</span><span class="nf">A</span> <span class="nv">D</span>     <span class="nv">A</span> <span class="nv">B</span>   <span class="nv">B</span>   <span class="nv">C</span>     <span class="nv">A</span><span class="p">)</span></code></pre></figure>

<h4 id="268">2.68</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">encode</span> <span class="nv">message</span> <span class="nv">tree</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">message</span><span class="p">)</span>
      <span class="o">'</span><span class="p">()</span>
      <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nf">encode-symbol</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">message</span><span class="p">)</span> <span class="nv">tree</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">encode</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">message</span><span class="p">)</span> <span class="nv">tree</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">encode-symbol</span> <span class="nv">symbol</span> <span class="nv">tree</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">memq</span> <span class="nv">symbol</span> <span class="p">(</span><span class="nf">symbols</span> <span class="nv">tree</span><span class="p">)))</span>
         <span class="p">(</span><span class="nf">error</span> <span class="s">"bad symbol -- encode-symbol"</span> <span class="nv">symbol</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">leaf?</span> <span class="nv">tree</span><span class="p">)</span>
         <span class="o">'</span><span class="p">())</span>
        <span class="p">((</span><span class="nb">memq</span> <span class="nv">symbol</span> <span class="p">(</span><span class="nf">symbols</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">tree</span><span class="p">)))</span>
         <span class="p">(</span><span class="nb">cons</span> <span class="mi">0</span>
               <span class="p">(</span><span class="nf">encode-symbol</span> <span class="nv">symbol</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">tree</span><span class="p">))))</span>
        <span class="p">((</span><span class="nb">memq</span> <span class="nv">symbol</span> <span class="p">(</span><span class="nf">symbols</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">tree</span><span class="p">)))</span>
         <span class="p">(</span><span class="nb">cons</span> <span class="mi">1</span>
               <span class="p">(</span><span class="nf">encode-symbol</span> <span class="nv">symbol</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">tree</span><span class="p">))))))</span></code></pre></figure>

<h4 id="269">2.69</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">generate-huffman-tree</span> <span class="nv">pairs</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">successive-merge</span> <span class="p">(</span><span class="nf">make-leaf-set</span> <span class="nv">pairs</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">successive-merge</span> <span class="nv">leaves</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">leaves</span><span class="p">))</span>
    <span class="p">(</span><span class="nb">car</span> <span class="nv">leaves</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">successive-merge</span>
      <span class="p">(</span><span class="nf">adjoin-set</span> <span class="p">(</span><span class="nf">make-code-tree</span>
                    <span class="p">(</span><span class="nb">car</span> <span class="nv">leaves</span><span class="p">)</span>
                    <span class="p">(</span><span class="nb">cadr</span> <span class="nv">leaves</span><span class="p">))</span>
                  <span class="p">(</span><span class="nb">cddr</span> <span class="nv">leaves</span><span class="p">)))))</span></code></pre></figure>

<h4 id="270">2.70</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">lyric-tree</span>
  <span class="p">(</span><span class="nf">generate-huffman-tree</span> <span class="o">'</span><span class="p">((</span><span class="nf">A</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">BOOM</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">GET</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">JOB</span> <span class="mi">2</span><span class="p">)</span>
                           <span class="p">(</span><span class="nf">NA</span> <span class="mi">16</span><span class="p">)</span> <span class="p">(</span><span class="nf">SHA</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nf">YIP</span> <span class="mi">9</span><span class="p">)</span> <span class="p">(</span><span class="nf">WAH</span> <span class="mi">1</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">length</span> <span class="p">(</span><span class="nf">encode</span> <span class="o">'</span><span class="p">(</span><span class="nf">GET</span> <span class="nv">A</span> <span class="nv">JOB</span>
          <span class="nv">SHA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span>
          <span class="nv">GET</span> <span class="nv">A</span> <span class="nv">JOB</span>
          <span class="nv">SHA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span> <span class="nv">NA</span>
          <span class="nv">WAH</span> <span class="nv">YIP</span> <span class="nv">YIP</span> <span class="nv">YIP</span> <span class="nv">YIP</span> <span class="nv">YIP</span> <span class="nv">YIP</span> <span class="nv">YIP</span> <span class="nv">YIP</span> <span class="nv">YIP</span>
          <span class="nv">SHA</span> <span class="nv">BOOM</span><span class="p">)</span>
        <span class="nv">lyric-tree</span><span class="p">))</span></code></pre></figure>

<p>It take <code class="highlighter-rouge">84</code> bits compared with the <code class="highlighter-rouge">108</code> bits in
fixed-length.</p>

<h4 id="271">2.71</h4>

<p>It takes <code class="highlighter-rouge">1</code> bit to encode the most frequent bit and <code class="highlighter-rouge">n - 1</code> bits to 
encode the least frequent bit.</p>

<h4 id="272">2.72</h4>

<p>If the <code class="highlighter-rouge">encode</code> uses an unordered set to keep its symbols, it would
take about $O(n)$ to encode the most frequent symbol and
<script type="math/tex">\sum_1^n = n * (n+1)/2 = O(n^2)</script> to encode the least frequent symbol.</p>

	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/24/sicp-2-4" rel="next" title="sicp-2-4">sicp-2-4</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/22/sicp-2-3-3" rel="previous" title="sicp-2.3.3">sicp-2.3.3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2.3.3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2.3.3" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2.3.3</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-22 23:54:30 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="259">2.59</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">union-set</span> <span class="nv">set1</span> <span class="nv">set2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">element-of-set?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">union-set</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set1</span><span class="p">)</span>
                <span class="p">(</span><span class="nf">union-set</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">set1</span><span class="p">)</span>
                           <span class="nv">set2</span><span class="p">)))))</span></code></pre></figure>

<h4 id="260">2.60</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">adjoin-set</span> <span class="nv">x</span> <span class="nv">set</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="nv">set</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">union-set</span> <span class="nv">set1</span> <span class="nv">set2</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">append</span> <span class="nv">set1</span> <span class="nv">set2</span><span class="p">))</span></code></pre></figure>

<p><code class="highlighter-rouge">adjoin-set</code> goes from $O(n)$ to $O(1)$</p>

<p><code class="highlighter-rouge">union-set</code> goes from $O(n^2)$ to $O(n)$</p>

<h4 id="261">2.61</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">adjoin-set</span> <span class="nv">x</span> <span class="nv">set</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">set</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">x</span><span class="p">))</span>
        <span class="p">((</span><span class="nb">&lt;</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="nv">set</span><span class="p">))</span>
        <span class="p">((</span><span class="nb">=</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set</span><span class="p">))</span> <span class="nv">set</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">&gt;</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set</span><span class="p">)</span>
                               <span class="p">(</span><span class="nf">adjoin-set</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">set</span><span class="p">))))))</span></code></pre></figure>

<h4 id="262">2.62</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">union-set</span> <span class="nv">set1</span> <span class="nv">set2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">null?</span> <span class="nv">set2</span><span class="p">)</span> <span class="nv">set1</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="k">let*</span> <span class="p">([</span><span class="nf">x1</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set1</span><span class="p">)]</span> <span class="p">[</span><span class="nf">x2</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">set2</span><span class="p">)])</span>
            <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">&lt;</span> <span class="nv">x1</span> <span class="nv">x2</span><span class="p">)</span>
                   <span class="p">(</span><span class="nb">cons</span> <span class="nv">x1</span>
                         <span class="p">(</span><span class="nf">union-set</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))</span>
                  <span class="p">((</span><span class="nb">=</span> <span class="nv">x1</span> <span class="nv">x2</span><span class="p">)</span>
                   <span class="p">(</span><span class="nb">cons</span> <span class="nv">x1</span>
                         <span class="p">(</span><span class="nf">union-set</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">set1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">set2</span><span class="p">))))</span>
                  <span class="p">(</span><span class="k">else</span>
                    <span class="p">(</span><span class="nb">cons</span> <span class="nv">x2</span>
                          <span class="p">(</span><span class="nf">union-set</span> <span class="nv">set1</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">set2</span><span class="p">)))))))))</span></code></pre></figure>

<h4 id="263">2.63</h4>
<p>It would make no difference on the final result, both of them are in order traverse.
But there is something tricky on the time complexity<a href="http://community.schemewiki.org/?sicp-ex-2.63">1</a>.</p>

<p><code class="highlighter-rouge">append</code> is much more expensive than <code class="highlighter-rouge">cons</code>.</p>

<p>Let $T(n)$ be the time complexity for a balanced tree of $n$ nodes.</p>

<p>For tree-&gt;list-1:</p>

<script type="math/tex; mode=display">T(n) = 2 * T(n/2) + O(n) = O(nlog n)</script>

<p>For tree-&gt;list-2:</p>

<script type="math/tex; mode=display">T(n) = 2 * T(n/2) + O(1) = O(n)</script>

<h4 id="264">2.64</h4>
<p>The analysis of time complexity is similar to the <code class="highlighter-rouge">2.63</code>, which is $O(nlog n)$.</p>

<h4 id="265">2.65</h4>
<p>Use <code class="highlighter-rouge">tree-list</code> from <code class="highlighter-rouge">2.63</code> and <code class="highlighter-rouge">list-tree</code> to convert bidirectional.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"> <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">union-set</span> <span class="nv">tree1</span> <span class="nv">tree2</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">list-&gt;tree</span> <span class="p">(</span><span class="nf">union-set-list</span> <span class="p">(</span><span class="nf">tree-&gt;list</span> <span class="nv">tree1</span><span class="p">)</span>
                               <span class="p">(</span><span class="nf">tree-&gt;list</span> <span class="nv">tree2</span><span class="p">))))</span>

 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">intersection-set</span> <span class="nv">tree1</span> <span class="nv">tree2</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">list-&gt;tree</span> <span class="p">(</span><span class="nf">intersection-set-list</span> <span class="p">(</span><span class="nf">tree-&gt;list</span> <span class="nv">tree1</span><span class="p">)</span>
                                      <span class="p">(</span><span class="nf">tree-&gt;list</span> <span class="nv">tree2</span><span class="p">))))</span></code></pre></figure>

<h4 id="266">2.66</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">lookup</span> <span class="nv">given-key</span> <span class="nv">set-of-records</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">set-of-records</span><span class="p">)</span>
    <span class="no">#f</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">([</span><span class="nf">record</span> <span class="p">(</span><span class="nf">entry</span> <span class="nv">set-of-records</span><span class="p">)])</span>
      <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">given-key</span> <span class="p">(</span><span class="nf">key</span> <span class="nv">record</span><span class="p">))</span> <span class="nv">record</span><span class="p">)</span>
            <span class="p">((</span><span class="nb">&lt;</span> <span class="nv">given-key</span> <span class="p">(</span><span class="nf">key</span> <span class="nv">record</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">lookup</span> <span class="nv">given-key</span>
                     <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">set-of-records</span><span class="p">)))</span>
            <span class="p">((</span><span class="nb">&gt;</span> <span class="nv">given-key</span> <span class="p">(</span><span class="nf">key</span> <span class="nv">record</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">lookup</span> <span class="nv">given-key</span> 
                     <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">set-of-records</span><span class="p">)))))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/23/sicp-2-3-4" rel="next" title="sicp-2-3-4">sicp-2-3-4</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/21/sicp-2-3-2" rel="previous" title="sicp-2.3.2">sicp-2.3.2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2.3.2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2.3.2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2.3.2</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-21 07:41:20 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="256">2.56</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="nf">print-as-expression</span> <span class="no">#f</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">variable?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">symbol?</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">same-variable?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">variable?</span> <span class="nv">v1</span><span class="p">)</span> <span class="p">(</span><span class="nf">variable?</span> <span class="nv">v2</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">=number?</span> <span class="nv">exp</span> <span class="nv">num</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">exp</span> <span class="nv">num</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-sum</span> <span class="nv">a1</span> <span class="nv">a2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">=number?</span> <span class="nv">a1</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">a2</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">=number?</span> <span class="nv">a2</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">a1</span><span class="p">)</span>
        <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">a2</span><span class="p">))</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a1</span> <span class="nv">a2</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'+</span> <span class="nv">a1</span> <span class="nv">a2</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-product</span> <span class="nv">m1</span> <span class="nv">m2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nf">=number?</span> <span class="nv">m1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">=number?</span> <span class="nv">m2</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">=number?</span> <span class="nv">m1</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m2</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">=number?</span> <span class="nv">m2</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m1</span><span class="p">)</span>
        <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">m1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">m2</span><span class="p">))</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">m1</span> <span class="nv">m2</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'*</span> <span class="nv">m1</span> <span class="nv">m2</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum?</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)</span> <span class="ss">'+</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">addend</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">s</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">augend</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">s</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">product?</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)</span> <span class="ss">'*</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">multiplicand</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deriv</span> <span class="nv">exp</span> <span class="nv">var</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">number?</span> <span class="nv">exp</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">variable?</span> <span class="nv">exp</span><span class="p">)</span>
         <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">same-variable?</span> <span class="nv">exp</span> <span class="nv">var</span><span class="p">)</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">sum?</span> <span class="nv">exp</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">make-sum</span> <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">addend</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">var</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">augend</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">var</span><span class="p">)))</span>
        <span class="p">((</span><span class="nf">product?</span> <span class="nv">exp</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">make-sum</span>
           <span class="p">(</span><span class="nf">make-product</span> <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">exp</span><span class="p">)</span>
                         <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">multiplicand</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">var</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">make-product</span> <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">multiplier</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">var</span><span class="p">)</span>
                         <span class="p">(</span><span class="nf">multiplicand</span> <span class="nv">exp</span><span class="p">))))</span>
        <span class="p">((</span><span class="nf">exponentiation?</span> <span class="nv">exp</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">make-product</span>
           <span class="p">(</span><span class="nf">exponent</span> <span class="nv">exp</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">make-product</span>
             <span class="p">(</span><span class="nf">make-exponentiation</span>
               <span class="p">(</span><span class="nf">base</span> <span class="nv">exp</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">make-sum</span> <span class="p">(</span><span class="nf">exponent</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">-</span> <span class="mi">1</span><span class="p">)))</span>
             <span class="p">(</span><span class="nf">deriv</span> <span class="p">(</span><span class="nf">base</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">var</span><span class="p">))))</span>
        <span class="p">(</span><span class="k">else</span>
         <span class="p">(</span><span class="nf">error</span> <span class="s">"unknown expression type -- DERIV"</span> <span class="nv">exp</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-exponentiation</span> <span class="nv">base</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">=number?</span> <span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">=number?</span> <span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">base</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'**</span> <span class="nv">base</span> <span class="nv">exp</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">exponentiation?</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)</span> <span class="ss">'**</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">base</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">e</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">exponent</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">e</span><span class="p">))</span></code></pre></figure>

<p>The tricky part to use all the high level function such as
<code class="highlighter-rouge">make-sum</code>, as the <code class="highlighter-rouge">exp</code> could be a expression as well.</p>

<h4 id="257">2.57</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">augend</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">cdddr</span> <span class="nv">s</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">caddr</span> <span class="nv">s</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons</span> <span class="ss">'+</span> <span class="p">(</span><span class="nb">cddr</span> <span class="nv">s</span><span class="p">))))</span></code></pre></figure>

<h4 id="258">2.58</h4>
<p>Skipped</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/22/sicp-2-3-3" rel="next" title="sicp-2.3.3">sicp-2.3.3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/20/sicp-2-3-1-2-3-2" rel="previous" title="sicp-2.3.1-2.3.2">sicp-2.3.1-2.3.2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2.3.1-2.3.2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2.3.1-2.3.2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2.3.1-2.3.2</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-20 19:41:41 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="254">2.54</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">equal?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">b</span><span class="p">))</span>
         <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">equal?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">b</span><span class="p">))</span>
              <span class="p">(</span><span class="nb">equal?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">b</span><span class="p">))))</span>
        <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">a</span><span class="p">))</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">b</span><span class="p">)))</span>
         <span class="p">(</span><span class="nb">eq?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">)))</span></code></pre></figure>

<h4 id="255">2.55</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="nb">car</span> <span class="o">'</span><span class="ss">'abracadabra</span><span class="p">)</span>
<span class="nv">--&gt;</span>
<span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="k">quote</span> <span class="p">(</span><span class="k">quote</span> <span class="nv">abracadabra</span><span class="p">)))</span>
<span class="nv">--&gt;</span>
<span class="ss">'quote</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/21/sicp-2-3-2" rel="next" title="sicp-2.3.2">sicp-2.3.2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/20/sicp-2-2-4" rel="previous" title="sicp-2.2.4">sicp-2.2.4</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2.2.4 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2.2.4" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2.2.4</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-20 07:20:40 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="package-used">package used</h4>

<p><a href="http://planet.racket-lang.org/package-source/soegaard/sicp.plt/1/1/doc.txt">Drracket picture language</a> is used.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="o">#</span><span class="nv">lang</span> <span class="nv">racket</span>
<span class="p">(</span><span class="nf">require</span> <span class="p">(</span><span class="nf">planet</span> <span class="s">"sicp.ss"</span> <span class="p">(</span><span class="s">"soegaard"</span> <span class="s">"sicp.plt"</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)))</span></code></pre></figure>

<h4 id="244">2.44</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">up-split</span> <span class="nv">painter</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nv">painter</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">smaller</span> <span class="p">(</span><span class="nf">up-split</span> <span class="nv">painter</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))))</span>
      <span class="p">(</span><span class="nf">below</span> <span class="nv">painter</span> <span class="p">(</span><span class="nf">beside</span> <span class="nv">smaller</span> <span class="nv">smaller</span><span class="p">)))))</span></code></pre></figure>

<h4 id="245">2.45</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">split</span> <span class="nv">op1</span> <span class="nv">op2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">painter</span> <span class="nv">n</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nv">painter</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">smaller</span> <span class="p">((</span><span class="nf">split</span> <span class="nv">op1</span> <span class="nv">op2</span><span class="p">)</span> <span class="nv">painter</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))))</span>
          <span class="p">(</span><span class="nf">op1</span> <span class="nv">painter</span> <span class="p">(</span><span class="nf">op2</span> <span class="nv">smaller</span> <span class="nv">smaller</span><span class="p">))))))</span></code></pre></figure>

<h4 id="246">2.46</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">xcor-vect</span> <span class="nv">v</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">car</span> <span class="nv">v</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">ycor-vect</span> <span class="nv">v</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">cdr</span> <span class="nv">v</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">add-vect</span> <span class="nv">u</span> <span class="nv">v</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">make-vect</span>
     <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">xcor-vect</span> <span class="nv">u</span><span class="p">)</span> <span class="p">(</span><span class="nf">xcor-vect</span> <span class="nv">v</span><span class="p">))</span>
     <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">ycor-vect</span> <span class="nv">u</span><span class="p">)</span> <span class="p">(</span><span class="nf">ycor-vect</span> <span class="nv">v</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sub-vect</span> <span class="nv">u</span> <span class="nv">v</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">make-vect</span>
     <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nf">xcor-vect</span> <span class="nv">u</span><span class="p">)</span> <span class="p">(</span><span class="nf">xcor-vect</span> <span class="nv">v</span><span class="p">))</span>
     <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nf">ycor-vect</span> <span class="nv">u</span><span class="p">)</span> <span class="p">(</span><span class="nf">ycor-vect</span> <span class="nv">v</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">scale-vect</span> <span class="nv">s</span> <span class="nv">v</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">make-vect</span>
     <span class="p">(</span><span class="nb">*</span> <span class="nv">s</span> <span class="p">(</span><span class="nf">xcor-vect</span> <span class="nv">v</span><span class="p">))</span>
     <span class="p">(</span><span class="nb">*</span> <span class="nv">s</span> <span class="p">(</span><span class="nf">ycor-vect</span> <span class="nv">v</span><span class="p">))))</span></code></pre></figure>

<h4 id="247">2.47</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-frame</span> <span class="nv">origin</span> <span class="nv">edge1</span> <span class="nv">edge2</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">list</span> <span class="nv">origin</span> <span class="nv">edge1</span> <span class="nv">edge2</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">origin-frame</span> <span class="nv">frame</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">car</span> <span class="nv">frame</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">edge1-frame</span> <span class="nv">frame</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cadr</span> <span class="nv">frame</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">edge2-frame</span> <span class="nv">frame</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">caddr</span> <span class="nv">frame</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-frame</span> <span class="nv">origin</span> <span class="nv">edge1</span> <span class="nv">edge2</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cons</span> <span class="nv">origin</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">edge1</span> <span class="nv">edge2</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">origin-frame</span> <span class="nv">frame</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">car</span> <span class="nv">frame</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">edge1-frame</span> <span class="nv">frame</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cadr</span> <span class="nv">frame</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">edge2-frame</span> <span class="nv">frame</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cddr</span> <span class="nv">frame</span><span class="p">))</span></code></pre></figure>

<h4 id="248">2.48</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-segment</span> <span class="nv">u</span> <span class="nv">v</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cons</span> <span class="nv">u</span> <span class="nv">v</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">start-segment</span> <span class="nv">segment</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">car</span> <span class="nv">segment</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">end-segment</span> <span class="nv">segment</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cdr</span> <span class="nv">segment</span><span class="p">))</span></code></pre></figure>

<h4 id="249">2.49</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">draw-outline</span> <span class="nv">frame</span><span class="p">)</span>
  <span class="p">((</span><span class="nf">segments-&gt;painter</span>
    <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="nv">frame</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">draw-X</span> <span class="nv">frame</span><span class="p">)</span>
  <span class="p">((</span><span class="nf">segments-&gt;painter</span>
    <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">))))</span>
   <span class="nv">frame</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">draw-diamond</span> <span class="nv">frame</span><span class="p">)</span>
  <span class="p">((</span><span class="nf">segments-&gt;painter</span>
    <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mf">0.5</span> <span class="mf">0.0</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mf">1.0</span> <span class="mf">0.5</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mf">1.0</span> <span class="mf">0.5</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mf">0.5</span> <span class="mf">1.0</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mf">0.5</span> <span class="mf">1.0</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mf">0.0</span> <span class="mf">0.5</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">make-segment</span> <span class="p">(</span><span class="nf">make-vect</span> <span class="mf">0.0</span> <span class="mf">0.5</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">make-vect</span> <span class="mf">0.5</span> <span class="mf">0.0</span><span class="p">))))</span></code></pre></figure>

<h4 id="250">2.50</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">flip-horiz</span> <span class="nv">painter</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">transform-painter</span> <span class="nv">painter</span>
                     <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rotate180</span> <span class="nv">painter</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">transform-painter</span> <span class="nv">painter</span>
                     <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rotate270</span> <span class="nv">painter</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">transform-painter</span> <span class="nv">painter</span>
                     <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">make-vect</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)))</span></code></pre></figure>

<h4 id="251">2.51</h4>
<p>Hint from the <a href="https://wqzhang.wordpress.com/2009/06/23/sicp-exercise-2-51/">wqzhang</a>, which is very elegant.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">below</span> <span class="nv">painter1</span> <span class="nv">painter2</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">rotate90</span> <span class="p">(</span><span class="nf">beside</span> <span class="p">(</span><span class="nf">rotate270</span> <span class="nv">painter1</span><span class="p">)</span>
                    <span class="p">(</span><span class="nf">rotate270</span> <span class="nv">painter2</span><span class="p">))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/20/sicp-2-3-1-2-3-2" rel="next" title="sicp-2.3.1-2.3.2">sicp-2.3.1-2.3.2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/18/sicp-2-2-3" rel="previous" title="sicp-2.2.3">sicp-2.2.3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2.2.3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2.2.3" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2.2.3</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-18 19:31:27 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="233">2.33</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">op</span> <span class="nv">initial</span> <span class="nv">sequence</span><span class="p">)</span>
   <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">sequence</span><span class="p">)</span>
       <span class="nv">initial</span>
       <span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">sequence</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">op</span> <span class="nv">initial</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">sequence</span><span class="p">)))))</span>

<span class="p">(</span><span class="nf">accumulate</span> <span class="nv">+</span> <span class="mi">0</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">p</span> <span class="nv">sequence</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">accumulate</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">p</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">y</span><span class="p">))</span> <span class="nv">null</span> <span class="nv">sequence</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="nb">map</span> <span class="nv">square</span> <span class="o">'</span><span class="p">(</span><span class="nf">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">append</span> <span class="nv">seq1</span> <span class="nv">seq2</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">cons</span> <span class="nv">seq2</span> <span class="nv">seq1</span><span class="p">))</span>

<span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">length</span> <span class="nv">sequence</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">accumulate</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="nv">y</span><span class="p">))</span> <span class="mi">0</span> <span class="nv">sequence</span><span class="p">))</span>

<span class="p">(</span><span class="nb">length</span> <span class="o">'</span><span class="p">(</span><span class="nf">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span></code></pre></figure>

<p>The <code class="highlighter-rouge">append</code> is kind of tricky to me at first glance.
Just remaind me this equition: <code class="highlighter-rouge">cons 1 (list 2 3) = (list 1 2 3)</code></p>

<h4 id="234">2.34</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">horner-eval</span> <span class="nv">x</span> <span class="nv">coefficient-sequence</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">accumulate</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">this-coeff</span> <span class="nv">higher-terms</span><span class="p">)</span>
                 <span class="p">(</span><span class="nb">+</span> <span class="nv">this-coeff</span>
                    <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">higher-terms</span><span class="p">)))</span>
               <span class="mi">0</span>
               <span class="nv">coefficient-sequence</span><span class="p">))</span>

<span class="p">(</span><span class="nf">horner-eval</span> <span class="mi">2</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">0</span> <span class="mi">5</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">))</span></code></pre></figure>

<h4 id="235">2.35</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">count-leaves</span> <span class="nv">t</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">+</span> <span class="mi">0</span> <span class="p">(</span><span class="nb">map</span>
                     <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
                       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">))</span>
                         <span class="mi">1</span>
                         <span class="p">(</span><span class="nf">count-leaves</span> <span class="nv">x</span><span class="p">)))</span>
                     <span class="nv">t</span><span class="p">)))</span></code></pre></figure>

<p>This is the most elegant way, which flats the tree structure recursively.</p>

<h4 id="236">2.36</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accumulate-n</span> <span class="nv">op</span> <span class="nv">init</span> <span class="nv">seqs</span><span class="p">)</span>
   <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">seqs</span><span class="p">))</span>
       <span class="nv">null</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">op</span> <span class="nv">init</span>
                         <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
                                <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">))</span>
                              <span class="nv">seqs</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">accumulate-n</span> <span class="nv">op</span> <span class="nv">init</span>
                           <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
                                  <span class="p">(</span><span class="nb">cdr</span> <span class="nv">x</span><span class="p">))</span>
                                <span class="nv">seqs</span><span class="p">)))))</span>

<span class="p">(</span><span class="nf">accumulate-n</span> <span class="nv">+</span> <span class="mi">0</span> <span class="o">'</span><span class="p">((</span><span class="nf">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nf">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">)</span> <span class="p">(</span><span class="nf">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">)</span> <span class="p">(</span><span class="nf">10</span> <span class="mi">11</span> <span class="mi">12</span><span class="p">)))</span></code></pre></figure>

<h4 id="237">2.37</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">dot-product</span> <span class="nv">v</span> <span class="nv">w</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">+</span> <span class="mi">0</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">*</span> <span class="nv">v</span> <span class="nv">w</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">matrix-*-vector</span> <span class="nv">m</span> <span class="nv">v</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">row</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">dot-product</span> <span class="nv">v</span> <span class="nv">row</span><span class="p">))</span> <span class="nv">m</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">m0</span> <span class="o">'</span><span class="p">((</span><span class="nf">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span> <span class="p">(</span><span class="nf">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">6</span><span class="p">)</span> <span class="p">(</span><span class="nf">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">matrix-*-vector</span> <span class="nv">m0</span> <span class="o">'</span><span class="p">(</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">transpose</span> <span class="nv">mat</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">accumulate-n</span> <span class="nv">cons</span> <span class="nv">null</span>  <span class="nv">mat</span><span class="p">))</span>

<span class="p">(</span><span class="nf">transpose</span> <span class="nv">m0</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">matrix-*-matrix</span> <span class="nv">m</span> <span class="nv">n</span><span class="p">)</span>
   <span class="p">(</span><span class="k">let</span> <span class="p">([</span><span class="nf">cols</span> <span class="p">(</span><span class="nf">transpose</span> <span class="nv">n</span><span class="p">)])</span>
      <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span><span class="p">(</span><span class="nf">v</span><span class="p">)</span> <span class="p">(</span><span class="nf">matrix-*-vector</span> <span class="nv">cols</span> <span class="nv">v</span><span class="p">))</span> <span class="nv">m</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">matrix-*-matrix</span> <span class="nv">m0</span> <span class="p">(</span><span class="nf">transpose</span> <span class="nv">m0</span><span class="p">))</span></code></pre></figure>

<h4 id="238">2.38</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fold-right</span> <span class="nv">op</span> <span class="nv">initial</span> <span class="nv">sequence</span><span class="p">)</span>
   <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">sequence</span><span class="p">)</span>
       <span class="nv">initial</span>
       <span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">sequence</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">fold-right</span> <span class="nv">op</span> <span class="nv">initial</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">sequence</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fold-left</span> <span class="nv">op</span> <span class="nv">initial</span> <span class="nv">sequence</span><span class="p">)</span>
   <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">result</span> <span class="nv">rest</span><span class="p">)</span>
     <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">rest</span><span class="p">)</span>
         <span class="nv">result</span>
         <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">op</span> <span class="nv">result</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">rest</span><span class="p">))</span>
               <span class="p">(</span><span class="nb">cdr</span> <span class="nv">rest</span><span class="p">))))</span>
   <span class="p">(</span><span class="nf">iter</span> <span class="nv">initial</span> <span class="nv">sequence</span><span class="p">))</span>

<span class="p">(</span><span class="nf">fold-right</span> <span class="nv">/</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>
<span class="mi">3</span><span class="nv">/2</span>
<span class="p">(</span><span class="nf">fold-left</span> <span class="nv">/</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>
<span class="mi">1</span><span class="nv">/6</span>
<span class="p">(</span><span class="nf">fold-right</span> <span class="nv">list</span> <span class="nv">null</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>
<span class="p">(</span><span class="nf">1</span> <span class="p">(</span><span class="nf">2</span> <span class="p">(</span><span class="nf">3</span> <span class="p">())))</span>
<span class="p">(</span><span class="nf">fold-left</span> <span class="nv">list</span> <span class="nv">null</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>
<span class="p">(((()</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span></code></pre></figure>

<p>Both associativity and commutativity.
That is</p>

<p><code class="highlighter-rouge">(op a b) = (op b a)</code> and <code class="highlighter-rouge">(op (op a b) c) = (op a (op b c))</code></p>

<h4 id="239">2.39</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">reverse</span> <span class="nv">sequence</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">fold-right</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
                <span class="p">(</span><span class="nb">append</span> <span class="nv">y</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">x</span><span class="p">)))</span>
              <span class="nv">null</span>
              <span class="nv">sequence</span><span class="p">))</span>

<span class="p">(</span><span class="nb">reverse</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">reverse</span> <span class="nv">sequence</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">fold-left</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
                <span class="p">(</span><span class="nb">cons</span> <span class="nv">y</span>  <span class="nv">x</span><span class="p">))</span>
              <span class="nv">null</span>
              <span class="nv">sequence</span><span class="p">))</span>

<span class="p">(</span><span class="nb">reverse</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span></code></pre></figure>

<h4 id="240">2.40</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unique-pairs</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">flatmap</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">i</span><span class="p">)</span>
             <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">j</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">i</span> <span class="nv">j</span><span class="p">))</span>
                  <span class="p">(</span><span class="nf">enumerate-interval</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">i</span> <span class="mi">1</span><span class="p">))))</span>
           <span class="p">(</span><span class="nf">enumerate-interval</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">prime-sum-pairs</span> <span class="nv">n</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">map</span> <span class="nv">make-pair-sum</span>
        <span class="p">(</span><span class="nf">filter</span> <span class="nv">prime-sum?</span>
                <span class="p">(</span><span class="nf">unique-pairs</span> <span class="nv">n</span><span class="p">))))</span></code></pre></figure>

<h4 id="241">2.41</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">unique-triples</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">flatmap</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">i</span><span class="p">)</span>
             <span class="p">(</span><span class="nf">flatmap</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">j</span><span class="p">)</span>
                        <span class="p">(</span><span class="nb">map</span>
                          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">k</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span><span class="p">))</span>
                          <span class="p">(</span><span class="nf">enumerate-interval</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">j</span> <span class="mi">1</span><span class="p">))))</span>
                      <span class="p">(</span><span class="nf">enumerate-interval</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">i</span> <span class="mi">1</span><span class="p">))))</span>
           <span class="p">(</span><span class="nf">enumerate-interval</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">equal-sum?</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">lst</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">=</span> <span class="nv">s</span> <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">+</span> <span class="mi">0</span> <span class="nv">lst</span><span class="p">))))</span></code></pre></figure>

<h4 id="242">2.42</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">queens</span> <span class="nv">board-size</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">queen-cols</span> <span class="nv">k</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="nv">empty-board</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">filter</span>
         <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">positions</span><span class="p">)</span> <span class="p">(</span><span class="nf">safe?</span> <span class="nv">k</span> <span class="nv">positions</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">flatmap</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">rest-of-queens</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new-row</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">adjoin-position</span> <span class="nv">new-row</span> <span class="nv">k</span> <span class="nv">rest-of-queens</span><span class="p">))</span>
                 <span class="p">(</span><span class="nf">enumerate-interval</span> <span class="mi">1</span> <span class="nv">board-size</span><span class="p">)))</span>
          <span class="p">(</span><span class="nf">queen-cols</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">))))))</span>
  <span class="p">(</span><span class="nf">queen-cols</span> <span class="nv">board-size</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">empty-board</span> <span class="o">'</span><span class="p">())</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">adjoin-position</span> <span class="nv">row</span> <span class="nv">k</span> <span class="nv">rest-of-queens</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">append</span> <span class="nv">rest-of-queens</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">row</span> <span class="nv">k</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">last</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">last</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">safe?</span> <span class="nv">k</span> <span class="nv">positions</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">attack?</span> <span class="nv">q1</span> <span class="nv">q2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">q1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">q2</span><span class="p">)))</span>
         <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">q1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">q2</span><span class="p">)))</span>
                 <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span>  <span class="p">(</span><span class="nb">cadr</span> <span class="nv">q1</span><span class="p">)(</span><span class="nb">cadr</span> <span class="nv">q2</span><span class="p">)))))))</span>

  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">new-queen</span> <span class="p">(</span><span class="nf">last</span> <span class="nv">positions</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">check</span> <span class="nv">i</span> <span class="nv">positions</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">i</span> <span class="nv">k</span><span class="p">)</span> <span class="nv">true</span><span class="p">)</span>
            <span class="p">((</span><span class="nf">attack?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">positions</span><span class="p">)</span> <span class="nv">new-queen</span><span class="p">)</span>
             <span class="p">(</span><span class="nf">check</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">positions</span><span class="p">)))</span>
            <span class="p">(</span><span class="k">else</span> <span class="nv">false</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">check</span> <span class="mi">1</span> <span class="nv">positions</span><span class="p">)))</span></code></pre></figure>

<h4 id="summary">summary</h4>

<p>The key idea to understand <code class="highlighter-rouge">map</code>, <code class="highlighter-rouge">flatmap</code> is to relate it with <a href="http://en.wikibooks.org/wiki/Haskell/Category_theory">Category Theory</a>.
To think about something more abstractly would help a lot in understanding
concrete concepts. Knowing <code class="highlighter-rouge">HOW</code> is the key to finish something, but <code class="highlighter-rouge">WHY</code>
is the key to master something.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/20/sicp-2-2-4" rel="next" title="sicp-2.2.4">sicp-2.2.4</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/17/sicp-2-2-2" rel="previous" title="sicp-2-2-2">sicp-2-2-2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2-2-2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2-2-2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2-2-2</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-17 20:56:36 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="224">2.24</h4>

<p>The interpreter would show <code class="highlighter-rouge">(1 (2 (3 4)))</code>.</p>

<h4 id="225">2.25</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="nb">cadr</span> <span class="p">(</span><span class="nb">caddr</span> <span class="o">'</span><span class="p">(</span><span class="nf">1</span> <span class="mi">3</span> <span class="p">(</span><span class="nf">5</span> <span class="mi">7</span><span class="p">)</span> <span class="mi">9</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">caar</span> <span class="o">'</span><span class="p">((</span><span class="nf">7</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">cadr</span> <span class="p">(</span><span class="nb">cadr</span> <span class="p">(</span><span class="nb">cadr</span> <span class="p">(</span><span class="nb">cadr</span> <span class="p">(</span><span class="nb">cadr</span> <span class="p">(</span><span class="nb">cadr</span> <span class="o">'</span><span class="p">(</span><span class="nf">1</span> <span class="p">(</span><span class="nf">2</span> <span class="p">(</span><span class="nf">3</span> <span class="p">(</span><span class="nf">4</span> <span class="p">(</span><span class="nf">5</span> <span class="p">(</span><span class="nf">6</span> <span class="mi">7</span><span class="p">))))))))))))</span></code></pre></figure>

<h4 id="226">2.26</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">y</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">))</span>

<span class="p">(</span><span class="nb">append</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
<span class="nv">-&gt;</span>
<span class="p">(</span><span class="nf">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">)</span>

<span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
<span class="nv">-&gt;</span>
<span class="p">((</span><span class="nf">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">)</span>

<span class="p">(</span><span class="nb">list</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
<span class="nv">-&gt;</span>
<span class="p">((</span><span class="nf">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nf">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">))</span></code></pre></figure>

<h4 id="227">2.27</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deep-reverse</span> <span class="nv">items</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">pair?</span> <span class="nv">items</span><span class="p">)</span>
         <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">items</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">append</span>
             <span class="p">(</span><span class="nf">deep-reverse</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">items</span><span class="p">))</span>
             <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">deep-reverse</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">items</span><span class="p">))))</span>
           <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nf">deep-reverse</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">items</span><span class="p">))</span>
                   <span class="p">(</span><span class="nf">deep-reverse</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">items</span><span class="p">)))))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">items</span><span class="p">)</span>
            <span class="nv">null</span>
            <span class="p">(</span><span class="nb">list</span> <span class="nv">items</span><span class="p">)))))</span></code></pre></figure>

<h4 id="228">2.28</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deep-reverse</span> <span class="nv">items</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">pair?</span> <span class="nv">items</span><span class="p">)</span>
         <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">items</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">append</span>
             <span class="p">(</span><span class="nf">deep-reverse</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">items</span><span class="p">))</span>
             <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">deep-reverse</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">items</span><span class="p">))))</span>
           <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nf">deep-reverse</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">items</span><span class="p">))</span>
                   <span class="p">(</span><span class="nf">deep-reverse</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">items</span><span class="p">)))))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">items</span><span class="p">)</span>
            <span class="nv">null</span>
            <span class="p">(</span><span class="nb">list</span> <span class="nv">items</span><span class="p">)))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fringe</span> <span class="nv">tree</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">pair?</span> <span class="nv">tree</span><span class="p">)</span>
         <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nf">fringe</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">tree</span><span class="p">))</span>
                 <span class="p">(</span><span class="nf">fringe</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">tree</span><span class="p">))))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">tree</span><span class="p">)</span>
            <span class="nv">null</span>
            <span class="p">(</span><span class="nb">list</span> <span class="nv">tree</span><span class="p">)))))</span></code></pre></figure>

<h4 id="229">2.29</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-mobile</span> <span class="nv">left</span> <span class="nv">right</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">list</span> <span class="nv">left</span> <span class="nv">right</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-branch</span> <span class="nv">length</span> <span class="nv">structure</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">list</span> <span class="nv">length</span> <span class="nv">structure</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">mobile</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">car</span> <span class="nv">mobile</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">mobile</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">cadr</span> <span class="nv">mobile</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">branch-length</span> <span class="nv">branch</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">car</span> <span class="nv">branch</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">branch-structure</span> <span class="nv">branch</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">cadr</span> <span class="nv">branch</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">total-weight</span> <span class="nv">mobile</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">branch-weight</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">mobile</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">branch-weight</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">mobile</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">branch-weight</span> <span class="nv">branch</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">([</span><span class="nf">structure</span> <span class="p">(</span><span class="nf">branch-structure</span> <span class="nv">branch</span><span class="p">)])</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">structure</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">total-weight</span> <span class="nv">structure</span><span class="p">)</span>
      <span class="nv">structure</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">balanced?</span> <span class="nv">mobile</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">mobile</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let*</span> <span class="p">([</span><span class="nf">left</span> <span class="p">(</span><span class="nf">left-branch</span> <span class="nv">mobile</span><span class="p">)]</span>
          <span class="p">[</span><span class="nf">right</span> <span class="p">(</span><span class="nf">right-branch</span> <span class="nv">mobile</span><span class="p">)]</span>
          <span class="p">[</span><span class="nf">left-mobile</span> <span class="p">(</span><span class="nf">branch-structure</span> <span class="nv">left</span><span class="p">)]</span>
          <span class="p">[</span><span class="nf">right-mobile</span> <span class="p">(</span><span class="nf">branch-structure</span> <span class="nv">right</span><span class="p">)])</span>
      <span class="p">(</span><span class="k">and</span>
        <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">*</span>
             <span class="p">(</span><span class="nf">branch-length</span> <span class="nv">left</span><span class="p">)</span>
             <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">left-mobile</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">total-weight</span> <span class="nv">left-mobile</span><span class="p">)</span>
               <span class="nv">left-mobile</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">*</span>
             <span class="p">(</span><span class="nf">branch-length</span> <span class="nv">right</span><span class="p">)</span>
             <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">right-mobile</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">total-weight</span> <span class="nv">right-mobile</span><span class="p">)</span>
              <span class="nv">right-mobile</span><span class="p">)))</span>
        <span class="p">(</span><span class="nf">balanced?</span> <span class="nv">left-mobile</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">balanced?</span> <span class="nv">right-mobile</span><span class="p">)))</span>
    <span class="no">#t</span><span class="p">))</span></code></pre></figure>

<h4 id="230">2.30</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">scale-tree</span> <span class="nv">tree</span> <span class="nv">factor</span><span class="p">)</span>
   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">tree</span><span class="p">)</span> <span class="nv">null</span><span class="p">)</span>
         <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">tree</span><span class="p">))</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">tree</span> <span class="nv">factor</span><span class="p">))</span>
         <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">scale-tree</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">tree</span><span class="p">)</span> <span class="nv">factor</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">scale-tree</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">tree</span><span class="p">)</span> <span class="nv">factor</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">scale-tree</span> <span class="nv">tree</span> <span class="nv">factor</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">sub-tree</span><span class="p">)</span>
          <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">sub-tree</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">scale-tree</span> <span class="nv">sub-tree</span> <span class="nv">factor</span><span class="p">)</span>
              <span class="p">(</span><span class="nb">*</span> <span class="nv">sub-tree</span> <span class="nv">factor</span><span class="p">)))</span>
        <span class="nv">tree</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square-tree</span> <span class="nv">tree</span><span class="p">)</span>
   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">tree</span><span class="p">)</span> <span class="nv">null</span><span class="p">)</span>
         <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">tree</span><span class="p">))</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">tree</span> <span class="nv">tree</span><span class="p">))</span>
         <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">square-tree</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">tree</span><span class="p">))</span>
                     <span class="p">(</span><span class="nf">square-tree</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">tree</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square-tree</span> <span class="nv">tree</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">sub-tree</span><span class="p">)</span>
          <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">sub-tree</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">square-tree</span> <span class="nv">sub-tree</span><span class="p">)</span>
              <span class="p">(</span><span class="nb">*</span> <span class="nv">sub-tree</span> <span class="nv">sub-tree</span><span class="p">)))</span>
        <span class="nv">tree</span><span class="p">))</span></code></pre></figure>

<h4 id="231">2.31</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">tree-map</span> <span class="nv">f</span> <span class="nv">tree</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">null?</span> <span class="nv">tree</span><span class="p">)</span> <span class="nv">null</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">tree</span><span class="p">))</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">tree</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">tree-map</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">tree</span><span class="p">))</span>
                    <span class="p">(</span><span class="nf">tree-map</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">tree</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">tree-map</span> <span class="nv">f</span> <span class="nv">tree</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">map</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">sub-tree</span><span class="p">)</span>
         <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">sub-tree</span><span class="p">)</span> <span class="p">(</span><span class="nf">tree-map</span> <span class="nv">f</span> <span class="nv">sub-tree</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">sub-tree</span><span class="p">)))</span>
       <span class="nv">tree</span><span class="p">))</span></code></pre></figure>

<h4 id="232">2.32</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">subsets</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">s</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">list</span> <span class="nv">null</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">([</span><span class="nf">rest</span> <span class="p">(</span><span class="nf">subsets</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">s</span><span class="p">))])</span>
        <span class="p">(</span><span class="nb">append</span> <span class="nv">rest</span>
                <span class="p">(</span><span class="nb">map</span>
                  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
                    <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">s</span><span class="p">))</span> <span class="nv">x</span><span class="p">))</span>
                  <span class="nv">rest</span><span class="p">)))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/18/sicp-2-2-3" rel="next" title="sicp-2.2.3">sicp-2.2.3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/17/sicp-2-2-1" rel="previous" title="sicp-2.2.1">sicp-2.2.1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2.2.1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2.2.1" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2.2.1</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-17 07:42:44 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="217">2.17</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">last-pair</span> <span class="nv">lst</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">([</span><span class="nf">second</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lst</span><span class="p">)])</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">second</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">car</span> <span class="nv">lst</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">last-pair</span> <span class="nv">second</span><span class="p">))))</span></code></pre></figure>

<h4 id="218">2.18</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">append</span> <span class="nv">list1</span> <span class="nv">list2</span><span class="p">)</span>
   <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">list1</span><span class="p">)</span>
       <span class="nv">list2</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">list1</span><span class="p">)</span> <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">list1</span><span class="p">)</span> <span class="nv">list2</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">reverse</span> <span class="nv">lst</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">lst</span><span class="p">)</span>
    <span class="nv">lst</span>
    <span class="p">(</span><span class="nb">append</span>
      <span class="p">(</span><span class="nb">reverse</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lst</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lst</span><span class="p">)))))</span></code></pre></figure>

<h4 id="219">2.19</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">us-coins</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">50</span> <span class="mi">25</span> <span class="mi">10</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">uk-coins</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">100</span> <span class="mi">50</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="nv">coin-values</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">no-more?</span> <span class="nv">coin-values</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span>
         <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span>
                <span class="p">(</span><span class="nf">except-first-denomination</span> <span class="nv">coin-values</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">amount</span>
                   <span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">coin-values</span><span class="p">))</span>
                <span class="nv">coin-values</span><span class="p">)))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">no-more?</span> <span class="nv">coin-values</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">null?</span> <span class="nv">coin-values</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">except-first-denomination</span> <span class="nv">coin-values</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cdr</span> <span class="nv">coin-values</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">coin-values</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">car</span> <span class="nv">coin-values</span><span class="p">))</span></code></pre></figure>

<p>As this procedure does not rely not on the order, it would not affect the final answer.</p>

<h4 id="220">2.20</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">same-parity</span> <span class="nv">a</span> <span class="o">.</span> <span class="nv">z</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">f</span> <span class="nv">left</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">left</span><span class="p">)</span>
      <span class="nv">left</span>
      <span class="p">(</span><span class="k">let*</span> <span class="p">([</span><span class="nf">first</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">left</span><span class="p">)]</span>
            <span class="p">[</span><span class="nf">second</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">left</span><span class="p">)]</span>
            <span class="p">[</span><span class="nf">temp</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">f</span> <span class="nv">second</span><span class="p">)])</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">first</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="nv">first</span> <span class="nv">temp</span><span class="p">)</span>
          <span class="nv">temp</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">iter</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">remainder</span> <span class="nv">a</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">remainder</span> <span class="nv">x</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">cons</span> <span class="nv">a</span> <span class="nv">z</span><span class="p">)))</span></code></pre></figure>

<h4 id="221">2.21</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square-list</span> <span class="nv">items</span><span class="p">)</span>
   <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">items</span><span class="p">)</span>
       <span class="nv">null</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">items</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">square-list</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">items</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square-list</span> <span class="nv">items</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">map</span> <span class="nv">square</span> <span class="nv">items</span><span class="p">))</span></code></pre></figure>

<h4 id="222">2.22</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square-list</span> <span class="nv">items</span><span class="p">)</span>
   <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">things</span> <span class="nv">answer</span><span class="p">)</span>
     <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">things</span><span class="p">)</span>
         <span class="nv">answer</span>
         <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">things</span><span class="p">)</span>
               <span class="p">(</span><span class="nb">append</span> <span class="nv">answer</span>
                       <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">things</span><span class="p">)))))))</span>
   <span class="p">(</span><span class="nf">iter</span> <span class="nv">items</span> <span class="nv">null</span><span class="p">))</span></code></pre></figure>

<p>The correct way is to use <code class="highlighter-rouge">append</code> to add it into the last posision of the nested <code class="highlighter-rouge">cons</code>.</p>

<h4 id="223">2.23</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">for-each</span> <span class="nv">proc</span> <span class="nv">items</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span>
    <span class="p">((</span><span class="nb">null?</span> <span class="nv">items</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
    <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">proc</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">items</span><span class="p">))</span>
          <span class="p">(</span><span class="nb">for-each</span> <span class="nv">proc</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">items</span><span class="p">)))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/17/sicp-2-2-2" rel="next" title="sicp-2-2-2">sicp-2-2-2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/17/sicp-2-1-4" rel="previous" title="sicp-2.1.4">sicp-2.1.4</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2.1.4 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2.1.4" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2.1.4</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-17 06:45:26 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="27">2.7</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">add-interval</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">make-interval</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">y</span><span class="p">))</span>
                  <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">y</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">mul-interval</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
   <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">p1</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">y</span><span class="p">)))</span>
         <span class="p">(</span><span class="nf">p2</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">y</span><span class="p">)))</span>
         <span class="p">(</span><span class="nf">p3</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">y</span><span class="p">)))</span>
         <span class="p">(</span><span class="nf">p4</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">y</span><span class="p">))))</span>
     <span class="p">(</span><span class="nf">make-interval</span> <span class="p">(</span><span class="nb">min</span> <span class="nv">p1</span> <span class="nv">p2</span> <span class="nv">p3</span> <span class="nv">p4</span><span class="p">)</span>
                    <span class="p">(</span><span class="nb">max</span> <span class="nv">p1</span> <span class="nv">p2</span> <span class="nv">p3</span> <span class="nv">p4</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">div-interval</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">mul-interval</span> <span class="nv">x</span>
                 <span class="p">(</span><span class="nf">make-interval</span> <span class="p">(</span><span class="nb">/</span> <span class="mf">1.0</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">y</span><span class="p">))</span>
                                <span class="p">(</span><span class="nb">/</span> <span class="mf">1.0</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">y</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-interval</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">upper-bound</span> <span class="nv">cdr</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">lower-bound</span> <span class="nv">car</span><span class="p">)</span></code></pre></figure>

<h4 id="28">2.8</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sub-interval</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">make-interval</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">y</span><span class="p">))</span>
                  <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">y</span><span class="p">))))</span></code></pre></figure>

<h4 id="210">2.10</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">span-zero?</span> <span class="nv">interval</span><span class="p">)</span>
  <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">&gt;=</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">interval</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">&lt;=</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">interval</span><span class="p">)</span> <span class="mi">0</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">div-interval</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">span-zero?</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">error</span> <span class="s">"divides zero"</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">mul-interval</span> <span class="nv">x</span>
                 <span class="p">(</span><span class="nf">make-interval</span> <span class="p">(</span><span class="nb">/</span> <span class="mf">1.0</span> <span class="p">(</span><span class="nf">upper-bound</span> <span class="nv">y</span><span class="p">))</span>
                                <span class="p">(</span><span class="nb">/</span> <span class="mf">1.0</span> <span class="p">(</span><span class="nf">lower-bound</span> <span class="nv">y</span><span class="p">))))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/17/sicp-2-2-1" rel="next" title="sicp-2.2.1">sicp-2.2.1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/16/sicp-2-1-1-2-1-3" rel="previous" title="sicp-2.1.1-2.1.3">sicp-2.1.1-2.1.3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-2.1.1-2.1.3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-2.1.1-2.1.3" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-2.1.1-2.1.3</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-16 19:31:58 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="21">2.1</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">number</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">denom</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-rat</span> <span class="nv">n</span> <span class="nv">d</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">g</span> <span class="p">(</span><span class="nb">gcd</span> <span class="nv">n</span> <span class="nv">d</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">d</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">n</span> <span class="nv">g</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">d</span> <span class="nv">g</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">g</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">d</span><span class="p">)</span> <span class="nv">g</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">print-rat</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">newline</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">display</span> <span class="p">(</span><span class="nf">number</span> <span class="nv">x</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">display</span> <span class="s">"/"</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">display</span> <span class="p">(</span><span class="nf">denom</span> <span class="nv">x</span><span class="p">)))</span></code></pre></figure>

<h4 id="22">2.2</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">print-point</span> <span class="nv">p</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">newline</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">display</span> <span class="s">"("</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">display</span> <span class="p">(</span><span class="nf">x-point</span> <span class="nv">p</span><span class="p">))</span>
   <span class="p">(</span><span class="nb">display</span> <span class="s">","</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">display</span> <span class="p">(</span><span class="nf">y-point</span> <span class="nv">p</span><span class="p">))</span>
   <span class="p">(</span><span class="nb">display</span> <span class="s">")"</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-segment</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">start-segment</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">s</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">end-segment</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">s</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-point</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">x-point</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">y-point</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">p</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">midpoint-segment</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">make-point</span>
    <span class="p">(</span><span class="nb">/</span>
      <span class="p">(</span><span class="nb">+</span>
        <span class="p">(</span><span class="nf">x-point</span> <span class="p">(</span><span class="nf">start-segment</span> <span class="nv">s</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">x-point</span> <span class="p">(</span><span class="nf">end-segment</span> <span class="nv">s</span><span class="p">)))</span>
      <span class="mi">2</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/</span>
      <span class="p">(</span><span class="nb">+</span>
        <span class="p">(</span><span class="nf">y-point</span> <span class="p">(</span><span class="nf">start-segment</span> <span class="nv">s</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">y-point</span> <span class="p">(</span><span class="nf">end-segment</span> <span class="nv">s</span><span class="p">)))</span>
      <span class="mi">2</span><span class="p">)))</span></code></pre></figure>

<h4 id="23">2.3</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="c1">;define rectangle using two points</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-rec</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rect-width</span> <span class="nv">r</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span>
         <span class="p">(</span><span class="nf">x-point</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">r</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">x-point</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">r</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rect-height</span> <span class="nv">r</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span>
         <span class="p">(</span><span class="nf">y-point</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">r</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">y-point</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">r</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rect-perimeter</span> <span class="nv">r</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">rect-width</span> <span class="nv">r</span><span class="p">)</span> <span class="p">(</span><span class="nf">rect-height</span> <span class="nv">r</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rect-area</span> <span class="nv">r</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">rect-width</span> <span class="nv">r</span><span class="p">)</span> <span class="p">(</span><span class="nf">rect-height</span> <span class="nv">r</span><span class="p">)))</span>

<span class="c1">;define rectangle using base point, width and height</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-rect</span> <span class="nv">p</span> <span class="nv">w</span> <span class="nv">h</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">p</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">w</span> <span class="nv">h</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rect-width</span> <span class="nv">r</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">r</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">rect-height</span> <span class="nv">r</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">r</span><span class="p">)))</span></code></pre></figure>

<h4 id="24">2.4</h4>

<p><code class="highlighter-rouge">Lambda</code> is the ultimate way to represent everyting.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">proc-cons</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">m</span><span class="p">)</span> <span class="p">(</span><span class="nf">m</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">proc-car</span> <span class="nv">z</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">z</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">p</span> <span class="nv">q</span><span class="p">)</span> <span class="nv">p</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">proc-cdr</span> <span class="nv">z</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">z</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">p</span> <span class="nv">q</span><span class="p">)</span> <span class="nv">q</span><span class="p">)))</span></code></pre></figure>

<h4 id="25">2.5</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">math-cons</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nb">expt</span> <span class="mi">2</span> <span class="nv">a</span><span class="p">)</span>
     <span class="p">(</span><span class="nb">expt</span> <span class="mi">3</span> <span class="nv">b</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">math-car</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">get-degree</span> <span class="nv">s</span> <span class="mi">2</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">math-cdr</span> <span class="nv">s</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">get-degree</span> <span class="nv">s</span> <span class="mi">3</span><span class="p">))</span></code></pre></figure>

<h4 id="26">2.6</h4>

<p>Quote from <a href="http://en.wikipedia.org/w/index.php?title=Church_encoding&amp;redirect=no">wiki</a>:</p>

<blockquote>
  <p>Church numerals are the representations of <code class="highlighter-rouge">natural numbers</code> under Church encoding.
The higher-order function that represents natural number <code class="highlighter-rouge">n</code> is a function that maps any function <code class="highlighter-rouge">f</code> to its <code class="highlighter-rouge">n-fold</code> composition.</p>
</blockquote>

<p>To make it more interesting, <code class="highlighter-rouge">church-multi</code> method is added in as well.</p>

<p><code class="highlighter-rouge">Lambda calculas</code> is really powerful.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">zero</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">f</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">add-1</span> <span class="nv">n</span><span class="p">)</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">f</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="p">((</span><span class="nf">n</span> <span class="nv">f</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">one</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">f</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">two</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">f</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">church-add</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">f</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">((</span><span class="nf">a</span> <span class="nv">f</span><span class="p">)</span> <span class="p">((</span><span class="nf">b</span> <span class="nv">f</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">church-multi</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">f</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">((</span><span class="nf">a</span> <span class="p">(</span><span class="nf">b</span> <span class="nv">f</span><span class="p">))</span> <span class="nv">x</span><span class="p">))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/17/sicp-2-1-4" rel="next" title="sicp-2.1.4">sicp-2.1.4</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/16/1-3-4" rel="previous" title="1.3.4">1.3.4</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>1.3.4 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library 1.3.4" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>1.3.4</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-16 00:39:53 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<blockquote>
  <p>In general, programming languages impose restrictions on the ways in which computational elements can be manipulated. Elements with the fewest restrictions are said to have first-class status. Some of the ``rights and privileges’’ of first-class elements are:</p>

  <ul>
    <li>They may be named by variables.</li>
    <li>They may be passed as arguments to procedures.</li>
    <li>They may be returned as the results of procedures.</li>
    <li>They may be included in data structures.</li>
  </ul>
</blockquote>

<h4 id="140">1.40</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="nv">tolerance</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">f</span> <span class="nv">first-guess</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">))</span> <span class="nv">tolerance</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">try</span> <span class="nv">guess</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">next</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">guess</span> <span class="nv">next</span><span class="p">)</span>
          <span class="nv">next</span>
          <span class="p">(</span><span class="nf">try</span> <span class="nv">next</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">try</span> <span class="nv">first-guess</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">dx</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">deriv</span> <span class="nv">g</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nf">g</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="nv">dx</span><span class="p">))</span> <span class="p">(</span><span class="nf">g</span> <span class="nv">x</span><span class="p">))</span>
       <span class="nv">dx</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">newton-transform</span> <span class="nv">g</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">-</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nf">g</span> <span class="nv">x</span><span class="p">)</span> <span class="p">((</span><span class="nf">deriv</span> <span class="nv">g</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">newtons-method</span> <span class="nv">g</span> <span class="nv">guess</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="nf">newton-transform</span> <span class="nv">g</span><span class="p">)</span> <span class="nv">guess</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cube</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cubic</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">cube</span> <span class="nv">x</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">*</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">))</span>
       <span class="p">(</span><span class="nb">*</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">)</span>
       <span class="nv">c</span><span class="p">)))</span>

<span class="nv">-&gt;</span> <span class="p">(</span><span class="nf">newtons-method</span> <span class="p">(</span><span class="nf">cubic</span> <span class="mi">8</span> <span class="mi">16</span> <span class="mi">10</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="mf">-5.3652300134140924</span></code></pre></figure>

<h4 id="141">1.41</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">double</span> <span class="nv">f</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">inc</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="mi">1</span><span class="p">))</span>

<span class="nv">-&gt;</span> <span class="p">((</span><span class="nf">double</span> <span class="nv">inc</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">3</span>

<span class="nv">-&gt;</span> <span class="p">(((</span><span class="nf">double</span> <span class="p">(</span><span class="nf">double</span> <span class="nv">double</span><span class="p">))</span> <span class="nv">inc</span><span class="p">)</span> <span class="mi">5</span><span class="p">)</span>
<span class="mi">21</span>

<span class="nv">It</span> <span class="nv">increases</span> <span class="nv">$2^2^2$</span><span class="o">.</span></code></pre></figure>

<h4 id="142">1.42</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">compose</span> <span class="nv">f</span> <span class="nv">g</span><span class="p">)</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nf">g</span> <span class="nv">x</span><span class="p">))))</span></code></pre></figure>

<h4 id="143">1.43</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">repeated</span> <span class="nv">f</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">x</span> <span class="mi">1</span><span class="p">)</span>
      <span class="nv">f</span>
      <span class="p">(</span><span class="nf">compose</span> <span class="nv">f</span> <span class="p">(</span><span class="nf">repeated</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">x</span> <span class="mi">1</span><span class="p">)))))</span></code></pre></figure>

<h4 id="144">1.44</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">smooth</span> <span class="nv">f</span> <span class="nv">dx</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="nv">dx</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">x</span> <span class="nv">dx</span><span class="p">)))</span>
       <span class="mi">3</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">n-fold-smooth</span> <span class="nv">f</span> <span class="nv">dx</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">repeated</span> <span class="p">(</span><span class="nf">smooth</span> <span class="nv">f</span> <span class="nv">dx</span><span class="p">)</span> <span class="nv">n</span><span class="p">))</span></code></pre></figure>

<h4 id="146">1.46</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iterative-improve</span> <span class="nv">good-enough?</span> <span class="nv">improve</span><span class="p">)</span>
   <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">guess</span><span class="p">)</span>
     <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">guess</span><span class="p">)</span>
         <span class="nv">guess</span>
         <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">guess</span><span class="p">))))</span>
   <span class="nv">iter</span><span class="p">)</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/16/sicp-2-1-1-2-1-3" rel="next" title="sicp-2.1.1-2.1.3">sicp-2.1.1-2.1.3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/15/1-3-2-1-3-3" rel="previous" title="SICP 1.3.2-1.3.3">SICP 1.3.2-1.3.3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>SICP 1.3.2-1.3.3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library SICP 1.3.2-1.3.3" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>SICP 1.3.2-1.3.3</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-15 20:13:00 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="134">1.34</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">g</span><span class="p">)</span> <span class="p">(</span><span class="nf">g</span> <span class="mi">2</span><span class="p">))</span>

<span class="p">(</span><span class="nf">f</span> <span class="nv">f</span><span class="p">)</span>
<span class="nv">--&gt;</span>
<span class="p">(</span><span class="nf">f</span> <span class="mi">2</span><span class="p">)</span>
<span class="nv">--&gt;</span>
<span class="p">(</span><span class="nf">2</span> <span class="mi">2</span><span class="p">)</span></code></pre></figure>

<h4 id="135">1.35</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">f</span> <span class="nv">first-guess</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">))</span> <span class="nv">tolerance</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">try</span> <span class="nv">guess</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">next</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">guess</span> <span class="nv">next</span><span class="p">)</span>
          <span class="nv">next</span>
          <span class="p">(</span><span class="nf">try</span> <span class="nv">next</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">try</span> <span class="nv">first-guess</span><span class="p">))</span>

<span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">/</span> <span class="mi">1</span> <span class="nv">x</span><span class="p">)))</span> <span class="mf">1.0</span><span class="p">)</span></code></pre></figure>

<h4 id="136">1.36</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">f</span> <span class="nv">first-guess</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">v1</span> <span class="nv">v2</span><span class="p">))</span> <span class="nv">tolerance</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">try</span> <span class="nv">guess</span> <span class="nv">tried</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display</span> <span class="nv">guess</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">newline</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">next</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">close-enough?</span> <span class="nv">guess</span> <span class="nv">next</span><span class="p">)</span>
          <span class="p">(</span><span class="k">begin</span>
            <span class="p">(</span><span class="nb">display</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">tried</span> <span class="mi">1</span><span class="p">))</span>
            <span class="p">(</span><span class="nb">newline</span><span class="p">)</span>
            <span class="nv">next</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">try</span> <span class="nv">next</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">tried</span> <span class="mi">1</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">try</span> <span class="nv">first-guess</span> <span class="mi">1</span><span class="p">))</span>

<span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">log</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">(</span><span class="nb">log</span> <span class="nv">x</span><span class="p">)))</span> <span class="mf">2.0</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">average</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span>

<span class="p">(</span><span class="nf">fixed-point</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">average</span> <span class="nv">x</span>
                                  <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">log</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">(</span><span class="nb">log</span> <span class="nv">x</span><span class="p">))))</span> <span class="mf">2.0</span><span class="p">)</span></code></pre></figure>

<p>If order to display the iterate numbers, a new parameter <code class="highlighter-rouge">tried</code> is added in.
A new syntax <code class="highlighter-rouge">begin</code> is used in order to run multiple commands sequencely, which will
return the last expression’s value as the result.</p>

<p>The simple version will run <code class="highlighter-rouge">35</code> times, while the average version will only run <code class="highlighter-rouge">10</code> times.</p>

<h4 id="137">1.37</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cont-frac</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">k</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">x</span> <span class="nv">k</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">x</span><span class="p">)</span>
         <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">d</span> <span class="nv">x</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="mi">1</span><span class="p">))))</span>
      <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">x</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">d</span> <span class="nv">x</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="mi">1</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cont-frac-iter</span> <span class="nv">n</span> <span class="nv">d</span> <span class="nv">k</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">k</span> <span class="nv">result</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">0</span><span class="p">)</span>
      <span class="nv">result</span>
      <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">d</span> <span class="nv">k</span><span class="p">)</span>
               <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">k</span><span class="p">)</span>
                  <span class="nv">result</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">k</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">k</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">d</span> <span class="nv">k</span><span class="p">))))</span></code></pre></figure>

<h4 id="138">1.38</h4>

<p>The key lies in finding out a math expression for</p>

<p><code class="highlighter-rouge">1, 2, 1, 1, 4, 1, 1, 6, 1, 1, 8,...</code></p>

<script type="math/tex; mode=display">% <![CDATA[
D(i) = \begin{cases}2(i+1)/3 & \text{(i+1) mod 3=0} \\ 1 & \text{otherwise} \end{cases} %]]></script>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">d</span> <span class="nv">i</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">0</span>
              <span class="p">(</span><span class="nb">remainder</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">i</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">3</span><span class="p">)))</span>
    <span class="mi">1</span>
    <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span>
       <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">i</span> <span class="mi">1</span><span class="p">)</span>
          <span class="mi">3</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">euler-e</span>
  <span class="p">(</span><span class="nb">+</span> <span class="mi">2</span> <span class="p">(</span><span class="nf">cont-frac</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="mf">1.0</span><span class="p">)</span> <span class="nv">d</span> <span class="mi">10</span><span class="p">)))</span></code></pre></figure>

<h4 id="139">1.39</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">tan-cf</span> <span class="nv">x</span> <span class="nv">k</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">cont-frac</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">)</span>
                  <span class="nv">x</span>
                  <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span> <span class="nv">a</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
    <span class="nv">k</span><span class="p">))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/16/1-3-4" rel="next" title="1.3.4">1.3.4</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/14/sicp-131" rel="previous" title="sicp-1.31">sicp-1.31</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-1.31 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-1.31" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-1.31</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-14 08:22:48 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="129">1.29</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
      <span class="mi">0</span>
      <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">sum</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">integral</span> <span class="nv">f</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">dx</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">add-dx</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="nv">dx</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">sum</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">dx</span> <span class="mf">2.0</span><span class="p">))</span> <span class="nv">add-dx</span> <span class="nv">b</span><span class="p">)</span>
     <span class="nv">dx</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cube</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="nf">integral</span> <span class="nv">cube</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">simpson-integral</span> <span class="nv">f</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="nv">h</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">n</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">current</span> <span class="nv">k</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span>
                         <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="nv">h</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">simpson-term</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">define</span> <span class="nv">point</span> <span class="p">(</span><span class="nf">current</span> <span class="nv">x</span><span class="p">))</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">x</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">x</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">point</span><span class="p">))</span>
          <span class="p">((</span><span class="nb">even?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span>
                        <span class="p">(</span><span class="nf">f</span> <span class="nv">point</span><span class="p">)))</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">4</span>
                   <span class="p">(</span><span class="nf">f</span> <span class="nv">point</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nb">*</span> <span class="nv">h</span>
     <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nf">sum</span> <span class="nv">simpson-term</span> <span class="mi">0</span> <span class="nv">next</span> <span class="nv">n</span><span class="p">)</span>
        <span class="mi">3</span><span class="p">)))</span></code></pre></figure>

<h4 id="130">1.30</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum-iter</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
      <span class="nv">result</span>
      <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="mi">0</span><span class="p">))</span></code></pre></figure>

<h4 id="131">1.31</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">pi-term</span> <span class="nv">a</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="nv">norm</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span>
                  <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span> <span class="nv">a</span><span class="p">)))</span>
  <span class="p">(</span><span class="nb">*</span>
    <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">-</span>
         <span class="p">(</span><span class="nf">square</span> <span class="nv">norm</span><span class="p">)</span>
         <span class="mi">1</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">square</span> <span class="nv">norm</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">wallis-pi</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">*</span> <span class="mf">4.0</span>
     <span class="p">(</span><span class="nf">product</span> <span class="nv">pi-term</span> <span class="mi">1</span> <span class="nv">inc</span> <span class="nv">n</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">product-iter</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
      <span class="nv">result</span>
      <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">))</span></code></pre></figure>

<h4 id="132">1.32</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">null-value</span>
    <span class="p">(</span><span class="nf">combiner</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">+</span> <span class="mi">0</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">*</span> <span class="mi">1</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">result</span>
      <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">combiner</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">null-value</span><span class="p">))</span></code></pre></figure>

<h4 id="133">1.33</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span> <span class="nv">filter</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">null-value</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">filter</span> <span class="nv">a</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">combiner</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span> <span class="nv">filter</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span> <span class="nv">filter</span><span class="p">))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/15/1-3-2-1-3-3" rel="next" title="SICP 1.3.2-1.3.3">SICP 1.3.2-1.3.3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/13/sicp-126" rel="previous" title="sicp-126">sicp-126</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-126 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-126" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-126</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-13 19:50:38 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="121">1.21</h4>

<figure class="highlight"><pre><code class="language-scm" data-lang="scm">(define (square x) (* x x))
(define (smallest-divisor n) (find-divisor n 2))
(define (find-divisor n test-divisor)
  (cond ((&gt; (square test-divisor) n) n)
        ((divides? test-divisor n) test-divisor)
        (else (find-divisor n (+ test-divisor 1)))))
(define (divides? a b) (= (remainder b a) 0))</code></pre></figure>

<p>199 and 1999 are primes, 19999’s smallest divisor is 7</p>

<h4 id="122">1.22</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="nv">test-divisor</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">&gt;</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">test-divisor</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">divides?</span> <span class="nv">test-divisor</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">test-divisor</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">find-divisor</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">test-divisor</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">divides?</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">remainder</span> <span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">even?</span> <span class="nv">exp</span><span class="p">)</span>
         <span class="p">(</span><span class="nb">remainder</span>
           <span class="p">(</span><span class="nf">square</span> <span class="p">(</span><span class="nf">expomod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
           <span class="nv">m</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">remainder</span>
            <span class="p">(</span><span class="nb">*</span> <span class="nv">base</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
            <span class="nv">m</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fermat-test</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">try-it</span> <span class="nv">a</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">a</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">try-it</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="p">(</span><span class="nf">random</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fast-prime?</span> <span class="nv">n</span> <span class="nv">times</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">times</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">true</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">fermat-test</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">fast-prime?</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">times</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="p">(</span><span class="k">else</span> <span class="nv">false</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">timed-prime-test</span> <span class="nv">n</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">newline</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">display</span> <span class="nv">n</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">start-prime-test</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">start-prime-test</span> <span class="nv">n</span> <span class="nv">start-time</span><span class="p">)</span>
   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">prime?</span> <span class="nv">n</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">report-prime</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nf">runtime</span><span class="p">)</span> <span class="nv">start-time</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">report-prime</span> <span class="nv">elapsed-time</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">display</span> <span class="s">" *** "</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">display</span> <span class="nv">elapsed-time</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">prime?</span> <span class="nv">n</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">smallest-divisor</span> <span class="nv">n</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">search-for-primes</span> <span class="nv">start</span> <span class="nv">end</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">even?</span> <span class="nv">start</span><span class="p">)</span> <span class="p">(</span><span class="nf">search-for-primes</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">start</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">end</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">&lt;=</span> <span class="nv">start</span> <span class="nv">end</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">timed-prime-test</span> <span class="nv">start</span><span class="p">)</span> <span class="p">(</span><span class="nf">search-for-primes</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">start</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">end</span><span class="p">)))))</span></code></pre></figure>

<p>The tricky part is how to run evaluate expressions sequencely.
According to <a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._cond%29%29">cond expressio</a>, the <code class="highlighter-rouge">then-body</code>s are evaluated in order and the results of the last <code class="highlighter-rouge">then body</code> provide the result
for the whole <code class="highlighter-rouge">cond</code> form.</p>

<h4 id="126">1.26</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
         <span class="p">((</span><span class="nb">even?</span> <span class="nv">exp</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">remainder</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
                     <span class="nv">m</span><span class="p">))</span>
         <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">remainder</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">base</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
                     <span class="nv">m</span><span class="p">))))</span></code></pre></figure>

<p>The time complexity of this code is
$\sum_{i=0}^{log_n} 2^n = O(n)$</p>

<h4 id="127">1.27</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fixed-fermat-test</span> <span class="nv">n</span> <span class="nv">a</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">a</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fermat-full</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nf">fixed-fermat-test</span> <span class="nv">n</span> <span class="nv">a</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span></code></pre></figure>

<h4 id="128">1.28</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">MR-expmod</span> <span class="nv">base</span> <span class="nv">exp</span> <span class="nv">m</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">exp</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">even?</span> <span class="nv">exp</span><span class="p">)</span>
         <span class="p">(</span><span class="k">let*</span> <span class="p">([</span><span class="nf">part</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">exp</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">m</span><span class="p">)]</span>
                <span class="p">[</span><span class="nf">ans</span> <span class="p">(</span><span class="nb">remainder</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">part</span><span class="p">)</span> <span class="nv">m</span><span class="p">)])</span>
           <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">part</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">part</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">m</span> <span class="mi">1</span><span class="p">))))</span>
                    <span class="p">(</span><span class="nb">=</span> <span class="nv">ans</span> <span class="mi">1</span><span class="p">))</span>
             <span class="mi">0</span>
             <span class="nv">ans</span><span class="p">)))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">remainder</span>
            <span class="p">(</span><span class="nb">*</span> <span class="nv">base</span> <span class="p">(</span><span class="nf">expmod</span> <span class="nv">base</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">exp</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>
            <span class="nv">m</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">MR-test</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">try-it</span> <span class="nv">a</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nf">MR-expmod</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">try-it</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">2</span> <span class="p">(</span><span class="nf">random</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)))))</span></code></pre></figure>

<p>Used <code class="highlighter-rouge">let*</code> to deal with the local variable.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/14/sicp-131" rel="next" title="sicp-1.31">sicp-1.31</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/12/sicp-section-124-125" rel="previous" title="sicp-124-125">sicp-124-125</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>sicp-124-125 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library sicp-124-125" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>sicp-124-125</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-12 23:17:32 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="116">1.16</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="o">#</span><span class="nv">lang</span> <span class="nv">planet</span> <span class="nv">neil/sicp</span>

 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fast-expt</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">even?</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="mi">1</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">))</span></code></pre></figure>

<h4 id="118">1.18</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">multi</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fast-multi-iter</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">n</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">x</span><span class="p">)</span>
          <span class="p">((</span><span class="nb">even?</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">fast-multi-iter</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">double</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span>
          <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">fast-multi-iter</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="nv">y</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">fast-multi-iter</span> <span class="mi">0</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))</span></code></pre></figure>

<h3 id="120">1.20</h3>
<p>Applicative order:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="nv">gcd</span><span class="p">(</span><span class="nf">206,</span> <span class="mi">40</span><span class="p">)</span>
<span class="nv">gcd</span><span class="p">(</span><span class="nf">40,</span> <span class="nv">remainder</span><span class="p">(</span><span class="nf">206,</span> <span class="mi">40</span><span class="p">))</span> <span class="c1">;1</span>
<span class="nv">gcd</span><span class="p">(</span><span class="nf">6,</span> <span class="nv">remainder</span><span class="p">(</span><span class="nf">40,</span> <span class="mi">6</span><span class="p">))</span>   <span class="c1">;2</span>
<span class="nv">gcd</span><span class="p">(</span><span class="nf">4,</span> <span class="nv">remainder</span><span class="p">(</span><span class="nf">6,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1">;3</span>
<span class="nv">gcd</span><span class="p">(</span><span class="nf">2,</span> <span class="nv">remainder</span><span class="p">(</span><span class="nf">4,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1">;4</span></code></pre></figure>

<p>For normal order, the <code class="highlighter-rouge">remainder</code> function is not calculated instantly.
It is calculated when it is necessary. It is passed by as a <code class="highlighter-rouge">delay</code> item.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="nb">gcd</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">)</span>
<span class="p">(</span><span class="nb">gcd</span> <span class="mi">40</span> <span class="p">(</span><span class="nb">remainder</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">))</span>
<span class="nv">-&gt;</span>
<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">remainder</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
  <span class="mi">40</span>
  <span class="p">(</span><span class="nb">gcd</span> <span class="p">(</span><span class="nb">remainder</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">remainder</span> <span class="mi">40</span> <span class="p">(</span><span class="nb">remainder</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">))))</span>
<span class="nv">-&gt;</span>
<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">remainder</span> <span class="mi">40</span> <span class="p">(</span><span class="nb">remainder</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">remainder</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">gcd</span>
    <span class="p">(</span><span class="nb">remainder</span>
      <span class="mi">40</span>
      <span class="p">(</span><span class="nb">remainder</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">))</span>
    <span class="p">(</span><span class="nb">remainder</span>
      <span class="p">(</span><span class="nb">remainder</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">remainder</span>
        <span class="mi">40</span>
        <span class="p">(</span><span class="nb">remainder</span> <span class="mi">206</span> <span class="mi">40</span><span class="p">)))))</span>
<span class="o">...</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/13/sicp-126" rel="next" title="sicp-126">sicp-126</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/12/1-2-3" rel="previous" title="SICP 1.2.3">SICP 1.2.3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>SICP 1.2.3 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Lisp" />
	

	
	<meta name="keywords" content="Lisp" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>SICP 1.2.3</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-12 20:42:17 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>Time and space complexity is kind of difficult for me.</p>

<h4 id="114">1.14</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"> <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">count-change</span> <span class="nv">amount</span><span class="p">)</span> 
   <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="mi">5</span><span class="p">))</span> 
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> <span class="nv">kinds-of-coins</span><span class="p">)</span> 
   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> 
         <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">amount</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">kinds-of-coins</span> <span class="mi">0</span><span class="p">))</span> <span class="mi">0</span><span class="p">)</span> 
         <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">cc</span> <span class="nv">amount</span> 
                      <span class="p">(</span><span class="nb">-</span> <span class="nv">kinds-of-coins</span> <span class="mi">1</span><span class="p">))</span> 
                  <span class="p">(</span><span class="nf">cc</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">amount</span> 
                         <span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">kinds-of-coins</span><span class="p">))</span> 
                      <span class="nv">kinds-of-coins</span><span class="p">)))))</span> 
 <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">first-denomination</span> <span class="nv">kinds-of-coins</span><span class="p">)</span> 
   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">kinds-of-coins</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">50</span><span class="p">)</span> 
         <span class="p">((</span><span class="nb">=</span> <span class="nv">kinds-of-coins</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">25</span><span class="p">)</span> 
         <span class="p">((</span><span class="nb">=</span> <span class="nv">kinds-of-coins</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">10</span><span class="p">)</span> 
         <span class="p">((</span><span class="nb">=</span> <span class="nv">kinds-of-coins</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">5</span><span class="p">)</span> 
         <span class="p">((</span><span class="nb">=</span> <span class="nv">kinds-of-coins</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">1</span><span class="p">)))</span> </code></pre></figure>

<p>To analyze the time complexity of $cc(n, k)$, it is more easy to start from $k=1$</p>

<p>if $k=1$, then $cc(n, 1)=O(n)$</p>

<p>if $k=2$, then $cc(n, 2) = cc(n - 5, 2) + cc(n, 1) = O(n^2)$</p>

<p>…</p>

<p>By induction, $cc(n, 5)=O(n^5)$</p>

<h4 id="115">1.15</h4>

<p>Time complexity is about $log_3(n)$.</p>

	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/12/sicp-section-124-125" rel="next" title="sicp-124-125">sicp-124-125</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/12/1-2-2" rel="previous" title="SICP 1.2.2">SICP 1.2.2</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>SICP 1.2.2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Lisp" />
	

	
	<meta name="keywords" content="Lisp" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>SICP 1.2.2</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-12 19:25:25 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="111">1.11</h4>

<p>Recursive versoin:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="o">#</span><span class="nv">lang</span> <span class="nv">planet</span> <span class="nv">neil/sicp</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">f-triple</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">&lt;</span> <span class="nv">n</span> <span class="mi">3</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">f-triple</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">f-triple</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">f-triple</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">3</span><span class="p">))))))</span></code></pre></figure>

<p>Iterate version:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">f-triple-iter</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">n</span> <span class="mi">3</span><span class="p">)</span>
    <span class="nv">n</span>
    <span class="p">(</span><span class="nf">f-iter</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">0</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">f-iter</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">count</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">count</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nv">a</span>
    <span class="p">(</span><span class="nf">f-iter</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">3</span> <span class="nv">c</span><span class="p">))</span>
            <span class="nv">a</span>
            <span class="nv">b</span>
            <span class="p">(</span><span class="nb">-</span> <span class="nv">count</span> <span class="mi">1</span><span class="p">))))</span></code></pre></figure>

<h4 id="112">1.12</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">triangle</span> <span class="nv">row</span> <span class="nv">col</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">col</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">&gt;</span> <span class="nv">col</span> <span class="nv">row</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span>
            <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">triangle</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">row</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">col</span> <span class="mi">1</span><span class="p">))</span>
               <span class="p">(</span><span class="nf">triangle</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">row</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">col</span><span class="p">)))))</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/12/1-2-3" rel="next" title="SICP 1.2.3">SICP 1.2.3</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/12/sicp-1.2.1" rel="previous" title="SICP 1.2.1">SICP 1.2.1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>SICP 1.2.1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Lisp" />
	

	
	<meta name="keywords" content="Lisp" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>SICP 1.2.1</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-12 07:59:53 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="19">1.9</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">a</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">b</span> <span class="p">(</span><span class="nf">inc</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">dec</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">b</span><span class="p">))))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">a</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">b</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">dec</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">inc</span> <span class="nv">b</span><span class="p">))))</span></code></pre></figure>

<p>The first version is recursive and the second one is iterative.
For the compilers such as Lisp,  which implemented tail call optimiztion, they make no difference.
But for other compilers such as C, Python, it would make big difference on memory usage and speed.</p>

<h4 id="110">1.10</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="nf">A</span> <span class="mi">0</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">=</span> <span class="mi">2</span><span class="nv">n</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">=</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">0</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span> <span class="nv">=</span> <span class="mi">2</span> <span class="nv">*</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="nv">=</span> <span class="mi">2</span> <span class="nv">^</span> <span class="nv">n</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">2</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">=</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">2</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span> <span class="nv">=</span> <span class="mi">2</span> <span class="nv">^</span> <span class="p">(</span><span class="nf">A</span> <span class="mi">2</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="nv">=</span> <span class="mi">2</span> <span class="nv">^</span> <span class="p">(</span><span class="nf">2</span> <span class="nv">^</span> <span class="nv">n</span><span class="p">)</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/12/1-2-2" rel="next" title="SICP 1.2.2">SICP 1.2.2</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/12/sicp-1-1" rel="previous" title="SICP section 1.1">SICP section 1.1</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>SICP section 1.1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Elements of Programming" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>SICP section 1.1</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-12 04:51:53 +0900
		 in <a href="/categories/SICP">SICP</a> 

		<span class="tag-list">
			
			<a href="/tags/Lisp">Lisp</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="13">1.3</h4>

<p>In order to find out the bigger ones, compare them pairwisely.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="o">#</span><span class="nv">lang</span> <span class="nv">planet</span> <span class="nv">neil/sicp</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum-of-squares</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">square</span> <span class="nv">y</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">bigger</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">smaller</span>  <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">bigger-sum-of-square</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">sum-of-squares</span> <span class="p">(</span><span class="nf">bigger</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
                 <span class="p">(</span><span class="nf">bigger</span> <span class="p">(</span><span class="nf">smaller</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
                         <span class="nv">z</span><span class="p">)))</span></code></pre></figure>

<h4 id="14">1.4</h4>

<p>This is the first order useage of the function, which is <code class="highlighter-rouge">+</code></p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="o">#</span><span class="nv">lang</span> <span class="nv">planet</span> <span class="nv">neil/sicp</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">a-plus-abs-b</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">((</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">b</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">+</span> <span class="nv">-</span><span class="p">)</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
  </code></pre></figure>

<h4 id="15">1.5</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="o">#</span><span class="nv">lang</span> <span class="nv">planet</span> <span class="nv">neil/sicp</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">p</span><span class="p">)</span> <span class="p">(</span><span class="nf">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">test</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">x</span> <span class="mi">0</span><span class="p">)</span> <span class="mi">0</span> <span class="nv">y</span><span class="p">))</span></code></pre></figure>

<p>If it is evaluated in applicative order, then the evaluation of the <code class="highlighter-rouge">(p)</code> would lead to infinite loop.
While, if it is evaluated in normal order, then <code class="highlighter-rouge">0</code> would return before it is evaluated.</p>

<h4 id="16">1.6</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">if</span> <span class="err">⟨</span> <span class="nv">predicate</span> <span class="err">⟩</span> <span class="err">⟨</span> <span class="nv">consequent</span> <span class="err">⟩</span> <span class="err">⟨</span> <span class="nv">alternative</span> <span class="err">⟩</span><span class="p">)</span></code></pre></figure>

<p><code class="highlighter-rouge">If</code> is special form becuase it is not a regular expression, which will have its arguments being evaluted at first.</p>

<p>Only<code class="highlighter-rouge">consequent</code> OR <code class="highlighter-rouge">alternative</code> will be evaluted, but never both at the same time.</p>

<p>The <code class="highlighter-rouge">new-if</code> statement will lead to infinite loop.</p>

<h4 id="17">1.7</h4>

<p>For small numbers, such as <code class="highlighter-rouge">(sqrt 0.00000000000002)</code>, the accuracy itself is too inaccurate.</p>

<p>For large numbers, such as <code class="highlighter-rouge">(sqrt 20000000000000)</code> will be trapped in infinite loop.
The guess would be a fixed point which equals <code class="highlighter-rouge">4472135.954995</code>.
But <code class="highlighter-rouge">20000000000000/4472135.954995 =4472135.955</code> which is not equal to <code class="highlighter-rouge">4472135.954995</code> exactly.</p>

<p>The reason is for float number, when the exp bits gets larger, its coificent bits would loose some accuracy.
Accurary lost meet with big exponent number, then this float number becomes inaccurate.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/12/sicp-1.2.1" rel="next" title="SICP 1.2.1">SICP 1.2.1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/02/09/2014" rel="previous" title="说好的2014">说好的2014</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Math">Math</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>From Jackknife to A/B Testing - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Show how get the confidence interval for the effects of A/B Testing" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>From Jackknife to A/B Testing</h1>
	<h4 class="large-bottom">
		Posted on 2019-12-23 22:28:32 +0900
		 in <a href="/categories/Data Science">Data Science</a> 

		<span class="tag-list">
			
			<a href="/tags/Jackknife">Jackknife</a>
			
			<a href="/tags/Math">Math</a>
			
			<a href="/tags/A/B Testing">A/B Testing</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="background">Background</h4>
<p>In A/B Testing, there is a group of data <script type="math/tex">X = (X_1, X_2, ..., X_n)</script> and <script type="math/tex">Y = (Y_1, Y-2, ..., Y_m)</script>, the metrics we interested in are the difference between these two groups and related confidence.</p>

<h4 id="a-quick-introduction-to-jackknife">A Quick Introduction to Jackknife</h4>
<p><a href="https://www.math.wustl.edu/~sawyer/handouts/Jackknife.pdf">Jackknife</a> is a method of resample, which tries to estimate the bias and variability of an estimator <script type="math/tex">\phi_n(X_1, X_2, ..., X_n)</script> by using values of <script type="math/tex">\phi_n(X)</script> on subsamples from <script type="math/tex">X_1, X_2, ..., X_n</script>.</p>

<p>The <script type="math/tex">i^{th}</script> pseudovalue of <script type="math/tex">\phi_n(X)</script> is
<script type="math/tex">ps_i(X) = n\phi_n(X_1, X_2, ..., X_n) - (n - 1)\phi_{n - 1}((X_1, X_2, ..., X_n)_{[i]})</script>, where <script type="math/tex">X_{i}</script> means the sample <script type="math/tex">X_1, X_2, ..., X_n</script> with <script type="math/tex">i^{th}</script> value <script type="math/tex">X_i</script> deleted from the sample.</p>

<p>Treat the pseudovalue <script type="math/tex">ps_i(X)</script> as if they were independent random variables with mean <script type="math/tex">\theta</script>, then the confidence interval could be obtained using Central Limit Theorem. Specifically, let</p>

<p><script type="math/tex">ps(X) = \frac{1}{n}\sum_{i=1}^{n}ps_i(X)</script> and <script type="math/tex">V_{ps}(X) = \frac{1}{n - 1}sum_{i=1}^{n - 1}(ps_i(X) - ps(X))^2</script></p>

<p>be the mean and sample variance of the pseudovalues. The jackknife 95% confidence interval is</p>

<script type="math/tex; mode=display">ps(X) - 1.96\sqrt{\frac{1}{n}V_{ps}(X)}, ps(X) + 1.96\sqrt{\frac{1}{n}V_{ps}(X)}</script>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">sample_count</span> <span class="o">=</span> <span class="mi">500000</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span> <span class="c1"># mean and standard deviation
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">jackknife_sder</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'data'</span><span class="p">])</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_count</span> <span class="o">/</span> <span class="n">K</span> <span class="p">)</span>
    <span class="k">def</span> <span class="nf">label_race</span> <span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">%</span> <span class="n">groups</span>
    <span class="n">df</span><span class="p">[</span><span class="s">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">label_race</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">average</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'data'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="n">total_sum</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">left_k_groups</span> <span class="o">=</span> <span class="p">[(</span><span class="n">total_sum</span> <span class="o">-</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s">'group'</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="nb">sum</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">sample_count</span> <span class="o">-</span> <span class="n">K</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">groups</span><span class="p">)]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">groups</span> <span class="o">*</span> <span class="n">average</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">*</span> <span class="p">(</span><span class="n">groups</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">left_k_groups</span><span class="p">]</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> 
    
    <span class="n">mean</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">groups</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">sample_count</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">s_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">jackknife_sder</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
<span class="n">s_mean</span><span class="p">,</span> <span class="n">s_var</span> <span class="o">=</span>  <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">/</span> <span class="p">(</span><span class="n">sample_count</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">s_vars</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">s_var</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s">'expected {s_var:.4f}'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/output_2_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">confidence</span> <span class="o">=</span> <span class="mf">1.96</span>
<span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_mean</span> <span class="o">-</span> <span class="n">confidence</span> <span class="o">*</span>  <span class="n">s_vars</span><span class="p">,</span> <span class="n">s_mean</span> <span class="o">+</span> <span class="n">confidence</span> <span class="o">*</span>  <span class="n">s_vars</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">'left: {l:.4f}, right: {r:.4f}'</span><span class="p">)</span>


</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>left: 499.7084, right: 500.2740
</code></pre></div></div>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
	
		
		
	
		
			<a href="/2015/08/24/monads" rel="previous" title="Monads">Monads</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Polymorphism">Polymorphism</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>One C++ polymorphism quesion - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="The polymorphism in C++" />
	

	
	<meta name="keywords" content="C++, Polymorphism, compiler" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>One C++ polymorphism quesion</h1>
	<h4 class="large-bottom">
		Posted on 2015-05-24 19:58:27 +0900
		 in <a href="/categories/C/C++">C/C++</a> 

		<span class="tag-list">
			
			<a href="/tags/C++">C++</a>
			
			<a href="/tags/Polymorphism">Polymorphism</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="confusing-subtype-polymorphism">Confusing subtype polymorphism</h3>

<p>When I first began to learn the polymorphism of C++, the <code class="highlighter-rouge">Subtype Polymorphism</code> similar to the following confused me a lot.</p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="c1">//file cats.h</span>
<span class="k">class</span> <span class="nc">Felid</span> <span class="p">{</span>
<span class="nl">public:</span>
 <span class="k">virtual</span> <span class="kt">void</span> <span class="n">meow</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="kt">void</span> <span class="n">getName</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"This is the Felid</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Cat</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Felid</span> <span class="p">{</span>
<span class="nl">public:</span>
 <span class="kt">void</span> <span class="n">meow</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Meowing like a regular cat! meow!</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
 <span class="kt">void</span> <span class="n">getName</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"This is the Cat</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Tiger</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Felid</span> <span class="p">{</span>
<span class="nl">public:</span>
 <span class="kt">void</span> <span class="n">meow</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Meowing like a tiger! MREOWWW!</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
 <span class="kt">void</span> <span class="n">getName</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"This is the Tiger</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Ocelot</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Felid</span> <span class="p">{</span>
<span class="nl">public:</span>
 <span class="kt">void</span> <span class="n">meow</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Meowing like an ocelot! mews!</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
 <span class="kt">void</span> <span class="n">getName</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"This is the Ocelot</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span></code></pre></figure>

<p>Now the programme can uses different <code class="highlighter-rouge">subtypes</code> to call <code class="highlighter-rouge">do_meowing</code>.</p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include &lt;iostream&gt;
#include "cats.h"
</span>
<span class="kt">void</span> <span class="nf">do_meowing</span><span class="p">(</span><span class="n">Felid</span> <span class="o">*</span><span class="n">cat</span><span class="p">)</span> <span class="p">{</span>
 <span class="n">cat</span><span class="o">-&gt;</span><span class="n">meow</span><span class="p">();</span>
 <span class="n">cat</span><span class="o">-&gt;</span><span class="n">getName</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
 <span class="n">Cat</span> <span class="n">cat</span><span class="p">;</span>
 <span class="n">Tiger</span> <span class="n">tiger</span><span class="p">;</span>
 <span class="n">Ocelot</span> <span class="n">ocelot</span><span class="p">;</span>

 <span class="n">do_meowing</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cat</span><span class="p">);</span>
 <span class="n">do_meowing</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tiger</span><span class="p">);</span>
 <span class="n">do_meowing</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ocelot</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>The output is:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Meowing like a regular cat! meow!
This is the Felid

Meowing like a tiger! MREOWWW!
This is the Felid

Meowing like an ocelot! mews!
This is the Felid
</code></pre></div></div>

<p>So, only the <code class="highlighter-rouge">virtual function</code> is polymorphism, but why and how?</p>

<h3 id="polymorphisms-in-c">polymorphisms in C++</h3>

<p>There are <a href="http://www.catonmat.net/blog/cpp-polymorphism/">four polymorphisms in C++</a>, namely</p>

<ol>
  <li>Subtype Polymorphism (Runtime Polymorphism)</li>
  <li>Parametric Polymorphism (Compile-Time Polymorphism)</li>
  <li>Ad-hoc Polymorphism (Overloading)</li>
  <li>Coercion Polymorphism (Casting)</li>
</ol>

<p><code class="highlighter-rouge">virtual function</code> belongs to the <code class="highlighter-rouge">subtype polymorphism</code> category.</p>

<h3 id="subtype-polymorphism-implementation">subtype polymorphism implementation</h3>

<p>Each object owns <a href="http://web.stanford.edu/class/archive/cs/cs143/cs143.1128/lectures/12/Slides12.pdf">several fields</a>, including</p>

<ol>
  <li>data member</li>
  <li>inherited data member</li>
  <li>virtual table</li>
</ol>

<p><code class="highlighter-rouge">subtype polymorphism</code> in <code class="highlighter-rouge">C++</code> is implemented by <code class="highlighter-rouge">virtual table</code> variable.</p>

<p>Also note that, member function is not stored in the object level, but in the class info level.
So normal member function is only determined by its declared type, not polymorphismed.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/06/13/srm661" rel="next" title="SRM 661 div1">SRM 661 div1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/03/16/sicp-4-3-3" rel="previous" title="sicp-4-3-3">sicp-4-3-3</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Python">Python</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Python variable scope - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="about the python variable scope in classes" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Python variable scope</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-13 00:07:37 +0900
		 in <a href="/categories/Technique">Technique</a> 

		<span class="tag-list">
			
			<a href="/tags/Python">Python</a>
			
			<a href="/tags/Variable scope">Variable scope</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="about-variable-scope">About variable scope</h3>

<p>In python, the variable scope has four kinds:</p>

<ul>
  <li>global</li>
  <li>class</li>
  <li>instance</li>
  <li>local</li>
</ul>

<p>In those kinds, the class-based and instance-based may merge in some cases:</p>

<p>Every time, the instance-based is looked up, which has not been initialized, the class-based result will
be returned if there is any. Once it is initialized, it will be in the field of the instance.</p>

<p>One example from <a href="http://stackoverflow.com/questions/12941748/python-variable-scope-and-classes">stackoverflow</a>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">my_var</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>


<span class="n">m1</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">10</span>          <span class="c1"># class-based 
</span>
<span class="n">MyClass</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">20</span>          <span class="c1"># Only class-based available.
</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">20</span>          <span class="c1"># class-based
</span>
<span class="n">m1</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="mi">30</span>
<span class="k">print</span><span class="p">(</span><span class="n">MyClass</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">20</span>          <span class="c1"># class-based,but the instance-based variable has been set in m1.
</span>
<span class="n">MyClass</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="mi">40</span> 
<span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">30</span>           
                 <span class="c1"># The value WAS shared before m1.my_var = 30 had happened.
</span>
<span class="k">print</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">40</span>           <span class="c1"># m2.my_var's value is still shared </span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/19/solarized-install" rel="next" title="Install solarized color theme">Install solarized color theme</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/11/modeling-relationship-in-app-engine" rel="previous" title="Modeling-Relationship-in-App-Engine">Modeling-Relationship-in-App-Engine</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Review">Review</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>说好的2014 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="说好的2014" />
	

	
	<meta name="keywords" content="life review" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>说好的2014</h1>
	<h4 class="large-bottom">
		Posted on 2015-02-09 19:27:53 +0900
		 in <a href="/categories/Life">Life</a> 

		<span class="tag-list">
			
			<a href="/tags/Review">Review</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="工作">工作</h2>

<p>2014年，职业生涯真正开始的一年，在所谓的Full-Stack 上迈出了第一步。</p>

<h4 id="前端">前端</h4>
<p>前端上加入了一个照片上传的插件，没错，这个货就是Javascript。
看着它那略怪异的各种语法， 然后小心的查着各种Tips，读着Good parts, 查着Bad parts，生怕跌入深坑。
开源大法好，要是让我开发这个玩意，没有个几年时间肯定做不出既能兼容各种浏览器，又具有很好的扩展性，同时
又经过严格的单元测试的项目。</p>

<p>Jascript就是这样，在给予一个最简单的跨平台的展示媒介的情况下，却不得不“忍受”它与生俱来的各种问题。</p>

<p>除此之外，开始使用Jinja2来生成Html，也要调试一些CSS相关的代码。</p>

<p>前端的东西还是Trick太多，无论是语言的设计还是各种浏览器的兼容。</p>

<h4 id="app-engine">App Engine</h4>

<p>在App Engine的项目上加入了一个绿坝系统，在App Engine扩展性限制下，用了最简单的关键词+正则表达的方式。大部分的精力花在了用Jinja2处理
复杂的前端Html页面上面。前端和后端一样，甚至比后端更需要抽象。因为前端需求变动的情况更多，同时展现涉及的页面
也更多，抽象不好，然后每一次页面的修改都会变为O(N)的人肉暴力。</p>

<p>基于语义的过滤系统肯定最准确，但是计算量太大。退而求其次，在分词的基础上进行匹配处理，效果就会好的多。
基于Lucene的Elastic Search应该是做这个最方便的工具。</p>

<p>尝试做了到NoSQL的Migration。后来想想，在目标Web服务器及数据库都没有确定的情况下，这个工作实在难以评价效果。
最大的收获还是线下开发，然后推入EC2测试，最后评价的整个流程走了一遍。Google的工具还是太高端了，因为系统拆分成了
多个模块，然后拥有非常优秀的可扩展性及灵活性。这是只使用工具所不能拥有的成就感。</p>

<h4 id="自动化配置-ansible">自动化配置-Ansible</h4>

<p>完成了一个自动化配置工具-Ansible的项目。系统自动化配置Web服务器Tornado，数据库Postgresql，任务队列Celery与Nginx，RabbitMQ,
Supervisor, Iptable, Redis。同时可以在配置文件中修改各种参数，不用再为系统环境的兼容性上苦恼。</p>

<p>Ansbile的优点为用Python实现，上手容易。但是因为它依赖Yaml与Jinja2等已有工具，所以在DSL解释的过程中，有不少陷阱。Python还是太不
适合用来实现DSL了。如果目标为长期的大型复杂项目，应该考虑其他的工具，如基于Ruby的Puppet等。</p>

<h4 id="异步orm">异步ORM</h4>

<p>做了一个Tornado与Postgresql之间的异步ORM。在个人看来，这是今年做的最有价值的工作。不知为何，现在没有开源的基于SQL的异步ORM。
虽然现在的这个ORM非常简陋，但是支持CURD及可支持嵌套的Transaction。
基本思路和工具都是在不断阅读相关项目的代码及文档，不断的思考，同时在网络上请教，最终一点点攒起来的。
思路很简单，Peewee的DSL部分+Momoko的线程Pool及执行部分+Peewee的resultwrapper部分。</p>

<p>Peewee是一个简单强大的ORM, 但是对Raw SQL的支持有限，究其原因还是resultwrapper很简单，并不是对SQL语句进行解释分析的。</p>

<p>第一次在实际工程中用到Compiler里面学到的东西。虽然只是一个用Python解释的DSL前端。Python的DSL是用重载运算符实现的，这一点直观上容易混淆。
别的方面，学到了Mixin在动态加载时改变代码执行路径，Python的胶水特性。</p>

<h2 id="学习">学习</h2>

<p>阅读的源代码：</p>

<ul>
  <li>Tornado: 代码的文档及注释都很出色，代码质量也可靠。</li>
  <li>Peewee: 短小精悍，只用了三千行就写出了一个这么出色的ORM。</li>
  <li>Momoko: Raw SQL runner + Thread Pool</li>
</ul>

<p>阅读的书籍：</p>

<ul>
  <li>Lisp 系列
    <ul>
      <li>The Little Schemer: 简单易懂，最后推倒出了Y表达式。</li>
      <li>The Seasoned Schemer: 关注更简洁、抽象的函数表达式。</li>
      <li>The Reasoned Schemer: Logic Programming， 脑洞大开。</li>
    </ul>
  </li>
  <li>SICP: 读过两遍，试题略略的看了一下。不得不说这是一本神书，每一个对编译语音有兴趣的人，都会从中学到很多。</li>
  <li>Haskell Books: 对Haskell产生兴趣先是由于各种传说，后来读了之后发现，要掌握好这门语言，居然要学习Category Theory, 瞬间好感度上升一个数量级。
    <ul>
      <li>Learn you a Haskell for Great Good</li>
      <li>The Real World Haskell</li>
    </ul>
  </li>
  <li>Introduction to Algorithm: 重读了部分常用算法，简洁、从直觉出发，算法设计的经典书籍。</li>
  <li>Compiler course in Stanford: 主要精力花在了前端的整个算法理解上，优化及IR，二进制码实现略看了下。比龙书易懂，适合入门。</li>
  <li>The Economist: 自从日元贬值开始，开始发现金融界的事情开始和自己有莫大的关系。现在停留在看热闹的阶段，主要关注中国及亚洲版。</li>
  <li>日语系列: 多掌握一门语言，据说就多了一种选择。英语确实有极大的用处，日语现在的最大的用处还是处在简单的吹牛，读读杂志的阶段。
    <ul>
      <li>初级日本语上、下</li>
      <li>中级日本语上、下</li>
      <li>大家的日语初级</li>
    </ul>
  </li>
</ul>

<h2 id="可量化的成绩">可量化的成绩</h2>

<ul>
  <li>日语N2</li>
  <li>编程相关
    <ul>
      <li>被fork的项目Vim</li>
      <li>被Star的项目Google Analytics</li>
      <li>Patch被Accepted项目
        <ul>
          <li>Momoko</li>
          <li>Ansbile playbook</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="总结">总结</h2>

<p>2014年学习了Web开发的各种语言，各种工具，可以独立的承担一些项目。
2014年并未如原来曾有的乐观一样，出现突飞猛进的变化。根本原因，大的目标不明确。
涉猎了不少东西，但是真正能量化的成绩却非常少。
这也与设立目标时总是关注目标本身，却缺少量化的可考量的手段。
就像是在跑步时，没有明确要跑多少，而是告诉自己，尽量跑。
没有可量化的目标，很难超出自己的心理舒适期，更无法超越自己的极限。
无法超越极限，水平自然停滞不前。
自己曾经尝试过独立的优化或者在一些工具上开发一些项目。但是最终都以失败而告终。
总结其中的原因，目标与现实的能力水平有差异。在没有真正兴趣的情况下选择一个新的领域
或者是在仅仅知道皮毛，却想独立一步作成一个大的项目的野望。</p>

<p>脚踏实地，立足现在，寻求合伙人，设立可量化的目标，总结与纠正，不断向前。
确立大的目标，然后分解成小的可量化目标，定期评价总结。</p>

	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/12/sicp-1-1" rel="next" title="SICP section 1.1">SICP section 1.1</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2014/02/03/goals-in-2014" rel="previous" title="Goals in 2014">Goals in 2014</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>逝去的2013 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="逝去的2013" />
	

	
	<meta name="keywords" content="life review" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>逝去的2013</h1>
	<h4 class="large-bottom">
		Posted on 2014-01-06 07:41:07 +0900
		 in <a href="/categories/Life">Life</a> 

		<span class="tag-list">
			
			<a href="/tags/Life">Life</a>
			
			<a href="/tags/Review">Review</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="实习生活">实习生活</h3>

<p>过完新年之后的第一个周一，北上帝都。炮君先我一步，与高富帅看好了房子。到了帝都的第一天，在中介的
半忽悠之后，签下了第一份房租合同。略带新鲜，但是失落感很强的帝都生活开始了。</p>

<p>第一家实习的公司算是较大的公司，各方面较为正规，但是所做的事情是自己原来涉及较少的，从头学起是不得不经历的过程。
摸索着用起来了Linux，写起了Python，开始与Excel打交道，阅读关于公司技术框架与业务的文档。看着这个只有十几年历史
的互联网公司的框架，偶尔还能看到读大一大二时就已经耳闻的前辈们留下的文档与代码。在这里，我是1/20000。我是一颗
螺丝钉，想从人堆里面出头，是很难的事情。</p>

<p>但是大公司最大的好处就是培训的课程多，可以在上班的时候学习公司的training课程。线下帝都有特别多的技术交流的活动，
如果不介意帝都那阴沉的天空和让人望而生畏的房价，这里，应该是国内长技术的好地方。</p>

<p>50天的实习，在技术上没有明显的进步，倒是公司的文档与课程让我大开眼界。原来仅有耳闻的技术早已经在使用了。只是，这里
只是我的一个过渡的站点。</p>

<h3 id="走川西">走川西</h3>

<p>第一次也是唯一的一次外出露营,难以忘记在野外的快乐，或许我本身就是一个放荡不羁的人，在野外，我可以放肆的笑，可以傻傻的
看着花花草草发呆，可以在4600米海拔的地方裸露自己的上身，与神圣的贡嘎山合影。</p>

<p>一次又一次的被美丽的川西折服，一次又一次的赞叹自然的造化与人类精神上的纯洁与伟大。当我们出现高原反应的时候，是寺庙的方丈
无偿的给我们红景天泡水。当我第一次那么近距离的仰望满天的繁星的时候，我的心中除了满满的赞叹与心中的崇敬，毫无他念。</p>

<p>川西，一定要好好的走一遍，不至少一遍。川西，请等我。</p>

<h3 id="毕业">毕业</h3>

<p>七年之痒，毕业了。这三年是失去的三年，当初的意气风发被消耗了很多。当初已经能改变世界，后来，我没有能够改变世界，
只能尽量不要让世界改变了我。本科毕业的时候，我忙的不可开交，有很多的朋友要分别，有很多的事情要处理。这最后的毕业，
我居然是如此的清闲，没有未来的扑面而来的压迫，也没有自己迫不及待的期望，真正要分别的朋友也少了很多。</p>

<p>是我把自己封闭了，故作清高的认为周围值得自己认识的人很少，同时在找不到更好的目标的情况下，当我消极失落的时候，更多的
时间留给了三国杀和足球。</p>

<p>我是一个多么肤浅的人，即使技术上这不是一个领先的地方，我有网线，网络上，难道自己想努力，还不能找到适合自己的圈子？
我是一个多么肤浅的人，即使身边看到的优秀的同学不够多，但是，本科的学弟学妹们，在非技术方面优秀的同学难道不足以给自己
更多可以学习的启示？自己的知识系统是如此的不完善，难道有其他专长的同学不值得自己学习？封闭了自己，就是一个信息的孤岛，
信息的孤岛怎么能够与时俱进呢？</p>

<p>如果线下不能有一群志同道合的朋友的话，利用好每一个社交的工具，尽力的追赶，然后尽快的创造自己的圈子。总有很多人值得自己
学习，在每一个方面！</p>

<h3 id="驾照你好">驾照你好</h3>

<p>从7.5号考完理论，到9.4号拿到驾照，不足俩月。期间的考试都是一次性通过，比较满足。学手艺与学技术在我看来没有特别大的区别，
天赋与努力依然是互相依存的。</p>

<p>当然也见到了不少社会中略肮脏的交易，不想向它妥协，除了自己变强，没有它法。改变环境，没有相应的能力与影响，谈何容易。
即使有了相应的能力与影响，这也谈何容易。</p>

<h3 id="日语">日语</h3>

<p>接触日语应该有一年了，认真学习也有三四个月了。略有进步，但是同日本人交流依然问题很大，语法现在慢慢的懂了不少，但是单词
是最大的问题。除了每周周日去小学学习日语以外，每天说日语的时候少的可怜。说更多的日语，才能更好的掌握日语。更多的讲日语，
从与Cathy对话开始。</p>

<h3 id="工作">工作</h3>

<p>开始了公司的工作，在一个没有文档的框架上开发，同时又是基于App Engine的，这是有多的sucks，眼泪直流。不过，同事还好，老板
还好，push的不多，不懂的方法与技术慢慢的摸索与学习。只是每天都至少加班一个小时，让人略伤感。公司的人都是自动加班，暂时还
不知道这是为什么，或许这是日企的文化吧，慢慢体验。珍爱生命，原理加班，提高效率！</p>

<h3 id="更专业更细致">更专业，更细致</h3>

<p>加入了一只足球队，这是我第一次尝试加入日本人的圈子。很开心，很受打击，也很受教育。大家对我都很客气，队长对我也非常的照顾。
日本人专业的精神，让我赞叹。每次练习赛，都会有主裁、边裁，甚至都有入场仪式。而且每次训练前提前两周左右安排已经做好。他们是
如此的专业，这样做上10年，还会有什么不清楚的呢？对长辈的尊敬，不仅仅是出于礼节上，更主要的是别人比自己更专业！</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2014/01/17/bash-command-line-processing" rel="next" title="Bash Command Line Processing">Bash Command Line Processing</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/12/28/gitunderstanding" rel="previous" title="Understanding Git">Understanding Git</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Solarized">Solarized</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Install solarized color theme - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Install solarized color theme for vim and gnome" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Install solarized color theme</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-19 20:32:13 +0900
		 in <a href="/categories/Vim">Vim</a> 

		<span class="tag-list">
			
			<a href="/tags/Vim">Vim</a>
			
			<a href="/tags/Solarized">Solarized</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>It is not so easy to correct configure the solarized for vim and gnome. It should be done in several steps.</p>

<h4 id="install-gnome-solarized-color-theme">Install gnome solarized color theme</h4>

<p>Use Bundle to install the <a href="https://github.com/sigurdga/gnome-terminal-colors-solarized">gnome</a>, after this, the background is ok, but the ls command only displays grey. It should be fixed.</p>

<h4 id="fix-the-ls-command">Fix the ls command</h4>

<p>Use this <a href="http://www.webupd8.org/2011/04/solarized-must-have-color-paletter-for.html">fix</a>.</p>

<h4 id="install-vim-solarized-color-theme">Install vim solarized color theme</h4>

<p>Use Bundle to install <a href="https://github.com/altercation/vim-colors-solarized">vim solarized</a>.</p>

<h3 id="useful-links-for-color-theme">Useful links for color theme</h3>

<p><a href="https://github.com/alghanmi/terminal_color_test">color test</a></p>

<p><a href="http://askubuntu.com/questions/137706/gnome-terminal-and-solarized-theme-coloring-issue">scipt5</a></p>

<p><a href="https://gist.github.com/t-mart/1280177">scipt6</a></p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/29/wushimeiyuan" rel="next" title="左宗棠题江苏无锡梅园">左宗棠题江苏无锡梅园</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/13/python-variable-scope-classes" rel="previous" title="Python variable scope">Python variable scope</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Sourcecode">Sourcecode</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Linklist Mergesort - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library Linklist Mergesort" />
	

	
	<meta name="keywords" content="Data structure, Source Code" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Linklist Mergesort</h1>
	<h4 class="large-bottom">
		Posted on 2014-01-24 03:27:36 +0900
		 in <a href="/categories/Data structure">Data structure</a> 

		<span class="tag-list">
			
			<a href="/tags/Datastructure">Datastructure</a>
			
			<a href="/tags/Sourcecode">Sourcecode</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h4 id="linkedlist-mergesort-in-linux-kernal">Linkedlist mergesort in Linux kernal</h4>

<p>Merge sort on array can be easily done due to it is easy to find the specific data in 
a any given position index value. While, if it were the case in the linkedlist, it would
be tough to implemente the mergesort efficienty.</p>

<p>Thanks to the <a href="http://cstheory.stackexchange.com/questions/19759/core-algorithms-deployed/19773#19773">post</a>, 
I found the following source code in the <a href="https://github.com/mirrors/linux-2.6/blob/master/lib/list_sort.c">Linux 2.6</a></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/*
 * Returns a list organized in an intermediate format suited
 * to chaining of merge() calls: null-terminated, no reserved or
 * sentinel head node, "prev" links not maintained.
 */</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="nf">merge</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
				<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cmp</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">b</span><span class="p">),</span>
				<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">head</span><span class="p">,</span> <span class="o">*</span><span class="n">tail</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">head</span><span class="p">;</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">a</span> <span class="o">&amp;&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* if equal, take 'a' -- important for sort stability */</span>
		<span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="n">cmp</span><span class="p">)(</span><span class="n">priv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">tail</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
			<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">tail</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
			<span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">tail</span> <span class="o">=</span> <span class="n">tail</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">tail</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">a</span><span class="o">?:</span><span class="n">b</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">head</span><span class="p">.</span><span class="n">next</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>The above code will merge two linked list. One extra <code class="highlighter-rouge">struct *tail</code> is being used to help construct the new linked list.</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/**
 * list_sort - sort a list
 * @priv: private data, opaque to list_sort(), passed to @cmp
 * @head: the list to sort
 * @cmp: the elements comparison function
 *
 * This function implements "merge sort", which has O(nlog(n))
 * complexity.
 *
 * The comparison function @cmp must return a negative value if @a
 * should sort before @b, and a positive value if @a should sort after
 * @b. If @a and @b are equivalent, and their original relative
 * ordering is to be preserved, @cmp must return 0.
 */</span>
<span class="kt">void</span> <span class="nf">list_sort</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">head</span><span class="p">,</span>
		<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cmp</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">b</span><span class="p">))</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">part</span><span class="p">[</span><span class="n">MAX_LIST_LENGTH_BITS</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="cm">/* sorted partial lists
						-- last slot is a sentinel */</span>
	<span class="kt">int</span> <span class="n">lev</span><span class="p">;</span>  <span class="cm">/* index into part[] */</span>
	<span class="kt">int</span> <span class="n">max_lev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">list</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">list_empty</span><span class="p">(</span><span class="n">head</span><span class="p">))</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">memset</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">part</span><span class="p">));</span>

	<span class="n">head</span><span class="o">-&gt;</span><span class="n">prev</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">list</span> <span class="o">=</span> <span class="n">head</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">list</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">cur</span> <span class="o">=</span> <span class="n">list</span><span class="p">;</span>
		<span class="n">list</span> <span class="o">=</span> <span class="n">list</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
		<span class="n">cur</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">lev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">];</span> <span class="n">lev</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cur</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">priv</span><span class="p">,</span> <span class="n">cmp</span><span class="p">,</span> <span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">],</span> <span class="n">cur</span><span class="p">);</span>
			<span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">]</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">lev</span> <span class="o">&gt;</span> <span class="n">max_lev</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="n">lev</span> <span class="o">&gt;=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">part</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">printk_once</span><span class="p">(</span><span class="n">KERN_DEBUG</span> <span class="s">"list passed to"</span>
					<span class="s">" list_sort() too long for"</span>
					<span class="s">" efficiency</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
				<span class="n">lev</span><span class="o">--</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">max_lev</span> <span class="o">=</span> <span class="n">lev</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">]</span> <span class="o">=</span> <span class="n">cur</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">lev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">lev</span> <span class="o">&lt;</span> <span class="n">max_lev</span><span class="p">;</span> <span class="n">lev</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">])</span>
			<span class="n">list</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">priv</span><span class="p">,</span> <span class="n">cmp</span><span class="p">,</span> <span class="n">part</span><span class="p">[</span><span class="n">lev</span><span class="p">],</span> <span class="n">list</span><span class="p">);</span>

	<span class="n">merge_and_restore_back_links</span><span class="p">(</span><span class="n">priv</span><span class="p">,</span> <span class="n">cmp</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">part</span><span class="p">[</span><span class="n">max_lev</span><span class="p">],</span> <span class="n">list</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>The above code deals with the merge sort, which is really tricky and amazing.
The key idea is in the</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c">	<span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">part</span><span class="p">[</span><span class="n">MAX_LIST_LENGTH_BITS</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="cm">/* sorted partial lists
						-- last slot is a sentinel */</span></code></pre></figure>

<p>This part will store the partial lists, whose lengths whill be 
<script type="math/tex">2^i</script> where <script type="math/tex">i</script> is the index of the part array.</p>

<p>It uses the <a href="http://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci</a>
property of the length in the mergesort list. Only the same length list of occur
in the same specific position, and two same length lists will merge to a single list<br />
whose length will double while the index in the part array is just the next postion.</p>

<p>At last, just merge all the elements in the part array, then the final list is constructed!</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2014/02/03/goals-in-2014" rel="next" title="Goals in 2014">Goals in 2014</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2014/01/20/quoting-bash" rel="previous" title="Quoting and eval in Bash">Quoting and eval in Bash</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Template">Template</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Jinja2 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Learning Jinja2" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Jinja2</h1>
	<h4 class="large-bottom">
		Posted on 2013-10-29 21:56:46 +0900
		 in <a href="/categories/Technique">Technique</a> 

		<span class="tag-list">
			
			<a href="/tags/Jinja2">Jinja2</a>
			
			<a href="/tags/Template">Template</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="variables">Variables</h3>

<p>{{ foo.bar }}</p>

<p>{{ foo[‘bar’] }}</p>

<h4 id="implementation">Implementation</h4>
<p>Sake foo.bar in Jinja2 does the following thing on the Python layer:</p>

<ul>
  <li>check if there is an attribute called bar on foo.</li>
  <li>if there is not, check if there is an item ‘bar’ in foo.</li>
  <li>if there is not, return an undefined object.</li>
</ul>

<p>foo[‘bar’] works mostly the same with a difference in the order:</p>

<ul>
  <li>check if there is an item ‘bar’ in foo.</li>
  <li>if there is not, check if there is an attribute called bar on foo.</li>
  <li>if there is not, return an undefined object.</li>
</ul>

<p>###Filers###
Variables can be modified by filters.<br />
{{ name|striptags|title }}  will remove all HTML Tags from the name and title-cases it.</p>

<p>###Tests###
Tests can be used to test a variable against a common expression.</p>

<p>{% if loop.index is divisibleby 3 %}</p>

<p>###Comments###</p>

<p>{# note: disabled template because we no longer use this<br />
    {% for user in users %}<br />
        …<br />
    {% endfor %}<br />
#}</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/05/storingdatainappengine" rel="next" title="Storing Data in App Engine">Storing Data in App Engine</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/10/29/gitcommands" rel="previous" title="Git Commands">Git Commands</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Topcoder">Topcoder</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>SRM663 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="kamelzcs's library SRM663" />
	

	
	<meta name="keywords" content="Generating function" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>SRM663</h1>
	<h4 class="large-bottom">
		Posted on 2015-07-27 01:24:30 +0900
		 in <a href="/categories/Contest">Contest</a> 

		<span class="tag-list">
			
			<a href="/tags/Topcoder">Topcoder</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="changingchange"><a href="http://community.topcoder.com/stat?c=problem_solution&amp;rm=326633&amp;rd=16512&amp;pm=13847&amp;cr=22907549">ChangingChange</a></h3>

<h4 id="analyze">Analyze</h4>

<p>The constraint on <code class="highlighter-rouge">D</code> is the key to solve this problem.</p>

<p>As different ways are given, <code class="highlighter-rouge">Generating function</code> would be a great tool to hold all the info all at once.</p>

<p>Suppose <code class="highlighter-rouge">ways = {1, 3, 6, 2}</code>, then <script type="math/tex">f(x) = 1 + 3x + 6x^2 + 2x^3</script></p>

<p>By adding a coin whose value is <code class="highlighter-rouge">1</code>, then new ways is <script type="math/tex">f(x) * (1+x)</script></p>

<p>On the contrary, by removing a coin whose value is <code class="highlighter-rouge">1</code>, the new ways is <script type="math/tex">f(x) {(1+x)}^{-1}</script></p>

<p>By removing <code class="highlighter-rouge">n</code> coins, the new ways is <script type="math/tex">f(x) {(1+x)}^{-n}</script></p>

<p>The coefficient of $x^k$ is <script type="math/tex">\binom{-n}{k}</script> which has to be developed.</p>

<p><script type="math/tex">\binom{n}{k} = (-1)^{k} \binom{k - n - 1}{k}</script> $\implies$ <script type="math/tex">\binom{-n}{k} = (-1)^{k} \binom{k + n - 1}{k}</script></p>

<p>The final answer would be</p>

<script type="math/tex; mode=display">\sum_{k=0}^D (-1)^{k} \times ways[D - k] \times \binom{k + numberRemoved[i] - 1}{k}</script>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/07/27/ipsc2015-h2" rel="next" title="Decouple the relation and approach in different metrics">Decouple the relation and approach in different metrics</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/06/22/function_overriding" rel="previous" title="Function_overriding in Java vs C++">Function_overriding in Java vs C++</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>SRM 661 div1 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Review of SRM 661" />
	

	
	<meta name="keywords" content="Number theory, Combination" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>SRM 661 div1</h1>
	<h4 class="large-bottom">
		Posted on 2015-06-13 18:41:40 +0900
		 in <a href="/categories/Contest">Contest</a> 

		<span class="tag-list">
			
			<a href="/tags/Topcoder">Topcoder</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p><a href="http://community.topcoder.com/stat?c=round_overview&amp;rd=16464">SRM 661</a> consists of 250 + 450 + 1000.
250 and 450 are two maths problems.</p>

<h3 id="missinglcm"><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=13766&amp;rd=16464">MissingLCM</a></h3>

<p>Given $N \in [1,100000]$, find out the minimum $M \in (N, \infty)$ such that $lcm(1, 2, …, M)=lcm(N+1, N+2, …, M)$</p>

<h4 id="analyze">Analyze</h4>

<p>As $N$ is given, first consider how to calculate $lcm(1, 2, .., N)$</p>

<p>The answer would be only consider all the <code class="highlighter-rouge">Prime number</code> $P_i \in [1, N]$,
and find out the maximum $n_i$ such that
<script type="math/tex">% <![CDATA[
P_{i} ^ {n_i} <=N %]]></script> and <script type="math/tex">P_{i} ^ {n_i+1} >N</script>
then the answer would be <script type="math/tex">\prod_{i=1}^{l} P_{i}^{n_i}</script></p>

<p>So <script type="math/tex">lcm(N+1, N+2, ..., M)</script> should have all the <script type="math/tex">P_{i} ^ {n_i}</script> factors.
The the answer would be <script type="math/tex">\max \left[\left(\lfloor{\frac{N}{P_{i} ^ {n_i}}}\rfloor + 1\right) * {P_{i} ^ {n_i}}\right]</script></p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">LL</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">MissingLCM</span> <span class="p">{</span>
    <span class="nl">public:</span>
    <span class="kt">bool</span> <span class="n">isPrime</span><span class="p">[</span><span class="mi">1000100</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">getMin</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
            <span class="n">isPrime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">isPrime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">false</span><span class="p">){</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">j</span> <span class="o">+=</span> <span class="n">i</span><span class="p">){</span>
                <span class="n">isPrime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">isPrime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">false</span><span class="p">){</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kt">int</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">temp</span> <span class="o">&lt;=</span> <span class="n">N</span> <span class="o">/</span> <span class="n">i</span><span class="p">){</span>
                <span class="n">temp</span> <span class="o">*=</span> <span class="n">i</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="n">temp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">temp</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span></code></pre></figure>

<h3 id="colorfullinegraphs"><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=13765&amp;rd=16464">ColorfulLineGraphs</a></h3>

<h4 id="analyze-1">Analyze</h4>
<p>suppose $f[N][K]$ is the total number of using $K$ colors on $N$ nodes.</p>

<p>Now considering to build $f[N][K]$ from $f[N-1][K]$</p>

<p>For node $N$ choose whether to link to some node $i \in [1,N-1]$ or do not link at all.</p>

<ol>
  <li>linked to some node $i$, there are $K - 1$ ways of color possibilities each.</li>
  <li>do not link to any other, there are $K$ ways of color possibilities.</li>
</ol>

<p>So <script type="math/tex">f[N][K] = ((N - 1)*(K-1) + K)*f[N][K]</script></p>

<p>The current time complexity is $O(n)$, which is not fast enough.</p>

<p>Notice $M$ is small, <script type="math/tex">((N-1)*(K-1)+K)\mod M</script> would be cyclic, $M$ would be one periodic according to <a href="https://en.wikipedia.org/wiki/Lagrange%27s_theorem_%28group_theory%29">Lagrange’s theorem</a></p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">LL</span><span class="p">;</span>
<span class="cp">#define REP(i, N) for (int i = 0; i &lt; (int)N; i++)
</span>
<span class="k">struct</span> <span class="n">ColorfulLineGraphs</span> <span class="p">{</span>
  <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">;</span>
  <span class="kt">long</span> <span class="kt">long</span> <span class="n">K</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">M</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">fastPower</span><span class="p">(</span><span class="n">LL</span> <span class="n">base</span><span class="p">,</span> <span class="n">LL</span> <span class="n">p</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">LL</span> <span class="n">cur</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">((</span><span class="n">LL</span><span class="p">)</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">cur</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">;</span> <span class="o">++</span><span class="n">cur</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="n">p</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">LL</span><span class="p">)</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">cur</span><span class="p">)){</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">(</span><span class="n">ans</span> <span class="o">*</span> <span class="n">base</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">base</span> <span class="o">=</span> <span class="p">(</span><span class="n">base</span> <span class="o">*</span> <span class="n">base</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">countWays</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">_N</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">_K</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_M</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">_N</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">_K</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">_M</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">K</span> <span class="o">%=</span> <span class="n">M</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">LL</span> <span class="n">cur</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">cur</span> <span class="o">&lt;=</span> <span class="n">M</span><span class="p">;</span> <span class="o">++</span><span class="n">cur</span><span class="p">){</span>
      <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">res</span> <span class="o">*</span> <span class="p">(</span><span class="n">cur</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="n">M</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span><span class="n">N</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="n">cur</span><span class="p">){</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">res</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="p">(</span><span class="n">ans</span> <span class="o">*</span> <span class="n">fastPower</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">N</span> <span class="o">/</span> <span class="n">M</span><span class="p">))</span> <span class="o">%</span> <span class="n">M</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/06/22/function_overriding" rel="next" title="Function_overriding in Java vs C++">Function_overriding in Java vs C++</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2015/05/24/polymorphism-c" rel="previous" title="One C++ polymorphism quesion">One C++ polymorphism quesion</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Variable scope">Variable scope</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Python variable scope - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="about the python variable scope in classes" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Python variable scope</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-13 00:07:37 +0900
		 in <a href="/categories/Technique">Technique</a> 

		<span class="tag-list">
			
			<a href="/tags/Python">Python</a>
			
			<a href="/tags/Variable scope">Variable scope</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="about-variable-scope">About variable scope</h3>

<p>In python, the variable scope has four kinds:</p>

<ul>
  <li>global</li>
  <li>class</li>
  <li>instance</li>
  <li>local</li>
</ul>

<p>In those kinds, the class-based and instance-based may merge in some cases:</p>

<p>Every time, the instance-based is looked up, which has not been initialized, the class-based result will
be returned if there is any. Once it is initialized, it will be in the field of the instance.</p>

<p>One example from <a href="http://stackoverflow.com/questions/12941748/python-variable-scope-and-classes">stackoverflow</a>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">my_var</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>


<span class="n">m1</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">10</span>          <span class="c1"># class-based 
</span>
<span class="n">MyClass</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">20</span>          <span class="c1"># Only class-based available.
</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">20</span>          <span class="c1"># class-based
</span>
<span class="n">m1</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="mi">30</span>
<span class="k">print</span><span class="p">(</span><span class="n">MyClass</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">20</span>          <span class="c1"># class-based,but the instance-based variable has been set in m1.
</span>
<span class="n">MyClass</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="mi">40</span> 
<span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">30</span>           
                 <span class="c1"># The value WAS shared before m1.my_var = 30 had happened.
</span>
<span class="k">print</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">40</span>           <span class="c1"># m2.my_var's value is still shared </span></code></pre></figure>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/19/solarized-install" rel="next" title="Install solarized color theme">Install solarized color theme</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/11/modeling-relationship-in-app-engine" rel="previous" title="Modeling-Relationship-in-App-Engine">Modeling-Relationship-in-App-Engine</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/Vim">Vim</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Vim Tips - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Useful Vim Tips" />
	

	
	<meta name="keywords" content="Vim" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Vim Tips</h1>
	<h4 class="large-bottom">
		Posted on 2013-12-06 20:08:11 +0900
		 in <a href="/categories/Technology">Technology</a> 

		<span class="tag-list">
			
			<a href="/tags/Vim">Vim</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>Here is some useful Vim tips</p>

<h4 id="normal">Normal</h4>

<ul>
  <li>
    <p><code class="highlighter-rouge">V</code> multiline copy</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">.</code> duplicate last command</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">I</code> insert at the begin</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">A</code> Append to end</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">J</code> Join two lines</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">&gt;</code> and <code class="highlighter-rouge">&lt;</code> indent block(in visual mode)</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">CTRL + A or X</code> increase or decrease the number</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">~</code> toggle the casing of a letter/selection(upper-case/down-case)</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">!!</code> execute last command</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">&lt;start position&gt;&lt;command&gt;&lt;end position&gt;</code> for example <code class="highlighter-rouge">y`a</code> yank from here to he marked <code class="highlighter-rouge">a</code></p>
  </li>
  <li>
    <p>use markers in the way <code class="highlighter-rouge">a z b e</code></p>
  </li>
  <li>
    <p><code class="highlighter-rouge">"zyy</code> and <code class="highlighter-rouge">"zp</code> copy to z register and paste from <code class="highlighter-rouge">z</code> register</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">set ft=?</code> look up current file type.</p>
  </li>
</ul>

<h4 id="move">Move</h4>

<ul>
  <li>
    <p><code class="highlighter-rouge">%</code> go to the corresponding <code class="highlighter-rouge">()</code>,<code class="highlighter-rouge">{}</code>,<code class="highlighter-rouge">[]</code></p>
  </li>
  <li>
    <p><code class="highlighter-rouge">mz `z</code> Marker and go to the last position</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">'.</code> Jump back to last edited line</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">g;</code>and <code class="highlighter-rouge">g,</code> move (forward,backward) through the changelist</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">gi</code> go to the last place you inserted a text</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Ctrl-o</code> and <code class="highlighter-rouge">Ctrl-i</code> to go to the previous/next location you jumped to</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">fa</code> go to the next <code class="highlighter-rouge">a</code> in the line</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">t,</code> go to before the next <code class="highlighter-rouge">,</code></p>
  </li>
  <li>
    <p><code class="highlighter-rouge">F</code> and <code class="highlighter-rouge">T</code> are backward</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">w</code> go to the start of the next word</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">b/e</code> go to the beginning/end of this word</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">W</code> go to the start of the following WORD(space separated only)</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">B/E</code> go to the beginning/end of this WORD</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">{ }</code> to move to the beginning/ending of the paragraph</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">zz</code> move current line to the middle of the screen</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">zt</code> move current line to the top of the screen</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">zt</code> move current line to the bottom of the screen</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Ctrl</code>+<code class="highlighter-rouge">e</code> move screen up one line</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Ctrl</code>+<code class="highlighter-rouge">y</code> move screen down one line</p>
  </li>
</ul>

<h4 id="zone-selection">Zone selection</h4>

<p><code class="highlighter-rouge">&lt;action&gt;a&lt;object&gt; and &lt;action&gt;i&lt;object&gt;</code></p>

<p>Action can be any action, for example <code class="highlighter-rouge">d</code>, <code class="highlighter-rouge">y</code>, <code class="highlighter-rouge">c</code>(change), <code class="highlighter-rouge">v</code>(select in visual mode). The object can be:
 <code class="highlighter-rouge">w</code> a word, <code class="highlighter-rouge">W</code> a WORD, <code class="highlighter-rouge">s</code> a sentence, <code class="highlighter-rouge">p</code> a paragraph. But also, natural character such as <code class="highlighter-rouge">",',),],}</code></p>

<p><code class="highlighter-rouge">vi"</code> will select foo.</p>

<p><code class="highlighter-rouge">va"</code> will select “foo”</p>

<h4 id="editing">Editing</h4>

<ul>
  <li>
    <p><code class="highlighter-rouge">cc</code> change the entire current line</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">r</code> replace the current character</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">R</code> Enter Insert mode, replacing characters rather than inserting</p>
  </li>
</ul>

<h4 id="macro-recording">Macro recording</h4>

<p>/bin/bash: :q: command not found</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">q[ key ]</code> to start recording</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">q</code> to stop recording</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">@[ key ]</code> to use the macro
  ```</p>
  </li>
</ul>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/12/28/gitunderstanding" rel="next" title="Understanding Git">Understanding Git</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/29/wushimeiyuan" rel="previous" title="左宗棠题江苏无锡梅园">左宗棠题江苏无锡梅园</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>Install solarized color theme - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="Install solarized color theme for vim and gnome" />
	

	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Install solarized color theme</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-19 20:32:13 +0900
		 in <a href="/categories/Vim">Vim</a> 

		<span class="tag-list">
			
			<a href="/tags/Vim">Vim</a>
			
			<a href="/tags/Solarized">Solarized</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>It is not so easy to correct configure the solarized for vim and gnome. It should be done in several steps.</p>

<h4 id="install-gnome-solarized-color-theme">Install gnome solarized color theme</h4>

<p>Use Bundle to install the <a href="https://github.com/sigurdga/gnome-terminal-colors-solarized">gnome</a>, after this, the background is ok, but the ls command only displays grey. It should be fixed.</p>

<h4 id="fix-the-ls-command">Fix the ls command</h4>

<p>Use this <a href="http://www.webupd8.org/2011/04/solarized-must-have-color-paletter-for.html">fix</a>.</p>

<h4 id="install-vim-solarized-color-theme">Install vim solarized color theme</h4>

<p>Use Bundle to install <a href="https://github.com/altercation/vim-colors-solarized">vim solarized</a>.</p>

<h3 id="useful-links-for-color-theme">Useful links for color theme</h3>

<p><a href="https://github.com/alghanmi/terminal_color_test">color test</a></p>

<p><a href="http://askubuntu.com/questions/137706/gnome-terminal-and-solarized-theme-coloring-issue">scipt5</a></p>

<p><a href="https://gist.github.com/t-mart/1280177">scipt6</a></p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/11/29/wushimeiyuan" rel="next" title="左宗棠题江苏无锡梅园">左宗棠题江苏无锡梅园</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/13/python-variable-scope-classes" rel="previous" title="Python variable scope">Python variable scope</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/life">life</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>Goals in 2014 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="About the 2014 plan." />
	

	
	<meta name="keywords" content="life plan" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>Goals in 2014</h1>
	<h4 class="large-bottom">
		Posted on 2014-02-03 01:01:43 +0900
		 in <a href="/categories/life">life</a> 

		<span class="tag-list">
			
			<a href="/tags/life">life</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h3 id="about-japanese-learning">About Japanese Learning</h3>

<p>I would like to take the J3 level example in the December of 2014.
J3 requires at least master three books, that is, Primary 1, Primary 2 and Middle 1.
Now I have Learned half of them. But besides learning, it is very important to take 
exercises as well, which I still did not pay enough attention on.</p>

<p>There are 25 lessions within one book, it usually takes at least two days to learn one
lesson. So it takes two months to learn book, so at the beginning of May I should finish
the learning of them and begin to do exercises.</p>

<p>Weekly Goal: three lessons and one attendance of Japanese language Learning.</p>

<p>Yearly Goal: Pass J3 and make a presentation in the Official building.</p>

<h3 id="about-data-analysis">About Data Analysis</h3>

<p>Now in the working, it is very important to analyze the data of the website, escecially 
there is no data analysis in the group now.</p>

<p>Within this year, there will be about 9 opening class in the Coursera which being given by
John Houpkins University.</p>

<p>Weekly Goal: Follow the course in the coursera and finish the exercises as well.</p>

<p>Yearly Goal: Master R and be able to analyze the data in the Google analysis using R.</p>

<h3 id="about-programming">About Programming</h3>

<p>Within this year, a totally new Labola web system will be built. In this way, I should know
everythin the full stack developer should know. Due to lack of knowledge in the web development,
it should be a tough task for me at first, but everything would go well after this year.</p>

<p>From selecting system framework to develop the system and test, publish. I should take the role
and make preparation to be a leader of the develop team.</p>

<p>In order to improve the programming skill, I should participate in the open souce project as well.</p>

<p>weekly Goal: write one blog about the open source project.</p>

<p>Yearly Goal:</p>

<p>2014.2 to 2014.6: read one python open source project and one C++ open source project.</p>

<p>2014.6 to 2014.12 Participate in one open source project.</p>

<h3 id="about-interest">About interest</h3>

<p>About soccer: try to play three times a week and try to be a important part of the team, to be a 
player in the real match, not only in the friendship match.</p>

<p>About Learning meeting: try to particitae one learning meeting within one month and try to ask for 
questions when particitate.</p>

<p>About social network: use Facebook, weibo, Linked in, tweet more. Make a new post every week about the 
technology and about the life each.</p>

<p>About weight: 70KG is the finally goal, reach 72 KG before 2014.6.</p>

<h3 id="at-last">At last</h3>

<p>Summarize the goals listed weekly, monthly and report.</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2015/02/09/2014" rel="next" title="说好的2014">说好的2014</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2014/01/24/linklist-mergesort" rel="previous" title="Linklist Mergesort">Linklist Mergesort</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/亲情">亲情</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>春节 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="春节" />
	

	
	<meta name="keywords" content="亲情 拜年" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>春节</h1>
	<h4 class="large-bottom">
		Posted on 2013-02-12 05:02:53 +0900
		 in <a href="/categories/生活">生活</a> 

		<span class="tag-list">
			
			<a href="/tags/亲情">亲情</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-回家">1 回家</h2>

<p>依如往常，今年回家比较晚。由于是一个人，又是早上五点四十到站，也不知道是不是有点兴奋，但是担心睡过站肯定是更主要的原因，下车的第一个感觉还是冷，冰凉刺骨的风吹的让我站不住，在县城等车的时候，原来小的时候觉得车特别多，路特别宽的一条路，现在觉得其实和学校里面的公路差不多，县城来了很多很多次了，但是每次来都是到想到的地方，一般是买件衣服或者别的东西，然后就回家，家里的县城应该是在我心中最大的一个地方，因为从小到现在我都不知道它到底有多大，所以我就一直觉得它很大很大，现在我仍然这么觉得。</p>

<p>在姥姥家呆了大半天之后，下午早早的就走路回家了，原来读初中的觉得特别的远，没想到其实走回去也就半个小时左右，其实和从学校走到寝室差不多。路没有变，我的脚步变长了，走的路和见的事情也多了，那曾经觉得特别有挑战性的事情、特别宽和远的路也变得平常起来。</p>

<h2 id="2-年夜">2 年夜</h2>

<p>晚上八点春晚开始，爸爸妈妈准时守在电视前看春晚，我则开着电脑，边看春晚，边在网上玩。其实心里还是有些期待的，每年都期待着当年的春晚能够让我喜出望外，但是基本上每年都很失望，就像中国男足一样，只是每次都很失望。未来总是被期待着，只是往往我的期待不合时宜的高，也许是太乐观，生活总是会不时的给我惊醒，告诉我要以一颗平常心看待成成败败。刘谦和郭德纲是我比较期待的，只是一个给我的感觉是表演没有达到我的预期，一个的幽默方式自己无法感同身受。</p>

<p>十二点我并没有像往年一样点燃爆竹，现在觉得爆竹很危险还没有太大的意思，还远远没有爸爸对爆竹感兴趣。村子里鞭炮声已经远远不能与当年相比，现在村子里面的年轻人很少了，村里的年轻人都搬到县城或者镇上了，只剩下了中老年人留守。</p>

<h2 id="3-拜年">3 拜年</h2>

<blockquote>
  <p>血缘关系中五服的计算方法：由于古代一夫多妻，因此，同父又同母的是一服，即所谓“同胞”、“一奶同胞”；同父不同母的是二服，例如《红楼梦》中贾宝玉与贾环。同祖父的是三服，例如《红楼梦》中贾宝玉与贾琏，同曾祖父的是四服，例如《红楼梦》中贾宝玉与宁国府的贾珍；同高祖父的是五服。
现代实行一夫一妻制，除非父亲离婚、丧偶后再婚再生育，一二服之间的区别通常消失，因此计算起来会令人困惑，错以为五服就是五代，实际上五服只四代。从祖父开始向上，不再分别妻妾的子女。</p>
</blockquote>

<p>早上五点半爸爸妈妈就起床了，新年的饺子是必不可少的，我起来后先给家里的亲戚朋友打电话拜个早年，在农村住的都打通了，城市里面的基本都没有打通，后面见了面才知道在城市的基本没有拜年，所以就没有早起。</p>

<p>八点半出门，去奶奶家，这是集合的开始。一直等到十点钟左右，在城市住的哥哥们带着一家人赶到奶奶家，我们就浩浩荡荡的出门了。拜年的队伍由我们<a href="http://baike.baidu.com/view/94895.htm" title="baidu_wufu">五服</a>之内的小辈向长辈问好，由于爷爷自己是兄弟四个，仅仅我爷爷就有五个儿子，所以拜年的队伍有20多个人。拜年到长辈家里，然后简单的聊一聊，主要是认一认亲，日后见着打招呼辈份不会出错。</p>

<h2 id="4-年聚">4 年聚</h2>

<p>中午我们整个家族的人到了城里已经预订好的酒店，今年是二爷组织招待的，整个安排的非常好。做了两桌，一桌上坐的是我的爸爸的辈份的，另外一桌坐的是我们这些小辈的。其实现在小辈的也平均有将近30岁了，哥哥姐姐们基本上都在市工作生活，事业上也算是小有所成，有的可能几年才能见一次。大家坐在一起现在基本都是讨论孩子、房子的问题，他们属于房子买的比较早的，像我这种现在还没有着落的，听着这些个问题就觉得听麻烦的，虽然觉得离自己还是比较远，但是仔细想想，其实也是很快的事情了，年轻人的梦想往往都是被无情的房价给消磨掉了，有一个哥哥为了孩子能读一个好的高中，贷款买学区房，各种压力，让我觉得蛮无奈的。</p>

<h2 id="5-长大">5 长大</h2>

<p>一转眼，就要26了。自己没觉得什么，倒是家里人总是问我婚姻、工作什么的。爷爷奶奶、姥姥姥爷都80+了，他们都在，让我觉得和小的时候差不多。爸爸妈妈待我仍如当初念初中高中那般，这种感觉蛮幸福的。喜欢一家人在一起热闹的感觉，在一起像当初一样嘻嘻笑笑的感觉，只是，现在大年初二要和表姐们的孩子们玩了，姐姐们都当了妈妈，终于没有人和我抢遥控器了，只是我也没有时间看电视，要陪客喝酒，还要力所能及的张罗下屋里屋外的事情，忙忙碌碌，却又有时候觉得没有当初好玩了。</p>

<p>长了了，意味着更多的责任，也意味着老一辈人渐渐退出主流的舞台，开始慢慢的退居后台。喜欢爸爸妈妈他们的生活态度，勤劳、吃苦、目标明确，他们真是我的好榜样，虽然生活上打打闹闹，但是他们身上那不服输的精神一直在激励着我。在我看来，父母的言传身教是最好的老师，他们之于我的东西我会珍存一辈子，受用一辈子。</p>

<p>可能这是最后一次如此惬意的寒假，也是我最后一次还能装装孩子，装着没长大，和爸爸没大没小的开着玩笑，多年父子成兄弟，无论有什么事情，虽然我现在文化水平比他们高一些，但是还是会和他们沟通，让他们也知道我的想法，他们也能明白我所说的道理。他们对我一直以来的支持是我一直以来最珍惜的财富。</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/02/13/backhome" rel="next" title="回乡路上">回乡路上</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/01/02/review-2012" rel="previous" title="review 2012">review 2012</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/回忆">回忆</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>review 2012 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="回首2012" />
	

	
	<meta name="keywords" content="生活" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>review 2012</h1>
	<h4 class="large-bottom">
		Posted on 2013-01-02 07:18:59 +0900
		 in <a href="/categories/生活">生活</a> 

		<span class="tag-list">
			
			<a href="/tags/回忆">回忆</a>
			
			<a href="/tags/展望">展望</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-回首">1 回首</h2>

<p>过去的2012年是失去的一年，是获得的一年，有很多遗憾，但是也有很多新的经历，总的来说，在这相对安稳的一年当中，收获相对往年有所减少，这是值得反思的一件事情。</p>

<p>从3月份返校，开始着重分析、搭建完成第一个机器学习相关的中央高校创新基金，同时，重点分析、优化Ray Tracing中的BVH，在六月份的时候完成了机器学习项目的初版并完成答辩，在六月份获得了优化的一个idea，开始动手写作。写作从动手，到回头做实验，完成初稿，投稿，历时一个月的时间。然后开始着手准备暑假去日本暑期学校的事情。原本以为去日本的暑期学校能勾兑下老师，最终的结果是惨不忍睹，只认识了一位美帝的老师，但是感觉学校不是太满意。从日本回来，也与在美帝读Ph.D的廖老师聊了不少，最终决定还是先找个工作，去美帝读Ph.D的想法基本上放弃了。</p>

<p>回校处理了点杂事，然后就开始准备找工作了。从刚开始百度、腾讯的顺利，到MS、google、Facebook的悲剧，整个过程算是高开低走，这也让我当初过于乐观和准备不足的缺点暴露了出来。代码能力本来就不是我的强项，加之准备又如此不充分，到最后只能是一个高不成，低不就的局面。</p>

<p>妹子找到了一份日本的工作，我和她都觉得工作挺好的，但是这样的话，很有可能要异地了。妹子是个要强的人，同时自己现在也不能够一个人就能把家里撑起来，里外为难。</p>

<h2 id="2-抉择">2 抉择</h2>

<p>一个是国内互联网公司的机器学习职位的研发工程师，没有户口，开始的薪资也是一个平均值，未来的发展也不是很确定。这样的好处是自己可以继续做技术，同时，有相对简单的工作环境，晋升与否完全看自己在工作中能力的表现，未来想在互联网公司间跳槽的话也相对简单，同时上升空间应该是没有限制的，限制自己的就是工作能力了。同时，如果两个人异地的话，这份工作能够帮助我去日本的概率要大的多。缺点来说，工作的强度应该会比较大，按照坊间传闻来说，朝九晚十可能是家常便饭，业余生活和健康应该是比较大的牺牲。</p>

<p>另外一个是银行的软开。按照IT技术在银行的地位来说，发展的空间要相对小一些，同时，作为国企，技术能力并不是最重要的，需要的是更好的综合能力。在这个方面，本人从小就没有接触过这种事情，同时，在性格方面，想要在里面要好的发展，必须要改变些东西。这个offer意味着相对稳定的生活，但是较小的上升空间，在生活和健康上有较好的保障，但是想出人头地基本很难了。</p>

<p>还有一种可能就是找到去日本的工作，作为自己来讲，去日本，还是想多多学习更好的前沿技术，这样在面对将来可能的变数时才会有更好的选择的机会，如果仅仅为了选择一个稳定的生活，我认为其意义并不是如此之大，毕竟，可能安逸的生活国内也能有，但是，发展的机会的话，应该没有国内好。毕竟，定居这个问题还是要考虑多种因素的，与日本的种种不缺定的未来，这是一个不得不考虑的问题。</p>

<p>一个选择基本上就意味着将来非常不同的生活轨迹。</p>

<h2 id="3-展望">3 展望</h2>

<p>希望来年自己去北京实习能够结交到新的朋友，能够适应公司的生活，同时能够多方面的了解信息，争取能够有更好的选择，希望也能够有更好的机会，如果去日本工作的话，希望大家都能顺顺利利的，同时，能够更多的了解业内的动向，结交更多的朋友，有更好的身体，能够找到一条双方都能接受的，早日不再异地的途径。未来很美好，但是自己过还是觉得太苦逼，不好玩。作为自己来讲，在我看来，自己的优势应该是一个较为整体的素质。我不是一个标准的Geek，但是，希望自己能够多读书，多接触挑战性的问题，也希望能够有好的运气，相信未来！</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/02/12/chinesenewyear" rel="next" title="春节">春节</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2012/12/28/how-to-install-the-template" rel="previous" title="如何使用模板">如何使用模板</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/大规模机器学习">大规模机器学习</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>语音技术沙龙 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="语音处理趋势" />
	

	
	<meta name="keywords" content="语音 技术 趋势" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>语音技术沙龙</h1>
	<h4 class="large-bottom">
		Posted on 2013-03-17 05:18:21 +0900
		 in <a href="/categories/语音">语音</a> 

		<span class="tag-list">
			
			<a href="/tags/语音">语音</a>
			
			<a href="/tags/趋势">趋势</a>
			
			<a href="/tags/大规模机器学习">大规模机器学习</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-报告内容">1 报告内容</h2>

<p>第一次在帝都现场参加技术talk的沙龙，比学校的talk要应用性实际的多。</p>

<p>第一个报告是百度语音部门负责人贾磊，主要讲了百度语音搜索在DNN领域的一些经验。百度成立了第一个研究院，Institute of Deep Learning，简称IDL。 由于Deep Learning在语音及多媒体领域面对海量数据的优越性，Google、Miscrosft等公司都开始投入大量的人力、物力做这样一件事情。
没带笔记本过去，凭记忆力列几个关键点。</p>

<ul>
  <li>处理流程为客户端编码、上传、服务器端处理、下放</li>
  <li>训练样本为10亿级，如考虑抗噪，会到百亿数量级</li>
  <li>MS的隐层深度为10层，Google的隐层数目为6层左右，输出层为9000维左右</li>
  <li>SGD（随机乱序），异步SGD，利用近似二阶梯度i信息为训练中重要方法</li>
  <li>节点间通信的带宽为主要瓶颈</li>
  <li>单个GPU核的计算能力相当于未优化的CPU核的400～500倍</li>
  <li>Google有chrome，所以可以在浏览器里加入语音的采集模块，百度没有多媒体采集的客户端，很受限制。</li>
</ul>

<p>第二个报告是IBM中国研究院的秦勇老师。分享了IBM在语音处理方面的进展，主要是大的picture</p>

<ul>
  <li>Itrans（IBM speech transcription server）能够将视频中的语音翻译成文本信息。这个应用在国外的客服领域应用较多，主要是在金融等行业。除此之外，对于很多talk形成文本话非常有意义</li>
  <li>讲解了Watson背后的技术DeepQA，虽然Watson目前只应用在娱乐节目上，但是可以将其扩展到如医疗等方向上，因为医学的知识不断的发展，而医生整理知识的工作是可以由Watson代替的</li>
  <li>分享了邮件的主题可视化，增加了直观性</li>
</ul>

<p>提出了几个有意思的点子：</p>

<ul>
  <li>有人在考虑实现如雅思、托福类的口语自动判卷。IBM没有做过商用，但是针对印度的口音做过类似的应用。IBM表示没有考虑语义，看来语义还是很难做的。如果这个效果好，简直可以大赚一笔</li>
  <li>可以实现学习如希特勒的说话特征，然后自动的根据特点生成语音。这个略犀利，如果做好了，以后接电话要小心了。</li>
  <li>通话质量的可视化</li>
</ul>

<p>感想：</p>

<ul>
  <li>DNN比拼的简直是工程实现能力，架构才是王道啊，机器+架构实现+数据源 是真正的瓶颈</li>
  <li>有想法，有技术，敢闯的人在帝都有这种交流的机会真是不错</li>
  <li>百度的浏览器、输入法等入口工具都起步太晚，导致了数据上的先天缺陷</li>
  <li>技术的交流是必须的，故步自封是要吃苦头的</li>
</ul>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/03/17/talkinjapaneseforeignaffair" rel="next" title="日本大使馆活动见闻">日本大使馆活动见闻</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/03/12/lifeinpeking" rel="previous" title="初体验">初体验</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/展望">展望</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>review 2012 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="回首2012" />
	

	
	<meta name="keywords" content="生活" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>review 2012</h1>
	<h4 class="large-bottom">
		Posted on 2013-01-02 07:18:59 +0900
		 in <a href="/categories/生活">生活</a> 

		<span class="tag-list">
			
			<a href="/tags/回忆">回忆</a>
			
			<a href="/tags/展望">展望</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-回首">1 回首</h2>

<p>过去的2012年是失去的一年，是获得的一年，有很多遗憾，但是也有很多新的经历，总的来说，在这相对安稳的一年当中，收获相对往年有所减少，这是值得反思的一件事情。</p>

<p>从3月份返校，开始着重分析、搭建完成第一个机器学习相关的中央高校创新基金，同时，重点分析、优化Ray Tracing中的BVH，在六月份的时候完成了机器学习项目的初版并完成答辩，在六月份获得了优化的一个idea，开始动手写作。写作从动手，到回头做实验，完成初稿，投稿，历时一个月的时间。然后开始着手准备暑假去日本暑期学校的事情。原本以为去日本的暑期学校能勾兑下老师，最终的结果是惨不忍睹，只认识了一位美帝的老师，但是感觉学校不是太满意。从日本回来，也与在美帝读Ph.D的廖老师聊了不少，最终决定还是先找个工作，去美帝读Ph.D的想法基本上放弃了。</p>

<p>回校处理了点杂事，然后就开始准备找工作了。从刚开始百度、腾讯的顺利，到MS、google、Facebook的悲剧，整个过程算是高开低走，这也让我当初过于乐观和准备不足的缺点暴露了出来。代码能力本来就不是我的强项，加之准备又如此不充分，到最后只能是一个高不成，低不就的局面。</p>

<p>妹子找到了一份日本的工作，我和她都觉得工作挺好的，但是这样的话，很有可能要异地了。妹子是个要强的人，同时自己现在也不能够一个人就能把家里撑起来，里外为难。</p>

<h2 id="2-抉择">2 抉择</h2>

<p>一个是国内互联网公司的机器学习职位的研发工程师，没有户口，开始的薪资也是一个平均值，未来的发展也不是很确定。这样的好处是自己可以继续做技术，同时，有相对简单的工作环境，晋升与否完全看自己在工作中能力的表现，未来想在互联网公司间跳槽的话也相对简单，同时上升空间应该是没有限制的，限制自己的就是工作能力了。同时，如果两个人异地的话，这份工作能够帮助我去日本的概率要大的多。缺点来说，工作的强度应该会比较大，按照坊间传闻来说，朝九晚十可能是家常便饭，业余生活和健康应该是比较大的牺牲。</p>

<p>另外一个是银行的软开。按照IT技术在银行的地位来说，发展的空间要相对小一些，同时，作为国企，技术能力并不是最重要的，需要的是更好的综合能力。在这个方面，本人从小就没有接触过这种事情，同时，在性格方面，想要在里面要好的发展，必须要改变些东西。这个offer意味着相对稳定的生活，但是较小的上升空间，在生活和健康上有较好的保障，但是想出人头地基本很难了。</p>

<p>还有一种可能就是找到去日本的工作，作为自己来讲，去日本，还是想多多学习更好的前沿技术，这样在面对将来可能的变数时才会有更好的选择的机会，如果仅仅为了选择一个稳定的生活，我认为其意义并不是如此之大，毕竟，可能安逸的生活国内也能有，但是，发展的机会的话，应该没有国内好。毕竟，定居这个问题还是要考虑多种因素的，与日本的种种不缺定的未来，这是一个不得不考虑的问题。</p>

<p>一个选择基本上就意味着将来非常不同的生活轨迹。</p>

<h2 id="3-展望">3 展望</h2>

<p>希望来年自己去北京实习能够结交到新的朋友，能够适应公司的生活，同时能够多方面的了解信息，争取能够有更好的选择，希望也能够有更好的机会，如果去日本工作的话，希望大家都能顺顺利利的，同时，能够更多的了解业内的动向，结交更多的朋友，有更好的身体，能够找到一条双方都能接受的，早日不再异地的途径。未来很美好，但是自己过还是觉得太苦逼，不好玩。作为自己来讲，在我看来，自己的优势应该是一个较为整体的素质。我不是一个标准的Geek，但是，希望自己能够多读书，多接触挑战性的问题，也希望能够有好的运气，相信未来！</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/02/12/chinesenewyear" rel="next" title="春节">春节</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2012/12/28/how-to-install-the-template" rel="previous" title="如何使用模板">如何使用模板</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/日本">日本</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>日本大使馆活动见闻 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="日本驻北京大使馆3.9活动" />
	

	
	<meta name="keywords" content="国外 生活 见闻" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>日本大使馆活动见闻</h1>
	<h4 class="large-bottom">
		Posted on 2013-03-17 08:23:16 +0900
		 in <a href="/categories/讲座">讲座</a> 

		<span class="tag-list">
			
			<a href="/tags/日本">日本</a>
			
			<a href="/tags/生活">生活</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-所见所闻">1 所见所闻</h2>

<p>本次活动邀请到了NHK Radio《波短情长》的主播人，也是著名的作家，许丹青老师。许老师从87年就开始在日本工作，但是至今还保留着中国国籍。其中的原因，他没有讲，但是他讲过这样一句话：虽然日本文化从中国借鉴了很多东西，但是在日本呆的时间越久，就越会觉得中日两种文化的不同，而不是觉得相近。之所以没有选择归化，应该还是和这种来自内心的文化认同感有关系。</p>

<p>许老师在日本大学任教，同时还在电台担任主持人，他的居住地在长角?，每周都要坐新干线去东京录制节目，他说他最骄傲的一件事情就是这么多年以来，从来没有因为大雨台风之类的原因迟到过。我想这也许就是日本精神内涵之一吧，敬业。</p>

<p>许老师讲到的最让我感动也是最让我震撼的是日本人内心存在对土地、对自然的敬畏之情。他讲了这样一个例子：他有一个学生，暂称为小野，小野来自农村，家里父亲是种茄子的。小野是一个很有上进心的人，打算毕业之后到东京去闯荡一番，并且，也拿到了东京的公司的offer，许老师在毕业之前，请他去一家中国的东北菜餐馆吃饭，也算是践行。许老师点了地三鲜（茄子，土豆，青椒），小野吃了一口茄子，然后突然就有点呆住了，眼睛有点发红的感觉，许老师以为出了什么事情，很担心的问他怎么了，小野缓缓的说道：我从来没有吃过这么好吃的茄子，原来茄子是这么的好吃。我决定了，不去东京了，回家和父亲种一辈子茄子。后来，他真的回家种茄子去了。在京都呆了半个月，城市的干净整洁，人们的高尚品德其实没有给我太深刻的印象，反而是遍布在整个城市的神社让我很是吃惊。在国内，现在连公园都变成了多么奢侈的东西，更不用说在大多数无神论者的国人眼中这丝毫不能带来收益的神道了。日本文化更多的是形式主义，与百花争艳相比，他们更喜欢樱花凋落的凄美。日本四周都是海，自然灾害频发，他们看到的是充满绝望色彩的海平线，与此相比，中国的自然条件要优越的多，我们看到更多的是充满希望色彩的地平线主义，大行其道的是说服文化。或许，正因为国人内心无所畏惧，所以现在的社会底线一次一次的失守。无所敬畏，所以无所不用其极，从这个层面上来看，我们要意识到自己是多么的幸运，在享受着多么优越的自然条件，多么丰富的物产，多么稳定的自然环境。</p>

<p>在日本有很多的以鬼为主题的艺术表演题材，并且有很多让人体验的鬼屋等，同时，据我所知，日本的鬼片拍的是最让人发自内心的恐怖与害怕的。有所畏惧，才能让人守住底线。</p>

<p>日本社会制度是非常人性化的，在社会设施方面，针对不方便者有非常严格的法律来保证其相应的权利。同时，日本人的细心让人非常的赞叹，日本的塑料口袋是黄色的，原因是，乌鸦看不见黄色的口袋。同时日本人的热心从负责赴日留学的负责人的介绍那里就能看出。很多同学问她赴日留学是否通过中介能够有较高的成功率，她这样说的：大家在学校一定要好好读书，有好的GPA，赴日申请的材料拿给我，我帮大家改，我最希望能够帮助那些家里比较贫困，但是自己又认真上进的学生。这句话她前后总共强调过三四次。</p>

<p>日本在二战之后，能够有如此飞速的发展，和他们上一辈的国民有很大的关系。在京都的半个月里，让我最感到意外的是，由于我不会日语，在京都问路都是用英语。基本上日本的年轻人都不愿意开后说英语，或许是因为他们觉得自己的英语口语不够好，反倒是日本七八十岁的老年人，给我印象最深刻的有两个，第一个是我刚到日本招不到住宿的地方时，主动带我们找这个地方的老婆婆。她已经85岁了，当时在学习日本国画，我们就很好奇这其中的原因，她就说，不愿意输给年轻人。另外一个是早上很早在公交车站牌，我想去清水司，但是不确定路线，在站牌只有一个老婆婆，于是乎只有硬着头皮问，不想因为老婆婆不懂英语而难堪，所以我就拿着地图用手指着目的地，希望她能给我指一下路线。让我吃惊的是，她说了一句，map？我吓到了，反应了一下开心的和老婆婆交谈起来。老婆婆告诉我在飞鸟町换乘，就能到了。我研究了一下地图，发现可以直接坐到飞鸟町的下一站，也就是京都大学门口，去那里吃个饭，然后再过去。于是，在飞鸟町那里，我就没有下，就在这个时候，我听到后面有人急匆匆的跑过来，回头一看原来就是那个老婆婆，老婆婆告诉我，就是这一站下去换乘，于是乎，我就很感动的下去了，然后走到了京都大学门口吃得饭，随后才去了清水寺。</p>

<p>日本经历过经济发展时空气质量的恶化，而治理空气质量，日本花了40年，我想，中国，如果不转变发展思路，40年也是很难做到的。当日本经济泡沫严重时，东京的房价也让年轻人叫苦不迭，因为按照工资收入，一辈子都买不起一套房，结果，后来经济泡沫破裂，房价急速下坠，随后就是日本一直至今的失落的20年。</p>

<p>但是有一个问题，日本一直很重视。日本对历史文化的保护，这是我们难以想象的。许老师讲了这样一个故事，有一个浙江大学的建筑学教授，主要钻研唐宋时代的建筑，为了找到和历史资料中一致的建筑古迹，他在全国各地寻觅几十年也未曾见过。一个偶然的机会，他到京都旅游，当他第一眼看到京都的一个普通的桥时，突然激动的流泪了，他说到：这就是我找了这么多年的原迹，不信的话，我拿尺子量给你看。诸如此类，如本源自中国的全木制建筑东大寺等，不胜枚举。在去成都读书之前，我在CCTV上知道了成都的宽宅巷子，所以一到成都，我就先跑到那里去膜拜膜拜，想目睹下这个天府之国的历史韵味。但是，就像现在所有的古镇及名人故居一样，它依然充满的是商业的气息。我到一个地方，最先想去的就是博物馆，了解历史，才能看清昨天我们来时的路，也能知道，我们不过是历史的过客，早晚也沉睡于历史的尘埃之中。但是，在博物馆，我看到的完整文物很少，大多数的文物，尤其是石制的雕塑，几乎绝大多数都没有头部，这要归功于历史的盗墓者，他偷走的是前人留给我们的共同记忆，悲乎！</p>

<p>日本现在有1.27亿人口，但是现在年轻人丁克现象比较严重，如果想维持好的经济发展势头，按照现在的人口规模发展速度是不够的，因此，他们局安思危，开始逐步的放开移民政策，接受外国的优秀人才。并且，有研究数据显示，一个国家的外来人口只要不超过10%，整个社会就是稳定的，否则，很容易出现如欧洲存在的种族歧视等外来移民问题。主要分两部走：</p>

<ul>
  <li>首先提出了旅游兴日的口号。希望能够吸引越来越多的外国人赴日旅游，他们当初提出的口号是在2012年达到年总数1000万的规模，但是由于海啸等自然灾害的原因，去年赴日旅游的外国人只有700万左右。其实，这是他们为移民政策放开做的前期准备。</li>
  <li>开展了本科联合培养2+2.5等政策，在4.5年的时间里，就可以拿到两个国家两所学校的文凭，这其中的0.5，没有课时安排，纯粹是给毕业生留下半年的时间在日本找工作。同时，现在越来越多的日本企业开始雇佣外国员工，这也是在响应国家号召。</li>
</ul>

<p>于是乎，现在出现了越来越多的归化人。选择一个国籍其实只是一种形式，关键是，自己内心真正认同的是哪一种文化，否则，就像是国家选主席一样，自己不care，因为care也改变不了什么，和自己也没有关系，没有存在感。</p>

<h2 id="2-漫画">2 漫画</h2>

<p>活动的第二部分请来了中国著名的漫画家胡蓉，胡蓉在中国连环画兴盛的时候开始接触画画，很小就获得了中国连环画的大奖，随着连环画在国内的逐渐没落，她开始走向漫画的道路，并在26岁的时候，第一位以艺术交流的身份赴日学习，并且获得了不错的成绩，现在在日本与中国均有工作室。她强调，自己赴日本的时候，世界观已经形成，因此在日本，绘画技巧的学习并不是最主要的，因为她的内心已经很难被重新刻画，但是，这些经历，让她对生活的理解更深厚了，更多彩了。前几天碰上一个清华美院的学生，她非常的为国人做出一部动画片，然后面试者问她为什么不读硕士或者博士，她是这样说的：我没有生活，我每天的生活就是13个人，因为清华美院她们专业每年只招13个人，必须有生活，才能有画的灵魂。</p>

<p>当谈到中国漫画的未来时，胡蓉提到了一个日本学者的看法：中国的漫画会向当初的连环画一样，最终走向的是艺术的道路，就像是美术，而不会走上商业的道路。因为漫画的本质意味着快速的传播与复制。具体连环画的没落我不太清楚，但是，在我看来，就像是中国的作家的生存现状一样，每一个文化人在当前的大环境下都是很难生存的，所以，漫画应该也是如此。</p>

<p>如果高中毕业就想赴日本都漫画专业，这是比较有难度的：</p>

<ul>
  <li>日本公立大学漫画专业设置很少，大多数均为私立大学。这意味着拿奖学金的机会很少。</li>
  <li>如果要赴日本读本科，日语最起码要过四级，最好要过2级。</li>
</ul>

<h2 id="3-赴日读博">3 赴日读博</h2>

<ul>
  <li>建议给日本教授写书信，而不是电子邮件。据说是因为很多学校的邮箱会block邮件，导致老师收不到邮件。研究计划是非常被看重的。</li>
  <li>如果拿到文部省奖学金是非常好的，这样就可以联系日本最好的学校。</li>
</ul>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/10/29/gitcommands" rel="next" title="Git Commands">Git Commands</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/03/17/techtalkvoice" rel="previous" title="语音技术沙龙">语音技术沙龙</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/生活">生活</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>日本大使馆活动见闻 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="日本驻北京大使馆3.9活动" />
	

	
	<meta name="keywords" content="国外 生活 见闻" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>日本大使馆活动见闻</h1>
	<h4 class="large-bottom">
		Posted on 2013-03-17 08:23:16 +0900
		 in <a href="/categories/讲座">讲座</a> 

		<span class="tag-list">
			
			<a href="/tags/日本">日本</a>
			
			<a href="/tags/生活">生活</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-所见所闻">1 所见所闻</h2>

<p>本次活动邀请到了NHK Radio《波短情长》的主播人，也是著名的作家，许丹青老师。许老师从87年就开始在日本工作，但是至今还保留着中国国籍。其中的原因，他没有讲，但是他讲过这样一句话：虽然日本文化从中国借鉴了很多东西，但是在日本呆的时间越久，就越会觉得中日两种文化的不同，而不是觉得相近。之所以没有选择归化，应该还是和这种来自内心的文化认同感有关系。</p>

<p>许老师在日本大学任教，同时还在电台担任主持人，他的居住地在长角?，每周都要坐新干线去东京录制节目，他说他最骄傲的一件事情就是这么多年以来，从来没有因为大雨台风之类的原因迟到过。我想这也许就是日本精神内涵之一吧，敬业。</p>

<p>许老师讲到的最让我感动也是最让我震撼的是日本人内心存在对土地、对自然的敬畏之情。他讲了这样一个例子：他有一个学生，暂称为小野，小野来自农村，家里父亲是种茄子的。小野是一个很有上进心的人，打算毕业之后到东京去闯荡一番，并且，也拿到了东京的公司的offer，许老师在毕业之前，请他去一家中国的东北菜餐馆吃饭，也算是践行。许老师点了地三鲜（茄子，土豆，青椒），小野吃了一口茄子，然后突然就有点呆住了，眼睛有点发红的感觉，许老师以为出了什么事情，很担心的问他怎么了，小野缓缓的说道：我从来没有吃过这么好吃的茄子，原来茄子是这么的好吃。我决定了，不去东京了，回家和父亲种一辈子茄子。后来，他真的回家种茄子去了。在京都呆了半个月，城市的干净整洁，人们的高尚品德其实没有给我太深刻的印象，反而是遍布在整个城市的神社让我很是吃惊。在国内，现在连公园都变成了多么奢侈的东西，更不用说在大多数无神论者的国人眼中这丝毫不能带来收益的神道了。日本文化更多的是形式主义，与百花争艳相比，他们更喜欢樱花凋落的凄美。日本四周都是海，自然灾害频发，他们看到的是充满绝望色彩的海平线，与此相比，中国的自然条件要优越的多，我们看到更多的是充满希望色彩的地平线主义，大行其道的是说服文化。或许，正因为国人内心无所畏惧，所以现在的社会底线一次一次的失守。无所敬畏，所以无所不用其极，从这个层面上来看，我们要意识到自己是多么的幸运，在享受着多么优越的自然条件，多么丰富的物产，多么稳定的自然环境。</p>

<p>在日本有很多的以鬼为主题的艺术表演题材，并且有很多让人体验的鬼屋等，同时，据我所知，日本的鬼片拍的是最让人发自内心的恐怖与害怕的。有所畏惧，才能让人守住底线。</p>

<p>日本社会制度是非常人性化的，在社会设施方面，针对不方便者有非常严格的法律来保证其相应的权利。同时，日本人的细心让人非常的赞叹，日本的塑料口袋是黄色的，原因是，乌鸦看不见黄色的口袋。同时日本人的热心从负责赴日留学的负责人的介绍那里就能看出。很多同学问她赴日留学是否通过中介能够有较高的成功率，她这样说的：大家在学校一定要好好读书，有好的GPA，赴日申请的材料拿给我，我帮大家改，我最希望能够帮助那些家里比较贫困，但是自己又认真上进的学生。这句话她前后总共强调过三四次。</p>

<p>日本在二战之后，能够有如此飞速的发展，和他们上一辈的国民有很大的关系。在京都的半个月里，让我最感到意外的是，由于我不会日语，在京都问路都是用英语。基本上日本的年轻人都不愿意开后说英语，或许是因为他们觉得自己的英语口语不够好，反倒是日本七八十岁的老年人，给我印象最深刻的有两个，第一个是我刚到日本招不到住宿的地方时，主动带我们找这个地方的老婆婆。她已经85岁了，当时在学习日本国画，我们就很好奇这其中的原因，她就说，不愿意输给年轻人。另外一个是早上很早在公交车站牌，我想去清水司，但是不确定路线，在站牌只有一个老婆婆，于是乎只有硬着头皮问，不想因为老婆婆不懂英语而难堪，所以我就拿着地图用手指着目的地，希望她能给我指一下路线。让我吃惊的是，她说了一句，map？我吓到了，反应了一下开心的和老婆婆交谈起来。老婆婆告诉我在飞鸟町换乘，就能到了。我研究了一下地图，发现可以直接坐到飞鸟町的下一站，也就是京都大学门口，去那里吃个饭，然后再过去。于是，在飞鸟町那里，我就没有下，就在这个时候，我听到后面有人急匆匆的跑过来，回头一看原来就是那个老婆婆，老婆婆告诉我，就是这一站下去换乘，于是乎，我就很感动的下去了，然后走到了京都大学门口吃得饭，随后才去了清水寺。</p>

<p>日本经历过经济发展时空气质量的恶化，而治理空气质量，日本花了40年，我想，中国，如果不转变发展思路，40年也是很难做到的。当日本经济泡沫严重时，东京的房价也让年轻人叫苦不迭，因为按照工资收入，一辈子都买不起一套房，结果，后来经济泡沫破裂，房价急速下坠，随后就是日本一直至今的失落的20年。</p>

<p>但是有一个问题，日本一直很重视。日本对历史文化的保护，这是我们难以想象的。许老师讲了这样一个故事，有一个浙江大学的建筑学教授，主要钻研唐宋时代的建筑，为了找到和历史资料中一致的建筑古迹，他在全国各地寻觅几十年也未曾见过。一个偶然的机会，他到京都旅游，当他第一眼看到京都的一个普通的桥时，突然激动的流泪了，他说到：这就是我找了这么多年的原迹，不信的话，我拿尺子量给你看。诸如此类，如本源自中国的全木制建筑东大寺等，不胜枚举。在去成都读书之前，我在CCTV上知道了成都的宽宅巷子，所以一到成都，我就先跑到那里去膜拜膜拜，想目睹下这个天府之国的历史韵味。但是，就像现在所有的古镇及名人故居一样，它依然充满的是商业的气息。我到一个地方，最先想去的就是博物馆，了解历史，才能看清昨天我们来时的路，也能知道，我们不过是历史的过客，早晚也沉睡于历史的尘埃之中。但是，在博物馆，我看到的完整文物很少，大多数的文物，尤其是石制的雕塑，几乎绝大多数都没有头部，这要归功于历史的盗墓者，他偷走的是前人留给我们的共同记忆，悲乎！</p>

<p>日本现在有1.27亿人口，但是现在年轻人丁克现象比较严重，如果想维持好的经济发展势头，按照现在的人口规模发展速度是不够的，因此，他们局安思危，开始逐步的放开移民政策，接受外国的优秀人才。并且，有研究数据显示，一个国家的外来人口只要不超过10%，整个社会就是稳定的，否则，很容易出现如欧洲存在的种族歧视等外来移民问题。主要分两部走：</p>

<ul>
  <li>首先提出了旅游兴日的口号。希望能够吸引越来越多的外国人赴日旅游，他们当初提出的口号是在2012年达到年总数1000万的规模，但是由于海啸等自然灾害的原因，去年赴日旅游的外国人只有700万左右。其实，这是他们为移民政策放开做的前期准备。</li>
  <li>开展了本科联合培养2+2.5等政策，在4.5年的时间里，就可以拿到两个国家两所学校的文凭，这其中的0.5，没有课时安排，纯粹是给毕业生留下半年的时间在日本找工作。同时，现在越来越多的日本企业开始雇佣外国员工，这也是在响应国家号召。</li>
</ul>

<p>于是乎，现在出现了越来越多的归化人。选择一个国籍其实只是一种形式，关键是，自己内心真正认同的是哪一种文化，否则，就像是国家选主席一样，自己不care，因为care也改变不了什么，和自己也没有关系，没有存在感。</p>

<h2 id="2-漫画">2 漫画</h2>

<p>活动的第二部分请来了中国著名的漫画家胡蓉，胡蓉在中国连环画兴盛的时候开始接触画画，很小就获得了中国连环画的大奖，随着连环画在国内的逐渐没落，她开始走向漫画的道路，并在26岁的时候，第一位以艺术交流的身份赴日学习，并且获得了不错的成绩，现在在日本与中国均有工作室。她强调，自己赴日本的时候，世界观已经形成，因此在日本，绘画技巧的学习并不是最主要的，因为她的内心已经很难被重新刻画，但是，这些经历，让她对生活的理解更深厚了，更多彩了。前几天碰上一个清华美院的学生，她非常的为国人做出一部动画片，然后面试者问她为什么不读硕士或者博士，她是这样说的：我没有生活，我每天的生活就是13个人，因为清华美院她们专业每年只招13个人，必须有生活，才能有画的灵魂。</p>

<p>当谈到中国漫画的未来时，胡蓉提到了一个日本学者的看法：中国的漫画会向当初的连环画一样，最终走向的是艺术的道路，就像是美术，而不会走上商业的道路。因为漫画的本质意味着快速的传播与复制。具体连环画的没落我不太清楚，但是，在我看来，就像是中国的作家的生存现状一样，每一个文化人在当前的大环境下都是很难生存的，所以，漫画应该也是如此。</p>

<p>如果高中毕业就想赴日本都漫画专业，这是比较有难度的：</p>

<ul>
  <li>日本公立大学漫画专业设置很少，大多数均为私立大学。这意味着拿奖学金的机会很少。</li>
  <li>如果要赴日本读本科，日语最起码要过四级，最好要过2级。</li>
</ul>

<h2 id="3-赴日读博">3 赴日读博</h2>

<ul>
  <li>建议给日本教授写书信，而不是电子邮件。据说是因为很多学校的邮箱会block邮件，导致老师收不到邮件。研究计划是非常被看重的。</li>
  <li>如果拿到文部省奖学金是非常好的，这样就可以联系日本最好的学校。</li>
</ul>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/10/29/gitcommands" rel="next" title="Git Commands">Git Commands</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/03/17/techtalkvoice" rel="previous" title="语音技术沙龙">语音技术沙龙</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	
	<title>初体验 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="在京感悟" />
	

	
	<meta name="keywords" content="生活 思考" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>初体验</h1>
	<h4 class="large-bottom">
		Posted on 2013-03-12 23:50:50 +0900
		 in <a href="/categories/生活">生活</a> 

		<span class="tag-list">
			
			<a href="/tags/生活">生活</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-帝都的工作">1 帝都的工作</h2>
<p>从马斯洛需求模型来讲，人类工作的目的也大抵分为这三类：第一类为生活所困，工作无非就是生存下去的手段，第二类为大抵能做着自己喜欢的事情，工作也大抵能够满足自己不太过分的要求，有时候明明自己很不喜欢做的事情，往往也因为生活所迫不得不就范，第三类大抵就是能够在工作上得心应手，且物质精神上都十分满足的人了。</p>

<p>在每个社会当中这三者的比例是不同的，但是绝对和时间和地理因素有关，作为个人来讲，这绝对和社会有莫大的关系，一人之力是基本不能阻挡社会的洪流的，北京早上的地铁就是最好的证明：无论一个人是多么的君子，只要他不得不在高峰期的地铁上，那么他所有的修养和尊严都不得不放下，生存，是唯一的法则。</p>

<p>在当前的国内社会状况下，这是一个投机远比实干有价值的时代。在这个地方，同事间业余生活的主题基本就是房子、房子、房子。年轻人天天盼着自己老家的旧房子和地能在旧城改造中被拆迁到，然后就能大发一笔，要不就是讨论国家宏观调控的政策，不断的学习国家的政策文件，以期能够像90，00年代抓住房地产改革的红利，或者是2000年前互联网高速扩张，像马云、丁磊等一夜爆发的奇迹，但是，时代不同了，留给我们的现实世界是：利益分配的规则已经画好了，我们局外人很难改变这种利益分配严重不均的格局，于是乎，想法设法的利用制度成为每个人最大的兴趣和努力的方向。在北京，人口2600万（无官方数据），汽车512万辆，房价均价3W+，空气质量全国基本最差，但是它仍然是多数人的首选。</p>

<p>首先，北京有无与伦比的资源。这包括最优质的教育资源，这是留给后代最有价值的财富，也有最优质的医疗、交通、精神生活。一句话，全国最优质的资源+全国最优秀的人才打造了一个让人梦寐以求的北京。其次，因为北京有很多地方没有的机会，比如说互联网公司，除了北京，其他地方发展差距太大，由于地域问题所导致的发展不均，然后又因为发展不均导致了诸如户口制度、地域歧视等等问题，马太效应会加剧这种现象，对人次的吸引能力严重不均从长远来看，诸如此类现象也将会越来越严重。</p>

<p>大多数人都是制度的牺牲品，在发展速度渐渐变缓的社会大环境面前，年轻人成功的机会相对少的多，制度的制定者已经将年轻人向上的空间挤兑的很小，大多数人只能成为所谓中国梦的打工者，当贡献完自己的青春之后，被北京淘汰，然后下一批的年轻人怀揣着梦想到来，周而复始。</p>

<p>这样的社会现实面前，人不为钱工作是不可能的。当背负着沉重的房贷与家庭的不菲开销时，就像在地铁上一样，所做的只有顺从。在这里绝大多数人都是为钱工作，自己凭什么能够不被这个城市淘汰呢？</p>

<p>做自己喜欢的、有价值的事情，能够不为钱工作是我的目标。</p>

<h2 id="2-公司文化感触">2 公司文化感触</h2>

<p>作为一个有上万员工的公司，内部势必存在着内耗与斗争。组织机构庞大，行动就变得迟缓。沟通的成本特别高，对资源的争夺也特别的激烈。于是乎，每天都要开几个会，如果部门涉及到比较多的业务逻辑，需要跟多个部门交流，整个过程十分的繁琐。绝大多数的会议主角就是领导与汇报者，因为其他的成员很难知道汇报者业务的具体情况，所以，基本上会议的90%以上会一无所知，另外的10%或许能知其一二。
很讽刺的情况在于，很多时候重复造轮子居然会比通过流程申请某些资源来的快的多。
非休假状态下，基本上工作就等于生活，无法想象晚上十点之前到家是个什么情形，其实，对自己充电才是最终要的。</p>

<h2 id="3-做一个主动的人">3 做一个主动的人</h2>

<p>并不是永远都只有悲观的消息，有的进入公司的时候就带着某种光环，基本上注定会成为明日之星，大多数人都是从默默无闻，自己慢慢做起来。今天刚刚上线了一个新的功能，次功能对与公司来说不能算是大工程，但是绝对很有意义。一个前辈从发现这个问题，然后利用自己原有的一些积累，最后联合了非常多的部门以及外部的资源，最终能够将这个事情定下来，并且终于能够今日上线。最为一个牵头人，他的主动性让我感到十分的佩服。</p>

<h2 id="4-技术还是管理">4 技术还是管理</h2>

<p>高层的技术不是很清楚，能做到top固然NB，但是还是保证做到top之前能保证基本的身体健康吧，颈椎病和腰肌劳损屡见不鲜。眼看着自己的肚子越来越大，却苦于帝都的空气不敢造次，这是一个什么样的恶性循环。每次看着老大中午躲在休息室吃泡面，我都觉得很异样，管理者要开会，开会开会…爬不到上面日子就好过不得，或许这也是大家加班的原因吧</p>

<h2 id="5-跳跃式发展">5 跳跃式发展</h2>

<p>我们听到过顺丰的快递员收入上万，或者说早晨卖煎蛋饼的商贩如此赚钱的说法。但是都忽略了一个说法，这种收入的增长是线性的，因为只会随着自己的熟练程度增加，然后趋于稳定。线性增长的工作很难收入上有大的breakthrough，个人成长也是一样的，什么样的事情能够让自己跳跃式发展而不是线性发展才是最终要的。</p>

<h2 id="6-财富自由">6 财富自由</h2>

<p>我来到这个世界上就想多看看，像这对<a href="http://v.youku.com/v_show/id_XMzgxMzE0NTI4.html">老夫妻</a>一样,达到这一点财富自由是必须的，我想展现自己的价值，能够多为他人带来一些帮助。实现财富自由是一条漫长的学习之路，但是，生活不是目的，生活的终点都是一样的，但是过程就不一样了，米什么的都是浮云，能够多漂一漂才是最幸福的。</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/03/17/techtalkvoice" rel="next" title="语音技术沙龙">语音技术沙龙</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/02/13/backhome" rel="previous" title="回乡路上">回乡路上</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/诗歌">诗歌</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>回乡路上 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="回乡路上" />
	

	
	<meta name="keywords" content="回家 诗歌" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>回乡路上</h1>
	<h4 class="large-bottom">
		Posted on 2013-02-13 00:36:41 +0900
		 in <a href="/categories/生活">生活</a> 

		<span class="tag-list">
			
			<a href="/tags/诗歌">诗歌</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>我远远的观望者别人的生活，<br />
自己却仿佛没有生活过一样。<br />
列车无时无刻不在翻山越岭，<br />
自己却不知道下一站在何方。<br />
那曾经熟悉的面孔依旧，<br />
自己却面目全非。<br />
那曾有的欢歌笑语已经远去，<br />
如今却只能兀自发呆。<br />
出发了太久，<br />
竟模糊了当初梦想的模样。<br />
但是我并不愿意妥协，<br />
我想去远方，<br />
用脚步丈量高山，<br />
用双手拥抱大川。<br />
山川就在那里，<br />
远方也在那里，<br />
出发了不要问路在哪，<br />
一直向前是唯一的方法。</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/03/12/lifeinpeking" rel="next" title="初体验">初体验</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/02/12/chinesenewyear" rel="previous" title="春节">春节</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/诗词">诗词</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>左宗棠题江苏无锡梅园 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="左宗棠题江苏无锡梅园" />
	

	
	<meta name="keywords" content="诗词" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>左宗棠题江苏无锡梅园</h1>
	<h4 class="large-bottom">
		Posted on 2013-11-29 02:48:25 +0900
		 in <a href="/categories/诗词">诗词</a> 

		<span class="tag-list">
			
			<a href="/tags/诗词">诗词</a>
			
		</span>
	</h4>
	
	<div class="content">
		<p>《左宗棠题江苏无锡梅园》</p>

<p>　　发上等愿，</p>

<p>　　结中等缘，</p>

<p>　　享下等福，</p>

<p>　　择高处立，</p>

<p>　　寻平处坐，</p>

<p>　　向宽处行。</p>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/12/06/vimnote" rel="next" title="Vim Tips">Vim Tips</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/11/19/solarized-install" rel="previous" title="Install solarized color theme">Install solarized color theme</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/语音">语音</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>语音技术沙龙 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="语音处理趋势" />
	

	
	<meta name="keywords" content="语音 技术 趋势" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>语音技术沙龙</h1>
	<h4 class="large-bottom">
		Posted on 2013-03-17 05:18:21 +0900
		 in <a href="/categories/语音">语音</a> 

		<span class="tag-list">
			
			<a href="/tags/语音">语音</a>
			
			<a href="/tags/趋势">趋势</a>
			
			<a href="/tags/大规模机器学习">大规模机器学习</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-报告内容">1 报告内容</h2>

<p>第一次在帝都现场参加技术talk的沙龙，比学校的talk要应用性实际的多。</p>

<p>第一个报告是百度语音部门负责人贾磊，主要讲了百度语音搜索在DNN领域的一些经验。百度成立了第一个研究院，Institute of Deep Learning，简称IDL。 由于Deep Learning在语音及多媒体领域面对海量数据的优越性，Google、Miscrosft等公司都开始投入大量的人力、物力做这样一件事情。
没带笔记本过去，凭记忆力列几个关键点。</p>

<ul>
  <li>处理流程为客户端编码、上传、服务器端处理、下放</li>
  <li>训练样本为10亿级，如考虑抗噪，会到百亿数量级</li>
  <li>MS的隐层深度为10层，Google的隐层数目为6层左右，输出层为9000维左右</li>
  <li>SGD（随机乱序），异步SGD，利用近似二阶梯度i信息为训练中重要方法</li>
  <li>节点间通信的带宽为主要瓶颈</li>
  <li>单个GPU核的计算能力相当于未优化的CPU核的400～500倍</li>
  <li>Google有chrome，所以可以在浏览器里加入语音的采集模块，百度没有多媒体采集的客户端，很受限制。</li>
</ul>

<p>第二个报告是IBM中国研究院的秦勇老师。分享了IBM在语音处理方面的进展，主要是大的picture</p>

<ul>
  <li>Itrans（IBM speech transcription server）能够将视频中的语音翻译成文本信息。这个应用在国外的客服领域应用较多，主要是在金融等行业。除此之外，对于很多talk形成文本话非常有意义</li>
  <li>讲解了Watson背后的技术DeepQA，虽然Watson目前只应用在娱乐节目上，但是可以将其扩展到如医疗等方向上，因为医学的知识不断的发展，而医生整理知识的工作是可以由Watson代替的</li>
  <li>分享了邮件的主题可视化，增加了直观性</li>
</ul>

<p>提出了几个有意思的点子：</p>

<ul>
  <li>有人在考虑实现如雅思、托福类的口语自动判卷。IBM没有做过商用，但是针对印度的口音做过类似的应用。IBM表示没有考虑语义，看来语义还是很难做的。如果这个效果好，简直可以大赚一笔</li>
  <li>可以实现学习如希特勒的说话特征，然后自动的根据特点生成语音。这个略犀利，如果做好了，以后接电话要小心了。</li>
  <li>通话质量的可视化</li>
</ul>

<p>感想：</p>

<ul>
  <li>DNN比拼的简直是工程实现能力，架构才是王道啊，机器+架构实现+数据源 是真正的瓶颈</li>
  <li>有想法，有技术，敢闯的人在帝都有这种交流的机会真是不错</li>
  <li>百度的浏览器、输入法等入口工具都起步太晚，导致了数据上的先天缺陷</li>
  <li>技术的交流是必须的，故步自封是要吃苦头的</li>
</ul>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/03/17/talkinjapaneseforeignaffair" rel="next" title="日本大使馆活动见闻">日本大使馆活动见闻</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/03/12/lifeinpeking" rel="previous" title="初体验">初体验</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>

  <h4 class="low-top"><a href="/tags/趋势">趋势</a> (<!DOCTYPE html>
<html>
<head>
	
	<title>语音技术沙龙 - kamelzcs's library</title>
	
	
	<meta name="author" content="kamelzcs" />
	
	<meta name="description" content="语音处理趋势" />
	

	
	<meta name="keywords" content="语音 技术 趋势" />	
	

	<meta name="robots" content="noodp, nydir" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<link href="/css/blueprint/screen.css" type="text/css" rel="stylesheet" />
	<!--[if lt IE 8]> <link href="/css/blueprint/ie.css" type="text/css" rel="stylesheet" /> <![endif]-->	 
	<link href="/css/railscasts.css" type="text/css" rel="stylesheet" />
	<link href="/css/site.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="/js/writeCapture-1.0.5-nolib-min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/site.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45986644-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<script src="https://www.google.com/jsapi" type="text/javascript"></script>
  <script language="Javascript" type="text/javascript">
  //<![CDATA[
google.load("search", "1");

function OnLoad() {
	// Create a search control
	var searchControl = new google.search.SearchControl();
	
	// Add in a WebSearch
	var webSearch = new google.search.WebSearch();
	
	// Restrict our search to pages from this site
	webSearch.setSiteRestriction('kamelzcs.github.com');
	
	// Add the searcher to the SearchControl
	searchControl.addSearcher(webSearch);
	
	// tell the searcher to draw itself and tell it where to attach
	searchControl.draw(document.getElementById("searchcontrol"));
	// Add the value of "Search..." to the input field and a class of .empty
}

google.setOnLoadCallback(function() {
  $(function() {
	OnLoad()
	$(".gsc-input > input").val("Search... powered by Google").addClass("empty");
	 
	// When you click on #search
	$(".gsc-input > input").focus(function(){
	 
		// If the value is equal to "Search..."
		if($(this).val() == "Search... powered by Google") {
			// remove all the text and the class of .empty
			$(this).val("").removeClass("empty");;
		}
		this.select();
	});
	 
	// When the focus on #search is lost
	$(".gsc-input > input").blur(function(){
	 
		// If the input field is empty
		if($(this).val() == "") {
			// Add the text "Search..." and a class of .empty
			$(this).val("Search... powered by Google").addClass("empty");
		}
	});

	$("#comment_heading").click(function()
	{
		$(this).next("#disqus_thread").slideToggle(500);
		if($(this).text() == "Show Comments") {
			$(this).text("Hide Comments")
		}else{
			$(this).text("Show Comments")
		}
	});
		
  });
});


  //]]>
  </script>


	<!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$']],
		processEscapes: true,
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": {
		  preferredFont: "TeX",
		  availableFonts: ["STIX","TeX"],
		  }
	});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	<!-- mathjax css conflict with pygments -->
	<style>
	.MathJax .mo,
	.MathJax .mi {
	  color: inherit;
	</style>

</head>

<body>
	<div class="container">
	<!-- <div class="container showgrid"> -->
		<div id="header" class="span-24">
  <div id="menu" class="span-15 last">
    <ul>
      <li class="first"><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/archives">Archives</a></li>
      <li><a href="/projects">Projects</a></li>
      <!--<li class="last"><a id="mail" href="mailto:kamelzcs@gmail.com">Contact</a></li>-->
    </ul>
  </div>
</div>

		
		<div id="main" class="span-17">
			<style type="text/css">
h3,h4{ 
	color: #335E8D;
}			
h3,h4 {
	margin-left		: 3px;
	font-variant	: small-caps;
	font-weight		: normal;
	border-bottom : 1px dotted #ccc;	
}
</style>




<div class="post" id="main-content">
	<h1>语音技术沙龙</h1>
	<h4 class="large-bottom">
		Posted on 2013-03-17 05:18:21 +0900
		 in <a href="/categories/语音">语音</a> 

		<span class="tag-list">
			
			<a href="/tags/语音">语音</a>
			
			<a href="/tags/趋势">趋势</a>
			
			<a href="/tags/大规模机器学习">大规模机器学习</a>
			
		</span>
	</h4>
	
	<div class="content">
		<h2 id="1-报告内容">1 报告内容</h2>

<p>第一次在帝都现场参加技术talk的沙龙，比学校的talk要应用性实际的多。</p>

<p>第一个报告是百度语音部门负责人贾磊，主要讲了百度语音搜索在DNN领域的一些经验。百度成立了第一个研究院，Institute of Deep Learning，简称IDL。 由于Deep Learning在语音及多媒体领域面对海量数据的优越性，Google、Miscrosft等公司都开始投入大量的人力、物力做这样一件事情。
没带笔记本过去，凭记忆力列几个关键点。</p>

<ul>
  <li>处理流程为客户端编码、上传、服务器端处理、下放</li>
  <li>训练样本为10亿级，如考虑抗噪，会到百亿数量级</li>
  <li>MS的隐层深度为10层，Google的隐层数目为6层左右，输出层为9000维左右</li>
  <li>SGD（随机乱序），异步SGD，利用近似二阶梯度i信息为训练中重要方法</li>
  <li>节点间通信的带宽为主要瓶颈</li>
  <li>单个GPU核的计算能力相当于未优化的CPU核的400～500倍</li>
  <li>Google有chrome，所以可以在浏览器里加入语音的采集模块，百度没有多媒体采集的客户端，很受限制。</li>
</ul>

<p>第二个报告是IBM中国研究院的秦勇老师。分享了IBM在语音处理方面的进展，主要是大的picture</p>

<ul>
  <li>Itrans（IBM speech transcription server）能够将视频中的语音翻译成文本信息。这个应用在国外的客服领域应用较多，主要是在金融等行业。除此之外，对于很多talk形成文本话非常有意义</li>
  <li>讲解了Watson背后的技术DeepQA，虽然Watson目前只应用在娱乐节目上，但是可以将其扩展到如医疗等方向上，因为医学的知识不断的发展，而医生整理知识的工作是可以由Watson代替的</li>
  <li>分享了邮件的主题可视化，增加了直观性</li>
</ul>

<p>提出了几个有意思的点子：</p>

<ul>
  <li>有人在考虑实现如雅思、托福类的口语自动判卷。IBM没有做过商用，但是针对印度的口音做过类似的应用。IBM表示没有考虑语义，看来语义还是很难做的。如果这个效果好，简直可以大赚一笔</li>
  <li>可以实现学习如希特勒的说话特征，然后自动的根据特点生成语音。这个略犀利，如果做好了，以后接电话要小心了。</li>
  <li>通话质量的可视化</li>
</ul>

<p>感想：</p>

<ul>
  <li>DNN比拼的简直是工程实现能力，架构才是王道啊，机器+架构实现+数据源 是真正的瓶颈</li>
  <li>有想法，有技术，敢闯的人在帝都有这种交流的机会真是不错</li>
  <li>百度的浏览器、输入法等入口工具都起步太晚，导致了数据上的先天缺陷</li>
  <li>技术的交流是必须的，故步自封是要吃苦头的</li>
</ul>


	</div>
	
	<div class="next-prev-nav low-top">
		
		-----------------------------------
		<b>本文内容遵从<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC版权协议</a>转载请注明出自<a href="http://kamelzcs.github.com">kamelzcs</a></b>
		-----------------------------------
		<hr/>
		
		
		
			&laquo;&nbsp;<a href="/2013/03/17/talkinjapaneseforeignaffair" rel="next" title="日本大使馆活动见闻">日本大使馆活动见闻</a>
		
	
		
			
				|
			
		
		
	
		
			<a href="/2013/03/12/lifeinpeking" rel="previous" title="初体验">初体验</a>&nbsp;&raquo;
		
	
		<br />
	</div>

	<hr />
	<!--<div class="sharing">
	
	 
	
	
	
	
	
	
	 
</div>
 -->
	

<script type="text/javascript">
      var disqus_shortname = 'kamelzcs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	<div>
		<h2 id='comment_heading'>Hide Comments</h2>
		<div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kamelzcs'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
</div>

		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
)</h4>


</div>


		</div>
		
		
			<div id="sidebar" class="span-6 push-1 last">
	<div class="sidebar-module" id='gsearcher'>
				 
		<div id="searchcontrol">
			
		</div>
		
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/tags'>Tags</a></div>
		
            <span style="font-size: 75%">
              <a href="/tags/ab-testing/" title="1 post">A/B Testing</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/app-engine/" title="5 posts">App Engine</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/bash/" title="2 posts">Bash</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/c++/" title="2 posts">C++</a>
            </span>
          
            <span style="font-size: 125%">
              <a href="/tags/cis194/" title="11 posts">CIS194</a>
            </span>
          
            <span style="font-size: 95%">
              <a href="/tags/database/" title="5 posts">Database</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/datastructure/" title="1 post">Datastructure</a>
            </span>
          
            <span style="font-size: 85%">
              <a href="/tags/git/" title="3 posts">Git</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/github/" title="1 post">Github</a>
            </span>
          
            <span style="font-size: 130%">
              <a href="/tags/haskell/" title="12 posts">Haskell</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/ipsc/" title="1 post">IPSC</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jackknife/" title="1 post">Jackknife</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/java/" title="1 post">Java</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jekyll/" title="1 post">Jekyll</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/jinja2/" title="1 post">Jinja2</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">Life</a>
            </span>
          
            <span style="font-size: 280%">
              <a href="/tags/lisp/" title="42 posts">Lisp</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/math/" title="1 post">Math</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/polymorphism/" title="1 post">Polymorphism</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/python/" title="1 post">Python</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/review/" title="2 posts">Review</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/solarized/" title="1 post">Solarized</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/sourcecode/" title="1 post">Sourcecode</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/template/" title="1 post">Template</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/topcoder/" title="2 posts">Topcoder</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/variable-scope/" title="1 post">Variable scope</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/vim/" title="2 posts">Vim</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/life/" title="1 post">life</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/亲情/" title="1 post">亲情</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/回忆/" title="1 post">回忆</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/大规模机器学习/" title="1 post">大规模机器学习</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/展望/" title="1 post">展望</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/日本/" title="1 post">日本</a>
            </span>
          
            <span style="font-size: 80%">
              <a href="/tags/生活/" title="2 posts">生活</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗歌/" title="1 post">诗歌</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/诗词/" title="1 post">诗词</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/语音/" title="1 post">语音</a>
            </span>
          
            <span style="font-size: 75%">
              <a href="/tags/趋势/" title="1 post">趋势</a>
            </span>
          
	</div>

	<div class="sidebar-module">
		<div class="title"><a href='/categories'>Categories</a></div>
		<a href="/categories/jekyll"><strong>jekyll</strong></a> (1)<br /><a href="/categories/生活"><strong>生活</strong></a> (4)<br /><a href="/categories/语音"><strong>语音</strong></a> (1)<br /><a href="/categories/讲座"><strong>讲座</strong></a> (1)<br /><a href="/categories/technique"><strong>Technique</strong></a> (5)<br /><a href="/categories/technique"><strong>technique</strong></a> (1)<br /><a href="/categories/technology"><strong>Technology</strong></a> (4)<br /><a href="/categories/vim"><strong>Vim</strong></a> (1)<br /><a href="/categories/诗词"><strong>诗词</strong></a> (1)<br /><a href="/categories/life"><strong>Life</strong></a> (2)<br /><a href="/categories/computer"><strong>Computer</strong></a> (1)<br /><a href="/categories/linux"><strong>Linux</strong></a> (1)<br /><a href="/categories/data-structure"><strong>Data structure</strong></a> (1)<br /><a href="/categories/life"><strong>life</strong></a> (1)<br /><a href="/categories/sicp"><strong>SICP</strong></a> (42)<br /><a href="/categories/cc++"><strong>C/C++</strong></a> (1)<br /><a href="/categories/contest"><strong>Contest</strong></a> (2)<br /><a href="/categories/programming"><strong>Programming</strong></a> (1)<br /><a href="/categories/algorithm"><strong>Algorithm</strong></a> (1)<br /><a href="/categories/functional-programming"><strong>Functional Programming</strong></a> (12)<br /><a href="/categories/data-science"><strong>Data Science</strong></a> (1)<br />
	</div>
	
	<div class="sidebar-module">
		<div class="title"><a href='/archives'>Archives</a></div>
		<a href="/2019/12"><strong>December 2019</strong></a> (1)<br /><a href="/2015/08"><strong>August 2015</strong></a> (12)<br /><a href="/2015/07"><strong>July 2015</strong></a> (2)<br /><a href="/2015/06"><strong>June 2015</strong></a> (2)<br /><a href="/2015/05"><strong>May 2015</strong></a> (1)<br /><a href="/2015/03"><strong>March 2015</strong></a> (13)<br /><a href="/2015/02"><strong>February 2015</strong></a> (30)<br /><a href="/2014/02"><strong>February 2014</strong></a> (1)<br /><a href="/2014/01"><strong>January 2014</strong></a> (4)<br /><a href="/2013/12"><strong>December 2013</strong></a> (2)<br /><a href="/2013/11"><strong>November 2013</strong></a> (8)<br /><a href="/2013/10"><strong>October 2013</strong></a> (2)<br /><a href="/2013/03"><strong>March 2013</strong></a> (3)<br /><a href="/2013/02"><strong>February 2013</strong></a> (2)<br /><a href="/2013/01"><strong>January 2013</strong></a> (1)<br /><a href="/2012/12"><strong>December 2012</strong></a> (1)<br />
	</div>
</div>

		
		
		<div id="footer" class="span-24"> 
<span  title="Content licenced under Creative Commons by-nc-sa 3.0">版权所有<a title="Content licenced under Creative Commons by-nc-sa 3.0" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">&copy;</a> 
	2012-2020 kamelzcs。
</span> 
&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://github.com/kamelzcs">GitHub</a>
&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://weibo.com/u/2534942150">新浪微博</a>
 &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://twitter.com/kamelzcs">Twitter</a>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;
<span>
    主题由<a title="site's theme made by Bilal Hussain" href="http://bilalh.github.com">Bilal Hussain Hussain</a>提供,由<a href="http://ddrccw.github.com">ddrccw</a>修改。
</span>
</div>

	</div>
	
</body>
</html>
